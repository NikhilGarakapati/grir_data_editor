{"ast":null,"code":"import { extend, isBlazor } from '@syncfusion/ej2-base';\nimport { remove, isNullOrUndefined, updateBlazorTemplate, resetBlazorTemplate } from '@syncfusion/ej2-base';\nimport { parentsUntil, isGroupAdaptive, refreshForeignData, getObject } from '../base/util';\nimport * as events from '../base/constant';\nimport { RowRenderer } from '../renderer/row-renderer';\nimport { DataUtil } from '@syncfusion/ej2-data';\n/**\n * `NormalEdit` module is used to handle normal('inline, dialog, external') editing actions.\n * @hidden\n */\n\nvar NormalEdit =\n/** @class */\nfunction () {\n  function NormalEdit(parent, serviceLocator, renderer) {\n    this.args = {};\n    this.currentVirtualData = {};\n    this.parent = parent;\n    this.renderer = renderer;\n    this.serviceLocator = serviceLocator;\n    this.addEventListener();\n  }\n\n  NormalEdit.prototype.clickHandler = function (e) {\n    var target = e.target;\n    var gObj = this.parent;\n\n    if ((parentsUntil(target, 'e-gridcontent') && parentsUntil(parentsUntil(target, 'e-gridcontent'), 'e-grid').id === gObj.element.id || gObj.frozenRows && parentsUntil(target, 'e-headercontent')) && !parentsUntil(target, 'e-unboundcelldiv')) {\n      this.rowIndex = parentsUntil(target, 'e-rowcell') ? parseInt(target.parentElement.getAttribute('aria-rowindex'), 10) : -1;\n\n      if (gObj.isEdit) {\n        gObj.editModule.endEdit();\n      }\n    }\n  };\n\n  NormalEdit.prototype.dblClickHandler = function (e) {\n    if (parentsUntil(e.target, 'e-rowcell') && this.parent.editSettings.allowEditOnDblClick) {\n      this.parent.editModule.startEdit(parentsUntil(e.target, 'e-row'));\n    }\n  };\n  /**\n   * The function used to trigger editComplete\n   * @return {void}\n   * @hidden\n   */\n\n\n  NormalEdit.prototype.editComplete = function (e) {\n    this.parent.isEdit = false;\n    var action = 'action';\n\n    if (isBlazor() && !this.parent.isJsComponent) {\n      e.rows = null;\n    }\n\n    switch (e.requestType) {\n      case 'save':\n        if (!(this.parent.isCheckBoxSelection || this.parent.selectionSettings.type === 'Multiple') || !this.parent.isPersistSelection) {\n          if (e[action] !== 'edit') {\n            this.parent.selectRow(0);\n          }\n        }\n\n        this.parent.trigger(events.actionComplete, extend(e, {\n          requestType: 'save',\n          type: events.actionComplete\n        }));\n        break;\n\n      case 'delete':\n        if (isBlazor() && !this.parent.isJsComponent) {\n          var d = 'data';\n          e[d] = e[d][0];\n        }\n\n        this.parent.trigger(events.actionComplete, extend(e, {\n          requestType: 'delete',\n          type: events.actionComplete\n        }));\n        this.parent.selectRow(this.editRowIndex);\n        break;\n    }\n  };\n\n  NormalEdit.prototype.startEdit = function (tr) {\n    var _this = this;\n\n    var gObj = this.parent;\n    var primaryKeys = gObj.getPrimaryKeyFieldNames();\n    var primaryKeyValues = [];\n    this.rowIndex = this.editRowIndex = parseInt(tr.getAttribute('aria-rowindex'), 10);\n\n    if (gObj.enableVirtualization || gObj.enableInfiniteScrolling) {\n      var selector = '.e-row[aria-rowindex=\"' + this.rowIndex + '\"]';\n      var virtualRow = this.parent.element.querySelector(selector);\n\n      if (!virtualRow) {\n        return;\n      }\n    }\n\n    if (isBlazor()) {\n      var cols = this.parent.getColumns();\n\n      for (var i = 0; i < cols.length; i++) {\n        var col = cols[i];\n\n        if (col.template) {\n          resetBlazorTemplate(gObj.element.id + col.uid, 'Template', this.rowIndex);\n        }\n      }\n    }\n\n    if (isGroupAdaptive(gObj)) {\n      var rObj = gObj.getRowObjectFromUID(tr.getAttribute('data-uid'));\n      this.previousData = rObj.data;\n    } else if (this.parent.enableVirtualization || this.parent.enableInfiniteScrolling) {\n      var e = {\n        data: this.previousData,\n        index: this.rowIndex\n      };\n      this.parent.notify(events.virtualScrollEditActionBegin, e);\n      this.previousData = e.data;\n    } else {\n      this.previousData = gObj.getCurrentViewRecords()[this.rowIndex];\n    }\n\n    for (var i = 0; i < primaryKeys.length; i++) {\n      primaryKeyValues.push(getObject(primaryKeys[i], this.previousData));\n    }\n\n    this.uid = tr.getAttribute('data-uid');\n    var rowObj = gObj.getRowObjectFromUID(this.uid);\n    var args = {\n      primaryKey: primaryKeys,\n      primaryKeyValue: primaryKeyValues,\n      requestType: 'beginEdit',\n      rowData: this.previousData,\n      rowIndex: this.rowIndex,\n      type: 'edit',\n      cancel: false,\n      foreignKeyData: rowObj && rowObj.foreignKeyData,\n      target: undefined\n    };\n\n    if (!isBlazor() || this.parent.isJsComponent) {\n      args.row = tr;\n    }\n\n    gObj.trigger(events.beginEdit, args, function (begineditargs) {\n      begineditargs.type = 'actionBegin';\n      gObj.trigger(events.actionBegin, begineditargs, function (editargs) {\n        if (!editargs.cancel) {\n          var cloneRow = 'cloneRow';\n          var frozen = 'frozen';\n          var cloneFrozen = 'cloneFrozen';\n          gObj.isEdit = true;\n          editargs.row = editargs.row ? editargs.row : tr;\n\n          if (isBlazor() && gObj.isServerRendered) {\n            _this.originalRow = editargs.row;\n            _this.cloneRow = editargs.row.cloneNode(true);\n            editargs[cloneRow] = _this.cloneRow;\n          }\n\n          if (gObj.editSettings.mode !== 'Dialog') {\n            gObj.clearSelection();\n          }\n\n          if (gObj.editSettings.mode === 'Dialog' && gObj.selectionModule) {\n            gObj.selectionModule.preventFocus = true;\n            editargs.row.classList.add('e-dlgeditrow');\n          }\n\n          _this.renderer.update(editargs);\n\n          if (isBlazor()) {\n            editargs.form = null;\n            _this.cloneFrozen = editargs[cloneFrozen];\n            _this.frozen = editargs[frozen];\n            _this.cloneRow = editargs[cloneRow];\n            _this.originalRow = editargs.row;\n          }\n\n          _this.uid = tr.getAttribute('data-uid');\n          gObj.editModule.applyFormValidation();\n          editargs.type = 'actionComplete';\n          gObj.trigger(events.actionComplete, editargs);\n          _this.args = editargs;\n\n          if (_this.parent.allowTextWrap) {\n            _this.parent.notify(events.freezeRender, {\n              case: 'textwrap'\n            });\n          }\n\n          if (isBlazor()) {\n            _this.parent.notify(events.toolbarRefresh, {});\n\n            gObj.element.querySelector('.e-gridpopup').style.display = 'none';\n\n            _this.parent.notify('start-edit', {});\n          }\n        }\n      });\n    });\n  };\n\n  NormalEdit.prototype.updateRow = function (index, data) {\n    var _this = this;\n\n    var gObj = this.parent;\n    this.editRowIndex = index;\n    var args = {\n      requestType: 'save',\n      action: 'edit',\n      type: events.actionBegin,\n      data: data,\n      cancel: false,\n      previousData: gObj.getCurrentViewRecords()[index],\n      row: gObj.getRowByIndex(index)\n    };\n    gObj.showSpinner();\n    gObj.notify(events.updateData, args);\n\n    if (args.promise) {\n      args.promise.then(function () {\n        return gObj.refresh();\n      }).catch(function (e) {\n        return _this.edFail(e);\n      });\n    } else {\n      gObj.refresh();\n    }\n  };\n\n  NormalEdit.prototype.editFormValidate = function () {\n    var gObj = this.parent;\n    var form1 = gObj.editModule.formObj.validate();\n    var form2 = gObj.editModule.mFormObj ? gObj.editModule.mFormObj.validate() : true;\n    return form1 && form2;\n  };\n\n  NormalEdit.prototype.endEdit = function () {\n    var gObj = this.parent;\n\n    if (!this.parent.isEdit || !this.editFormValidate()) {\n      return;\n    }\n\n    var editedData = extend({}, {}, this.previousData, true);\n    var args = extend(this.args, {\n      requestType: 'save',\n      type: events.actionBegin,\n      data: editedData,\n      cancel: false,\n      previousData: this.previousData,\n      selectedRow: gObj.selectedRowIndex,\n      foreignKeyData: {}\n    });\n    var isDlg = gObj.editSettings.mode === 'Dialog';\n    var dlgWrapper = document.querySelector('#' + gObj.element.id + '_dialogEdit_wrapper');\n    var dlgForm = isDlg ? dlgWrapper.querySelector('.e-gridform') : gObj.element.querySelector('.e-gridform');\n    var data = {\n      virtualData: {},\n      isAdd: false\n    };\n    this.parent.notify(events.getVirtualData, data);\n\n    if ((this.parent.enableVirtualization || this.parent.enableInfiniteScrolling) && this.parent.editSettings.mode === 'Normal' && !dlgForm) {\n      if (this.parent.isEdit) {\n        this.currentVirtualData = editedData = args.data = data.virtualData;\n      }\n    } else {\n      editedData = gObj.editModule.getCurrentEditedData(dlgForm, editedData);\n    }\n\n    if (gObj.getFrozenColumns() && gObj.editSettings.mode === 'Normal') {\n      var mForm = gObj.element.querySelector('.e-movableheader').querySelector('.e-gridform');\n\n      if (gObj.frozenRows && mForm) {\n        editedData = gObj.editModule.getCurrentEditedData(mForm, editedData);\n      } else {\n        var form = gObj.element.querySelector('.e-movablecontent').querySelector('.e-gridform');\n\n        if (form) {\n          editedData = gObj.editModule.getCurrentEditedData(form, editedData);\n        }\n      }\n    }\n\n    if (isBlazor()) {\n      var form = 'form';\n      var movableForm = 'movableForm';\n      args[form] = null;\n      args[movableForm] = null;\n      args.row = {};\n    }\n\n    var eleLength = [].slice.call(gObj.element.querySelectorAll('.e-editedrow')).length;\n\n    if (!data.isAdd && Object.keys(this.currentVirtualData).length && !eleLength) {\n      eleLength = 1;\n    }\n\n    if (isDlg ? dlgWrapper.querySelectorAll('.e-editedrow').length : eleLength) {\n      args.action = 'edit';\n      gObj.trigger(events.actionBegin, args, function (endEditArgs) {\n        if (endEditArgs.cancel) {\n          return;\n        }\n\n        gObj.showSpinner();\n        gObj.notify(events.updateData, endEditArgs);\n      });\n    } else {\n      args.action = 'add';\n      args.selectedRow = 0;\n      args.index = this.addedRowIndex;\n      gObj.notify(events.virtualScrollEditSuccess, {});\n      gObj.notify(events.modelChanged, args);\n      this.addedRowIndex = null;\n\n      if (args.cancel) {\n        return;\n      }\n    }\n  };\n\n  NormalEdit.prototype.destroyElements = function () {\n    var gObj = this.parent;\n    gObj.editModule.destroyWidgets();\n    gObj.editModule.destroyForm();\n    this.parent.notify(events.dialogDestroy, {});\n  };\n\n  NormalEdit.prototype.editHandler = function (args) {\n    var _this = this;\n\n    if (args.promise) {\n      args.promise.then(function (e) {\n        return _this.edSucc(e, args);\n      }).catch(function (e) {\n        return _this.edFail(e);\n      });\n    } else {\n      this.editSuccess(args.data, args);\n    }\n  };\n\n  NormalEdit.prototype.edSucc = function (e, args) {\n    this.editSuccess(e, args);\n  };\n\n  NormalEdit.prototype.edFail = function (e) {\n    if (isBlazor() && this.parent.isServerRendered) {\n      var error = 'error';\n      var message = 'message';\n\n      if (!isNullOrUndefined(e[error]) && !isNullOrUndefined(e[error][message])) {\n        e[error] = e[error][message];\n      }\n    }\n\n    this.editFailure(e);\n  };\n\n  NormalEdit.prototype.updateCurrentViewData = function (data) {\n    if (!this.parent.enableVirtualization && !this.parent.enableInfiniteScrolling) {\n      this.parent.getCurrentViewRecords()[this.editRowIndex] = data;\n    }\n  };\n\n  NormalEdit.prototype.requestSuccess = function (args) {\n    if (this.parent.editModule.formObj && !this.parent.editModule.formObj.isDestroyed) {\n      this.destroyElements();\n      this.stopEditStatus();\n\n      if (this.parent.editSettings.mode === 'Dialog' && args.action !== 'add') {\n        this.parent.element.querySelector('.e-dlgeditrow').classList.remove('e-dlgeditrow');\n      }\n    }\n  };\n\n  NormalEdit.prototype.editSuccess = function (e, args) {\n    if (!isNullOrUndefined(e) && !(e instanceof Array)) {\n      var rowData = 'rowData';\n      args.data = extend({}, extend({}, args[rowData], args.data), e);\n    }\n\n    var editArgs;\n    this.requestSuccess(args);\n    this.parent.trigger(events.beforeDataBound, args);\n    args.type = events.actionComplete;\n    this.parent.isEdit = false;\n\n    if (isBlazor() && this.parent.isServerRendered) {\n      this.closeForm();\n      var rowIndex = 'rowIndex';\n      var action = 'action';\n      var data = 'data';\n      editArgs = {\n        requestType: args.requestType,\n        rowIndex: args[rowIndex],\n        action: args[action],\n        data: args[data]\n      };\n      this.parent.notify('editsuccess', editArgs);\n    } else {\n      this.refreshRow(args.data);\n    }\n\n    this.parent.notify(events.virtualScrollEditSuccess, args);\n    this.parent.editModule.checkLastRow(args.row);\n    this.parent.editModule.isLastRow = false;\n    this.updateCurrentViewData(args.data);\n    this.blazorTemplate();\n\n    if (!(isBlazor() && this.parent.isServerRendered)) {\n      this.editRowIndex = null;\n      this.parent.trigger(events.actionComplete, args);\n    }\n\n    if (isBlazor()) {\n      this.parent.notify(events.toolbarRefresh, {});\n    }\n\n    if (!(this.parent.isCheckBoxSelection || this.parent.selectionSettings.type === 'Multiple') || !this.parent.isPersistSelection) {\n      if (this.parent.editSettings.mode !== 'Dialog') {\n        if (isBlazor() && this.parent.isServerRendered) {\n          var rowIndex = 'editRowIndex';\n          editArgs[rowIndex] = this.rowIndex > -1 ? this.rowIndex : this.editRowIndex;\n        } else {\n          this.parent.selectRow(this.rowIndex > -1 ? this.rowIndex : this.editRowIndex);\n        }\n      }\n    }\n\n    this.parent.hideSpinner();\n  };\n\n  NormalEdit.prototype.closeForm = function () {\n    if (!this.cloneRow && this.parent.isEdit) {\n      this.stopEditStatus();\n    }\n\n    if (this.cloneRow) {\n      this.cloneRow.remove();\n      this.cloneRow = null;\n      this.originalRow.classList.remove('e-hiddenrow');\n    }\n\n    if (this.parent.getFrozenColumns() && this.cloneFrozen) {\n      this.cloneFrozen.remove();\n      this.frozen.classList.remove('e-hiddenrow');\n    }\n  };\n\n  NormalEdit.prototype.blazorTemplate = function () {\n    var cols = this.parent.getColumns();\n\n    if (this.parent.editSettings.template && this.parent.editSettings.mode === 'Normal') {\n      updateBlazorTemplate(this.parent.element.id + 'editSettingsTemplate', 'Template', this.parent.editSettings);\n    }\n\n    for (var i = 0; i < cols.length; i++) {\n      var col = cols[i];\n\n      if (col.template) {\n        updateBlazorTemplate(this.parent.element.id + col.uid, 'Template', col, false);\n      }\n\n      if (col.editTemplate) {\n        updateBlazorTemplate(this.parent.element.id + col.uid + 'editTemplate', 'EditTemplate', col);\n      }\n    }\n  };\n\n  NormalEdit.prototype.editFailure = function (e) {\n    this.parent.trigger(events.actionFailure, isBlazor() && e instanceof Array ? e[0] : e);\n    this.parent.hideSpinner();\n    this.parent.log('actionfailure', {\n      error: e\n    });\n  };\n\n  NormalEdit.prototype.needRefresh = function () {\n    var refresh = true;\n    var editedRow = this.parent.element.querySelector('.e-gridform');\n\n    if ((this.parent.enableVirtualization || this.parent.infiniteScrollSettings.enableCache) && this.parent.editSettings.mode === 'Normal' && !editedRow) {\n      refresh = false;\n    }\n\n    return refresh;\n  };\n\n  NormalEdit.prototype.refreshRow = function (data) {\n    var frzCols = this.parent.getFrozenColumns();\n    var row = new RowRenderer(this.serviceLocator, null, this.parent);\n    var rowObj = this.parent.getRowObjectFromUID(this.uid);\n\n    if (rowObj) {\n      rowObj.changes = data;\n      this.parent.notify(events.refreshVirtualCache, data);\n      refreshForeignData(rowObj, this.parent.getForeignKeyColumns(), rowObj.changes);\n\n      if (this.needRefresh()) {\n        row.refresh(rowObj, this.parent.getColumns(), true);\n      }\n\n      if (frzCols) {\n        var uid = void 0;\n        var tr = this.parent.element.querySelector('[data-uid=' + rowObj.uid + ']');\n\n        if (parentsUntil(tr, 'e-frozencontent') || parentsUntil(tr, 'e-frozenheader')) {\n          if (this.parent.infiniteScrollSettings.enableCache) {\n            uid = this.parent.getMovableRowByIndex(rowObj.index).getAttribute('data-uid');\n          } else {\n            uid = this.parent.getMovableRows()[rowObj.index].getAttribute('data-uid');\n          }\n        } else {\n          if (this.parent.infiniteScrollSettings.enableCache) {\n            uid = this.parent.getRowByIndex(rowObj.index).getAttribute('data-uid');\n          } else {\n            uid = this.parent.getRows()[rowObj.index].getAttribute('data-uid');\n          }\n        }\n\n        rowObj = this.parent.getRowObjectFromUID(uid);\n        rowObj.changes = data;\n        row.refresh(rowObj, this.parent.columns, true);\n        this.parent.editModule.checkLastRow(tr);\n      }\n    }\n  };\n\n  NormalEdit.prototype.closeEdit = function () {\n    var _this = this;\n\n    if (!this.parent.isEdit) {\n      return;\n    }\n\n    var gObj = this.parent;\n    var args = extend(this.args, {\n      requestType: 'cancel',\n      type: events.actionBegin,\n      cancel: false,\n      data: this.previousData,\n      selectedRow: gObj.selectedRowIndex\n    });\n    gObj.notify(events.virtualScrollEditCancel, args);\n    this.blazorTemplate();\n\n    if (isBlazor()) {\n      var form = 'form';\n      args[form] = null;\n    }\n\n    gObj.trigger(events.actionBegin, args, function (closeEditArgs) {\n      if (closeEditArgs.cancel) {\n        return;\n      }\n\n      if (_this.parent.editSettings.mode === 'Dialog') {\n        _this.parent.notify(events.dialogDestroy, {});\n      }\n\n      gObj.isEdit = false;\n\n      _this.stopEditStatus();\n\n      closeEditArgs.type = events.actionComplete;\n\n      if (gObj.editSettings.mode !== 'Dialog') {\n        if (isBlazor() && gObj.isServerRendered) {\n          _this.closeForm();\n        } else {\n          _this.refreshRow(closeEditArgs.data);\n        }\n      }\n\n      if (!gObj.getContentTable().querySelector('tr.e-emptyrow') && !gObj.getContentTable().querySelector('tr.e-row')) {\n        gObj.renderModule.emptyRow();\n      }\n\n      if (gObj.editSettings.mode !== 'Dialog') {\n        gObj.selectRow(_this.rowIndex);\n      }\n\n      gObj.trigger(events.actionComplete, closeEditArgs);\n\n      if (isBlazor()) {\n        _this.parent.notify(events.toolbarRefresh, {});\n\n        _this.parent.notify('close-edit', {});\n      }\n    });\n  };\n\n  NormalEdit.prototype.addRecord = function (data, index) {\n    var _this = this;\n\n    var gObj = this.parent;\n    this.addedRowIndex = index = !isNullOrUndefined(index) ? index : 0;\n\n    if (data) {\n      gObj.notify(events.modelChanged, {\n        requestType: 'save',\n        type: events.actionBegin,\n        data: data,\n        selectedRow: 0,\n        action: 'add',\n        index: index\n      });\n      return;\n    }\n\n    if (gObj.isEdit) {\n      return;\n    }\n\n    this.previousData = {};\n    this.uid = '';\n    var cols = gObj.columnModel;\n\n    for (var i = 0; i < cols.length; i++) {\n      if (cols[i].field) {\n        DataUtil.setValue(cols[i].field, cols[i].defaultValue, this.previousData);\n      }\n    }\n\n    var args = {\n      cancel: false,\n      foreignKeyData: {},\n      requestType: 'add',\n      data: this.previousData,\n      type: events.actionBegin,\n      index: index,\n      rowData: this.previousData,\n      target: undefined\n    };\n    var rowData = {\n      virtualData: {}\n    };\n    this.parent.notify(events.getVirtualData, rowData);\n\n    if ((this.parent.enableVirtualization || this.parent.infiniteScrollSettings.enableCache) && Object.keys(rowData.virtualData).length) {\n      args.data = args.rowData = rowData.virtualData;\n    }\n\n    if (isBlazor()) {\n      var form = 'form';\n      args[form] = null;\n    }\n\n    gObj.trigger(events.actionBegin, args, function (addArgs) {\n      if (addArgs.cancel) {\n        return;\n      }\n\n      gObj.isEdit = true;\n\n      if (gObj.editSettings.mode !== 'Dialog') {\n        gObj.clearSelection();\n      }\n\n      _this.renderer.addNew(addArgs);\n\n      gObj.editModule.applyFormValidation();\n      addArgs.type = events.actionComplete;\n      addArgs.row = gObj.element.querySelector('.e-addedrow');\n      gObj.trigger(events.actionComplete, addArgs);\n\n      if (isBlazor()) {\n        _this.parent.notify(events.toolbarRefresh, {});\n\n        _this.parent.notify('start-add', {});\n      }\n\n      _this.args = addArgs;\n    });\n  };\n\n  NormalEdit.prototype.deleteRecord = function (fieldname, data) {\n    this.editRowIndex = this.parent.selectedRowIndex;\n\n    if (data) {\n      data = data instanceof Array ? data : [data];\n      var gObj = this.parent;\n      var index = 0;\n      var dataLen = Object.keys(data).length;\n      fieldname = fieldname || this.parent.getPrimaryKeyFieldNames()[0];\n\n      var _loop_1 = function (i) {\n        var _a;\n\n        var tmpRecord;\n        var contained = gObj.currentViewData.some(function (record) {\n          tmpRecord = record;\n          return data[i] === getObject(fieldname, record) || data[i] === record;\n        });\n        data[i] = contained ? tmpRecord : (_a = {}, _a[fieldname] = data[i], _a);\n      };\n\n      for (var i = 0; i < dataLen; i++) {\n        _loop_1(i);\n      }\n    }\n\n    var args = {\n      requestType: 'delete',\n      type: events.actionBegin,\n      foreignKeyData: {},\n      data: data ? data : this.parent.getSelectedRecords(),\n      tr: this.parent.getSelectedRows(),\n      cancel: false\n    };\n\n    if (!isNullOrUndefined(this.parent.commandDelIndex)) {\n      args.data[0] = this.parent.getRowObjectFromUID(this.parent.getRowByIndex(this.parent.commandDelIndex).getAttribute('data-uid')).data;\n    }\n\n    if (this.parent.enableVirtualization && args.data.length > 1) {\n      var uid = this.parent.getSelectedRows()[0].getAttribute('data-uid');\n      args.data = [this.parent.getRowObjectFromUID(uid).data];\n    }\n\n    var dataInString = 'data';\n\n    if (isBlazor() && !this.parent.isJsComponent) {\n      args[dataInString] = args[dataInString][0];\n    }\n\n    this.parent.notify(events.modelChanged, args);\n  };\n\n  NormalEdit.prototype.stopEditStatus = function () {\n    var gObj = this.parent;\n    var elem = gObj.element.querySelector('.e-addedrow');\n    var mElem;\n    var editMElem;\n\n    if (gObj.getFrozenColumns()) {\n      mElem = gObj.element.querySelectorAll('.e-addedrow')[1];\n      editMElem = gObj.element.querySelectorAll('.e-editedrow')[1];\n\n      if (mElem) {\n        remove(mElem);\n      }\n\n      if (editMElem) {\n        editMElem.classList.remove('e-editedrow');\n      }\n    }\n\n    if (elem) {\n      remove(elem);\n    }\n\n    elem = gObj.element.querySelector('.e-editedrow');\n\n    if (elem) {\n      elem.classList.remove('e-editedrow');\n    }\n  };\n  /**\n   * @hidden\n   */\n\n\n  NormalEdit.prototype.addEventListener = function () {\n    if (this.parent.isDestroyed) {\n      return;\n    }\n\n    this.parent.on(events.crudAction, this.editHandler, this);\n    this.parent.on(events.doubleTap, this.dblClickHandler, this);\n    this.parent.on(events.click, this.clickHandler, this);\n    this.parent.on(events.recordAdded, this.requestSuccess, this);\n    this.parent.on(events.dblclick, this.dblClickHandler, this);\n    this.parent.on(events.deleteComplete, this.editComplete, this);\n    this.parent.on(events.saveComplete, this.editComplete, this);\n    this.parent.on('closeinline', this.closeForm, this);\n  };\n  /**\n   * @hidden\n   */\n\n\n  NormalEdit.prototype.removeEventListener = function () {\n    if (this.parent.isDestroyed) {\n      return;\n    }\n\n    this.parent.off(events.crudAction, this.editHandler);\n    this.parent.off(events.doubleTap, this.dblClickHandler);\n    this.parent.off(events.click, this.clickHandler);\n    this.parent.off(events.recordAdded, this.requestSuccess);\n    this.parent.off(events.dblclick, this.dblClickHandler);\n    this.parent.off(events.deleteComplete, this.editComplete);\n    this.parent.off(events.saveComplete, this.editComplete);\n    this.parent.off('closeinline', this.closeForm);\n  };\n  /**\n   * @hidden\n   */\n\n\n  NormalEdit.prototype.destroy = function () {\n    this.removeEventListener();\n    this.renderer.destroy();\n  };\n\n  return NormalEdit;\n}();\n\nexport { NormalEdit };","map":{"version":3,"sources":["/home/nikhil/Desktop/data_grid_editor-master/node_modules/@syncfusion/ej2-grids/src/grid/actions/normal-edit.js"],"names":["extend","isBlazor","remove","isNullOrUndefined","updateBlazorTemplate","resetBlazorTemplate","parentsUntil","isGroupAdaptive","refreshForeignData","getObject","events","RowRenderer","DataUtil","NormalEdit","parent","serviceLocator","renderer","args","currentVirtualData","addEventListener","prototype","clickHandler","e","target","gObj","id","element","frozenRows","rowIndex","parseInt","parentElement","getAttribute","isEdit","editModule","endEdit","dblClickHandler","editSettings","allowEditOnDblClick","startEdit","editComplete","action","isJsComponent","rows","requestType","isCheckBoxSelection","selectionSettings","type","isPersistSelection","selectRow","trigger","actionComplete","d","editRowIndex","tr","_this","primaryKeys","getPrimaryKeyFieldNames","primaryKeyValues","enableVirtualization","enableInfiniteScrolling","selector","virtualRow","querySelector","cols","getColumns","i","length","col","template","uid","rObj","getRowObjectFromUID","previousData","data","index","notify","virtualScrollEditActionBegin","getCurrentViewRecords","push","rowObj","primaryKey","primaryKeyValue","rowData","cancel","foreignKeyData","undefined","row","beginEdit","begineditargs","actionBegin","editargs","cloneRow","frozen","cloneFrozen","isServerRendered","originalRow","cloneNode","mode","clearSelection","selectionModule","preventFocus","classList","add","update","form","applyFormValidation","allowTextWrap","freezeRender","case","toolbarRefresh","style","display","updateRow","getRowByIndex","showSpinner","updateData","promise","then","refresh","catch","edFail","editFormValidate","form1","formObj","validate","form2","mFormObj","editedData","selectedRow","selectedRowIndex","isDlg","dlgWrapper","document","dlgForm","virtualData","isAdd","getVirtualData","getCurrentEditedData","getFrozenColumns","mForm","movableForm","eleLength","slice","call","querySelectorAll","Object","keys","endEditArgs","addedRowIndex","virtualScrollEditSuccess","modelChanged","destroyElements","destroyWidgets","destroyForm","dialogDestroy","editHandler","edSucc","editSuccess","error","message","editFailure","updateCurrentViewData","requestSuccess","isDestroyed","stopEditStatus","Array","editArgs","beforeDataBound","closeForm","refreshRow","checkLastRow","isLastRow","blazorTemplate","hideSpinner","editTemplate","actionFailure","log","needRefresh","editedRow","infiniteScrollSettings","enableCache","frzCols","changes","refreshVirtualCache","getForeignKeyColumns","getMovableRowByIndex","getMovableRows","getRows","columns","closeEdit","virtualScrollEditCancel","closeEditArgs","getContentTable","renderModule","emptyRow","addRecord","columnModel","field","setValue","defaultValue","addArgs","addNew","deleteRecord","fieldname","dataLen","_loop_1","_a","tmpRecord","contained","currentViewData","some","record","getSelectedRecords","getSelectedRows","commandDelIndex","dataInString","elem","mElem","editMElem","on","crudAction","doubleTap","click","recordAdded","dblclick","deleteComplete","saveComplete","removeEventListener","off","destroy"],"mappings":"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","sourcesContent":["import { extend, isBlazor } from '@syncfusion/ej2-base';\nimport { remove, isNullOrUndefined, updateBlazorTemplate, resetBlazorTemplate } from '@syncfusion/ej2-base';\nimport { parentsUntil, isGroupAdaptive, refreshForeignData, getObject } from '../base/util';\nimport * as events from '../base/constant';\nimport { RowRenderer } from '../renderer/row-renderer';\nimport { DataUtil } from '@syncfusion/ej2-data';\n/**\n * `NormalEdit` module is used to handle normal('inline, dialog, external') editing actions.\n * @hidden\n */\nvar NormalEdit = /** @class */ (function () {\n    function NormalEdit(parent, serviceLocator, renderer) {\n        this.args = {};\n        this.currentVirtualData = {};\n        this.parent = parent;\n        this.renderer = renderer;\n        this.serviceLocator = serviceLocator;\n        this.addEventListener();\n    }\n    NormalEdit.prototype.clickHandler = function (e) {\n        var target = e.target;\n        var gObj = this.parent;\n        if ((((parentsUntil(target, 'e-gridcontent') &&\n            parentsUntil(parentsUntil(target, 'e-gridcontent'), 'e-grid').id === gObj.element.id)) || (gObj.frozenRows\n            && parentsUntil(target, 'e-headercontent'))) && !parentsUntil(target, 'e-unboundcelldiv')) {\n            this.rowIndex = parentsUntil(target, 'e-rowcell') ? parseInt(target.parentElement.getAttribute('aria-rowindex'), 10) : -1;\n            if (gObj.isEdit) {\n                gObj.editModule.endEdit();\n            }\n        }\n    };\n    NormalEdit.prototype.dblClickHandler = function (e) {\n        if (parentsUntil(e.target, 'e-rowcell') && this.parent.editSettings.allowEditOnDblClick) {\n            this.parent.editModule.startEdit(parentsUntil(e.target, 'e-row'));\n        }\n    };\n    /**\n     * The function used to trigger editComplete\n     * @return {void}\n     * @hidden\n     */\n    NormalEdit.prototype.editComplete = function (e) {\n        this.parent.isEdit = false;\n        var action = 'action';\n        if (isBlazor() && !this.parent.isJsComponent) {\n            e.rows = null;\n        }\n        switch (e.requestType) {\n            case 'save':\n                if (!(this.parent.isCheckBoxSelection || this.parent.selectionSettings.type === 'Multiple')\n                    || (!this.parent.isPersistSelection)) {\n                    if (e[action] !== 'edit') {\n                        this.parent.selectRow(0);\n                    }\n                }\n                this.parent.trigger(events.actionComplete, extend(e, {\n                    requestType: 'save',\n                    type: events.actionComplete\n                }));\n                break;\n            case 'delete':\n                if (isBlazor() && !this.parent.isJsComponent) {\n                    var d = 'data';\n                    e[d] = e[d][0];\n                }\n                this.parent.trigger(events.actionComplete, extend(e, {\n                    requestType: 'delete',\n                    type: events.actionComplete\n                }));\n                this.parent.selectRow(this.editRowIndex);\n                break;\n        }\n    };\n    NormalEdit.prototype.startEdit = function (tr) {\n        var _this = this;\n        var gObj = this.parent;\n        var primaryKeys = gObj.getPrimaryKeyFieldNames();\n        var primaryKeyValues = [];\n        this.rowIndex = this.editRowIndex = parseInt(tr.getAttribute('aria-rowindex'), 10);\n        if (gObj.enableVirtualization || gObj.enableInfiniteScrolling) {\n            var selector = '.e-row[aria-rowindex=\"' + this.rowIndex + '\"]';\n            var virtualRow = this.parent.element.querySelector(selector);\n            if (!virtualRow) {\n                return;\n            }\n        }\n        if (isBlazor()) {\n            var cols = this.parent.getColumns();\n            for (var i = 0; i < cols.length; i++) {\n                var col = cols[i];\n                if (col.template) {\n                    resetBlazorTemplate(gObj.element.id + col.uid, 'Template', this.rowIndex);\n                }\n            }\n        }\n        if (isGroupAdaptive(gObj)) {\n            var rObj = gObj.getRowObjectFromUID(tr.getAttribute('data-uid'));\n            this.previousData = rObj.data;\n        }\n        else if (this.parent.enableVirtualization || this.parent.enableInfiniteScrolling) {\n            var e = { data: this.previousData, index: this.rowIndex };\n            this.parent.notify(events.virtualScrollEditActionBegin, e);\n            this.previousData = e.data;\n        }\n        else {\n            this.previousData = gObj.getCurrentViewRecords()[this.rowIndex];\n        }\n        for (var i = 0; i < primaryKeys.length; i++) {\n            primaryKeyValues.push(getObject(primaryKeys[i], this.previousData));\n        }\n        this.uid = tr.getAttribute('data-uid');\n        var rowObj = gObj.getRowObjectFromUID(this.uid);\n        var args = {\n            primaryKey: primaryKeys, primaryKeyValue: primaryKeyValues, requestType: 'beginEdit',\n            rowData: this.previousData, rowIndex: this.rowIndex, type: 'edit', cancel: false,\n            foreignKeyData: rowObj && rowObj.foreignKeyData, target: undefined\n        };\n        if (!isBlazor() || this.parent.isJsComponent) {\n            args.row = tr;\n        }\n        gObj.trigger(events.beginEdit, args, function (begineditargs) {\n            begineditargs.type = 'actionBegin';\n            gObj.trigger(events.actionBegin, begineditargs, function (editargs) {\n                if (!editargs.cancel) {\n                    var cloneRow = 'cloneRow';\n                    var frozen = 'frozen';\n                    var cloneFrozen = 'cloneFrozen';\n                    gObj.isEdit = true;\n                    editargs.row = editargs.row ? editargs.row : tr;\n                    if (isBlazor() && gObj.isServerRendered) {\n                        _this.originalRow = editargs.row;\n                        _this.cloneRow = editargs.row.cloneNode(true);\n                        editargs[cloneRow] = _this.cloneRow;\n                    }\n                    if (gObj.editSettings.mode !== 'Dialog') {\n                        gObj.clearSelection();\n                    }\n                    if (gObj.editSettings.mode === 'Dialog' && gObj.selectionModule) {\n                        gObj.selectionModule.preventFocus = true;\n                        editargs.row.classList.add('e-dlgeditrow');\n                    }\n                    _this.renderer.update(editargs);\n                    if (isBlazor()) {\n                        editargs.form = null;\n                        _this.cloneFrozen = editargs[cloneFrozen];\n                        _this.frozen = editargs[frozen];\n                        _this.cloneRow = editargs[cloneRow];\n                        _this.originalRow = editargs.row;\n                    }\n                    _this.uid = tr.getAttribute('data-uid');\n                    gObj.editModule.applyFormValidation();\n                    editargs.type = 'actionComplete';\n                    gObj.trigger(events.actionComplete, editargs);\n                    _this.args = editargs;\n                    if (_this.parent.allowTextWrap) {\n                        _this.parent.notify(events.freezeRender, { case: 'textwrap' });\n                    }\n                    if (isBlazor()) {\n                        _this.parent.notify(events.toolbarRefresh, {});\n                        gObj.element.querySelector('.e-gridpopup').style.display = 'none';\n                        _this.parent.notify('start-edit', {});\n                    }\n                }\n            });\n        });\n    };\n    NormalEdit.prototype.updateRow = function (index, data) {\n        var _this = this;\n        var gObj = this.parent;\n        this.editRowIndex = index;\n        var args = {\n            requestType: 'save', action: 'edit', type: events.actionBegin, data: data, cancel: false,\n            previousData: gObj.getCurrentViewRecords()[index],\n            row: gObj.getRowByIndex(index)\n        };\n        gObj.showSpinner();\n        gObj.notify(events.updateData, args);\n        if (args.promise) {\n            args.promise.then(function () { return gObj.refresh(); }).catch(function (e) { return _this.edFail(e); });\n        }\n        else {\n            gObj.refresh();\n        }\n    };\n    NormalEdit.prototype.editFormValidate = function () {\n        var gObj = this.parent;\n        var form1 = gObj.editModule.formObj.validate();\n        var form2 = gObj.editModule.mFormObj ? gObj.editModule.mFormObj.validate() : true;\n        return (form1 && form2);\n    };\n    NormalEdit.prototype.endEdit = function () {\n        var gObj = this.parent;\n        if (!this.parent.isEdit || !this.editFormValidate()) {\n            return;\n        }\n        var editedData = extend({}, {}, this.previousData, true);\n        var args = extend(this.args, {\n            requestType: 'save', type: events.actionBegin, data: editedData, cancel: false,\n            previousData: this.previousData, selectedRow: gObj.selectedRowIndex, foreignKeyData: {}\n        });\n        var isDlg = gObj.editSettings.mode === 'Dialog';\n        var dlgWrapper = document.querySelector('#' + gObj.element.id + '_dialogEdit_wrapper');\n        var dlgForm = isDlg ? dlgWrapper.querySelector('.e-gridform') : gObj.element.querySelector('.e-gridform');\n        var data = { virtualData: {}, isAdd: false };\n        this.parent.notify(events.getVirtualData, data);\n        if ((this.parent.enableVirtualization || this.parent.enableInfiniteScrolling)\n            && this.parent.editSettings.mode === 'Normal' && !dlgForm) {\n            if (this.parent.isEdit) {\n                this.currentVirtualData = editedData = args.data = data.virtualData;\n            }\n        }\n        else {\n            editedData = gObj.editModule.getCurrentEditedData(dlgForm, editedData);\n        }\n        if (gObj.getFrozenColumns() && gObj.editSettings.mode === 'Normal') {\n            var mForm = gObj.element.querySelector('.e-movableheader').querySelector('.e-gridform');\n            if (gObj.frozenRows && mForm) {\n                editedData = gObj.editModule.getCurrentEditedData(mForm, editedData);\n            }\n            else {\n                var form = gObj.element.querySelector('.e-movablecontent').querySelector('.e-gridform');\n                if (form) {\n                    editedData = gObj.editModule.getCurrentEditedData(form, editedData);\n                }\n            }\n        }\n        if (isBlazor()) {\n            var form = 'form';\n            var movableForm = 'movableForm';\n            args[form] = null;\n            args[movableForm] = null;\n            args.row = {};\n        }\n        var eleLength = [].slice.call(gObj.element.querySelectorAll('.e-editedrow')).length;\n        if (!data.isAdd && Object.keys(this.currentVirtualData).length && !eleLength) {\n            eleLength = 1;\n        }\n        if (isDlg ? dlgWrapper.querySelectorAll('.e-editedrow').length : eleLength) {\n            args.action = 'edit';\n            gObj.trigger(events.actionBegin, args, function (endEditArgs) {\n                if (endEditArgs.cancel) {\n                    return;\n                }\n                gObj.showSpinner();\n                gObj.notify(events.updateData, endEditArgs);\n            });\n        }\n        else {\n            args.action = 'add';\n            args.selectedRow = 0;\n            args.index = this.addedRowIndex;\n            gObj.notify(events.virtualScrollEditSuccess, {});\n            gObj.notify(events.modelChanged, args);\n            this.addedRowIndex = null;\n            if (args.cancel) {\n                return;\n            }\n        }\n    };\n    NormalEdit.prototype.destroyElements = function () {\n        var gObj = this.parent;\n        gObj.editModule.destroyWidgets();\n        gObj.editModule.destroyForm();\n        this.parent.notify(events.dialogDestroy, {});\n    };\n    NormalEdit.prototype.editHandler = function (args) {\n        var _this = this;\n        if (args.promise) {\n            args.promise.then(function (e) { return _this.edSucc(e, args); }).catch(function (e) { return _this.edFail(e); });\n        }\n        else {\n            this.editSuccess(args.data, args);\n        }\n    };\n    NormalEdit.prototype.edSucc = function (e, args) {\n        this.editSuccess(e, args);\n    };\n    NormalEdit.prototype.edFail = function (e) {\n        if (isBlazor() && this.parent.isServerRendered) {\n            var error = 'error';\n            var message = 'message';\n            if (!isNullOrUndefined(e[error]) && !isNullOrUndefined(e[error][message])) {\n                e[error] = e[error][message];\n            }\n        }\n        this.editFailure(e);\n    };\n    NormalEdit.prototype.updateCurrentViewData = function (data) {\n        if (!this.parent.enableVirtualization && !this.parent.enableInfiniteScrolling) {\n            this.parent.getCurrentViewRecords()[this.editRowIndex] = data;\n        }\n    };\n    NormalEdit.prototype.requestSuccess = function (args) {\n        if (this.parent.editModule.formObj && !this.parent.editModule.formObj.isDestroyed) {\n            this.destroyElements();\n            this.stopEditStatus();\n            if (this.parent.editSettings.mode === 'Dialog' && args.action !== 'add') {\n                this.parent.element.querySelector('.e-dlgeditrow').classList.remove('e-dlgeditrow');\n            }\n        }\n    };\n    NormalEdit.prototype.editSuccess = function (e, args) {\n        if (!isNullOrUndefined(e) && !(e instanceof Array)) {\n            var rowData = 'rowData';\n            args.data = extend({}, extend({}, args[rowData], args.data), e);\n        }\n        var editArgs;\n        this.requestSuccess(args);\n        this.parent.trigger(events.beforeDataBound, args);\n        args.type = events.actionComplete;\n        this.parent.isEdit = false;\n        if (isBlazor() && this.parent.isServerRendered) {\n            this.closeForm();\n            var rowIndex = 'rowIndex';\n            var action = 'action';\n            var data = 'data';\n            editArgs = { requestType: args.requestType,\n                rowIndex: args[rowIndex], action: args[action], data: args[data] };\n            this.parent.notify('editsuccess', editArgs);\n        }\n        else {\n            this.refreshRow(args.data);\n        }\n        this.parent.notify(events.virtualScrollEditSuccess, args);\n        this.parent.editModule.checkLastRow(args.row);\n        this.parent.editModule.isLastRow = false;\n        this.updateCurrentViewData(args.data);\n        this.blazorTemplate();\n        if (!(isBlazor() && this.parent.isServerRendered)) {\n            this.editRowIndex = null;\n            this.parent.trigger(events.actionComplete, args);\n        }\n        if (isBlazor()) {\n            this.parent.notify(events.toolbarRefresh, {});\n        }\n        if (!(this.parent.isCheckBoxSelection || this.parent.selectionSettings.type === 'Multiple')\n            || (!this.parent.isPersistSelection)) {\n            if (this.parent.editSettings.mode !== 'Dialog') {\n                if (isBlazor() && this.parent.isServerRendered) {\n                    var rowIndex = 'editRowIndex';\n                    editArgs[rowIndex] = this.rowIndex > -1 ? this.rowIndex : this.editRowIndex;\n                }\n                else {\n                    this.parent.selectRow(this.rowIndex > -1 ? this.rowIndex : this.editRowIndex);\n                }\n            }\n        }\n        this.parent.hideSpinner();\n    };\n    NormalEdit.prototype.closeForm = function () {\n        if (!this.cloneRow && this.parent.isEdit) {\n            this.stopEditStatus();\n        }\n        if (this.cloneRow) {\n            this.cloneRow.remove();\n            this.cloneRow = null;\n            this.originalRow.classList.remove('e-hiddenrow');\n        }\n        if (this.parent.getFrozenColumns() && this.cloneFrozen) {\n            this.cloneFrozen.remove();\n            this.frozen.classList.remove('e-hiddenrow');\n        }\n    };\n    NormalEdit.prototype.blazorTemplate = function () {\n        var cols = this.parent.getColumns();\n        if (this.parent.editSettings.template && this.parent.editSettings.mode === 'Normal') {\n            updateBlazorTemplate(this.parent.element.id + 'editSettingsTemplate', 'Template', this.parent.editSettings);\n        }\n        for (var i = 0; i < cols.length; i++) {\n            var col = cols[i];\n            if (col.template) {\n                updateBlazorTemplate(this.parent.element.id + col.uid, 'Template', col, false);\n            }\n            if (col.editTemplate) {\n                updateBlazorTemplate(this.parent.element.id + col.uid + 'editTemplate', 'EditTemplate', col);\n            }\n        }\n    };\n    NormalEdit.prototype.editFailure = function (e) {\n        this.parent.trigger(events.actionFailure, ((isBlazor() && e instanceof Array) ? e[0] : e));\n        this.parent.hideSpinner();\n        this.parent.log('actionfailure', { error: e });\n    };\n    NormalEdit.prototype.needRefresh = function () {\n        var refresh = true;\n        var editedRow = this.parent.element.querySelector('.e-gridform');\n        if ((this.parent.enableVirtualization || this.parent.infiniteScrollSettings.enableCache)\n            && this.parent.editSettings.mode === 'Normal' && !editedRow) {\n            refresh = false;\n        }\n        return refresh;\n    };\n    NormalEdit.prototype.refreshRow = function (data) {\n        var frzCols = this.parent.getFrozenColumns();\n        var row = new RowRenderer(this.serviceLocator, null, this.parent);\n        var rowObj = this.parent.getRowObjectFromUID(this.uid);\n        if (rowObj) {\n            rowObj.changes = data;\n            this.parent.notify(events.refreshVirtualCache, data);\n            refreshForeignData(rowObj, this.parent.getForeignKeyColumns(), rowObj.changes);\n            if (this.needRefresh()) {\n                row.refresh(rowObj, this.parent.getColumns(), true);\n            }\n            if (frzCols) {\n                var uid = void 0;\n                var tr = this.parent.element.querySelector('[data-uid=' + rowObj.uid + ']');\n                if ((parentsUntil(tr, 'e-frozencontent')) || (parentsUntil(tr, 'e-frozenheader'))) {\n                    if (this.parent.infiniteScrollSettings.enableCache) {\n                        uid = this.parent.getMovableRowByIndex(rowObj.index).getAttribute('data-uid');\n                    }\n                    else {\n                        uid = this.parent.getMovableRows()[rowObj.index].getAttribute('data-uid');\n                    }\n                }\n                else {\n                    if (this.parent.infiniteScrollSettings.enableCache) {\n                        uid = this.parent.getRowByIndex(rowObj.index).getAttribute('data-uid');\n                    }\n                    else {\n                        uid = this.parent.getRows()[rowObj.index].getAttribute('data-uid');\n                    }\n                }\n                rowObj = this.parent.getRowObjectFromUID(uid);\n                rowObj.changes = data;\n                row.refresh(rowObj, this.parent.columns, true);\n                this.parent.editModule.checkLastRow(tr);\n            }\n        }\n    };\n    NormalEdit.prototype.closeEdit = function () {\n        var _this = this;\n        if (!this.parent.isEdit) {\n            return;\n        }\n        var gObj = this.parent;\n        var args = extend(this.args, {\n            requestType: 'cancel', type: events.actionBegin, cancel: false, data: this.previousData, selectedRow: gObj.selectedRowIndex\n        });\n        gObj.notify(events.virtualScrollEditCancel, args);\n        this.blazorTemplate();\n        if (isBlazor()) {\n            var form = 'form';\n            args[form] = null;\n        }\n        gObj.trigger(events.actionBegin, args, function (closeEditArgs) {\n            if (closeEditArgs.cancel) {\n                return;\n            }\n            if (_this.parent.editSettings.mode === 'Dialog') {\n                _this.parent.notify(events.dialogDestroy, {});\n            }\n            gObj.isEdit = false;\n            _this.stopEditStatus();\n            closeEditArgs.type = events.actionComplete;\n            if (gObj.editSettings.mode !== 'Dialog') {\n                if (isBlazor() && gObj.isServerRendered) {\n                    _this.closeForm();\n                }\n                else {\n                    _this.refreshRow(closeEditArgs.data);\n                }\n            }\n            if (!gObj.getContentTable().querySelector('tr.e-emptyrow') &&\n                !gObj.getContentTable().querySelector('tr.e-row')) {\n                gObj.renderModule.emptyRow();\n            }\n            if (gObj.editSettings.mode !== 'Dialog') {\n                gObj.selectRow(_this.rowIndex);\n            }\n            gObj.trigger(events.actionComplete, closeEditArgs);\n            if (isBlazor()) {\n                _this.parent.notify(events.toolbarRefresh, {});\n                _this.parent.notify('close-edit', {});\n            }\n        });\n    };\n    NormalEdit.prototype.addRecord = function (data, index) {\n        var _this = this;\n        var gObj = this.parent;\n        this.addedRowIndex = index = !isNullOrUndefined(index) ? index : 0;\n        if (data) {\n            gObj.notify(events.modelChanged, {\n                requestType: 'save', type: events.actionBegin, data: data, selectedRow: 0, action: 'add', index: index\n            });\n            return;\n        }\n        if (gObj.isEdit) {\n            return;\n        }\n        this.previousData = {};\n        this.uid = '';\n        var cols = (gObj.columnModel);\n        for (var i = 0; i < cols.length; i++) {\n            if (cols[i].field) {\n                DataUtil.setValue(cols[i].field, cols[i].defaultValue, this.previousData);\n            }\n        }\n        var args = {\n            cancel: false, foreignKeyData: {},\n            requestType: 'add', data: this.previousData, type: events.actionBegin, index: index,\n            rowData: this.previousData, target: undefined\n        };\n        var rowData = { virtualData: {} };\n        this.parent.notify(events.getVirtualData, rowData);\n        if ((this.parent.enableVirtualization || this.parent.infiniteScrollSettings.enableCache)\n            && Object.keys(rowData.virtualData).length) {\n            args.data = args.rowData = rowData.virtualData;\n        }\n        if (isBlazor()) {\n            var form = 'form';\n            args[form] = null;\n        }\n        gObj.trigger(events.actionBegin, args, function (addArgs) {\n            if (addArgs.cancel) {\n                return;\n            }\n            gObj.isEdit = true;\n            if (gObj.editSettings.mode !== 'Dialog') {\n                gObj.clearSelection();\n            }\n            _this.renderer.addNew(addArgs);\n            gObj.editModule.applyFormValidation();\n            addArgs.type = events.actionComplete;\n            addArgs.row = gObj.element.querySelector('.e-addedrow');\n            gObj.trigger(events.actionComplete, addArgs);\n            if (isBlazor()) {\n                _this.parent.notify(events.toolbarRefresh, {});\n                _this.parent.notify('start-add', {});\n            }\n            _this.args = addArgs;\n        });\n    };\n    NormalEdit.prototype.deleteRecord = function (fieldname, data) {\n        this.editRowIndex = this.parent.selectedRowIndex;\n        if (data) {\n            data = (data instanceof Array) ? data : [data];\n            var gObj = this.parent;\n            var index = 0;\n            var dataLen = Object.keys(data).length;\n            fieldname = fieldname || this.parent.getPrimaryKeyFieldNames()[0];\n            var _loop_1 = function (i) {\n                var _a;\n                var tmpRecord;\n                var contained = gObj.currentViewData.some(function (record) {\n                    tmpRecord = record;\n                    return data[i] === getObject(fieldname, record) || data[i] === record;\n                });\n                data[i] = contained ? tmpRecord : (_a = {}, _a[fieldname] = data[i], _a);\n            };\n            for (var i = 0; i < dataLen; i++) {\n                _loop_1(i);\n            }\n        }\n        var args = {\n            requestType: 'delete', type: events.actionBegin, foreignKeyData: {},\n            data: data ? data : this.parent.getSelectedRecords(), tr: this.parent.getSelectedRows(), cancel: false\n        };\n        if (!isNullOrUndefined(this.parent.commandDelIndex)) {\n            args.data[0] =\n                this.parent.getRowObjectFromUID(this.parent.getRowByIndex(this.parent.commandDelIndex).getAttribute('data-uid')).data;\n        }\n        if (this.parent.enableVirtualization && args.data.length > 1) {\n            var uid = this.parent.getSelectedRows()[0].getAttribute('data-uid');\n            args.data = [this.parent.getRowObjectFromUID(uid).data];\n        }\n        var dataInString = 'data';\n        if (isBlazor() && !this.parent.isJsComponent) {\n            args[dataInString] = args[dataInString][0];\n        }\n        this.parent.notify(events.modelChanged, args);\n    };\n    NormalEdit.prototype.stopEditStatus = function () {\n        var gObj = this.parent;\n        var elem = gObj.element.querySelector('.e-addedrow');\n        var mElem;\n        var editMElem;\n        if (gObj.getFrozenColumns()) {\n            mElem = gObj.element.querySelectorAll('.e-addedrow')[1];\n            editMElem = gObj.element.querySelectorAll('.e-editedrow')[1];\n            if (mElem) {\n                remove(mElem);\n            }\n            if (editMElem) {\n                editMElem.classList.remove('e-editedrow');\n            }\n        }\n        if (elem) {\n            remove(elem);\n        }\n        elem = gObj.element.querySelector('.e-editedrow');\n        if (elem) {\n            elem.classList.remove('e-editedrow');\n        }\n    };\n    /**\n     * @hidden\n     */\n    NormalEdit.prototype.addEventListener = function () {\n        if (this.parent.isDestroyed) {\n            return;\n        }\n        this.parent.on(events.crudAction, this.editHandler, this);\n        this.parent.on(events.doubleTap, this.dblClickHandler, this);\n        this.parent.on(events.click, this.clickHandler, this);\n        this.parent.on(events.recordAdded, this.requestSuccess, this);\n        this.parent.on(events.dblclick, this.dblClickHandler, this);\n        this.parent.on(events.deleteComplete, this.editComplete, this);\n        this.parent.on(events.saveComplete, this.editComplete, this);\n        this.parent.on('closeinline', this.closeForm, this);\n    };\n    /**\n     * @hidden\n     */\n    NormalEdit.prototype.removeEventListener = function () {\n        if (this.parent.isDestroyed) {\n            return;\n        }\n        this.parent.off(events.crudAction, this.editHandler);\n        this.parent.off(events.doubleTap, this.dblClickHandler);\n        this.parent.off(events.click, this.clickHandler);\n        this.parent.off(events.recordAdded, this.requestSuccess);\n        this.parent.off(events.dblclick, this.dblClickHandler);\n        this.parent.off(events.deleteComplete, this.editComplete);\n        this.parent.off(events.saveComplete, this.editComplete);\n        this.parent.off('closeinline', this.closeForm);\n    };\n    /**\n     * @hidden\n     */\n    NormalEdit.prototype.destroy = function () {\n        this.removeEventListener();\n        this.renderer.destroy();\n    };\n    return NormalEdit;\n}());\nexport { NormalEdit };\n"]},"metadata":{},"sourceType":"module"}