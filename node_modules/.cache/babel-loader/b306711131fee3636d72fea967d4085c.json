{"ast":null,"code":"import { Browser, remove, EventHandler, isUndefined, closest, classList, isBlazor } from '@syncfusion/ej2-base';\nimport { parentsUntil } from '../base/util';\nimport * as events from '../base/constant';\n/**\n * The `Clipboard` module is used to handle clipboard copy action.\n */\n\nvar Clipboard =\n/** @class */\nfunction () {\n  /**\n   * Constructor for the Grid clipboard module\n   * @hidden\n   */\n  function Clipboard(parent) {\n    this.copyContent = '';\n    this.isSelect = false;\n    this.parent = parent;\n    this.addEventListener();\n  }\n  /**\n   * @hidden\n   */\n\n\n  Clipboard.prototype.addEventListener = function () {\n    if (this.parent.isDestroyed) {\n      return;\n    }\n\n    this.parent.on(events.contentReady, this.initialEnd, this);\n    this.parent.on(events.keyPressed, this.keyDownHandler, this);\n    this.parent.on(events.click, this.clickHandler, this);\n    EventHandler.add(this.parent.element, 'keydown', this.pasteHandler, this);\n  };\n  /**\n   * @hidden\n   */\n\n\n  Clipboard.prototype.removeEventListener = function () {\n    if (this.parent.isDestroyed) {\n      return;\n    }\n\n    this.parent.off(events.keyPressed, this.keyDownHandler);\n    this.parent.off(events.contentReady, this.initialEnd);\n    this.parent.off(events.click, this.clickHandler);\n    EventHandler.remove(this.parent.element, 'keydown', this.pasteHandler);\n  };\n\n  Clipboard.prototype.clickHandler = function (e) {\n    var target = e.target;\n    target = parentsUntil(target, 'e-rowcell');\n  };\n\n  Clipboard.prototype.pasteHandler = function (e) {\n    var _this = this;\n\n    var grid = this.parent;\n\n    if (e.keyCode === 86 && e.ctrlKey && !grid.isEdit) {\n      var target = closest(document.activeElement, '.e-rowcell');\n\n      if (!target || !grid.editSettings.allowEditing || grid.editSettings.mode !== 'Batch' || grid.selectionSettings.mode !== 'Cell' || grid.selectionSettings.cellSelectionMode === 'Flow') {\n        return;\n      }\n\n      this.activeElement = document.activeElement;\n      this.clipBoardTextArea.value = '';\n      var x_1 = window.scrollX;\n      var y_1 = window.scrollY;\n      this.clipBoardTextArea.focus();\n      setTimeout(function () {\n        _this.activeElement.focus();\n\n        window.scrollTo(x_1, y_1);\n\n        _this.paste(_this.clipBoardTextArea.value, _this.parent.getSelectedRowCellIndexes()[0].rowIndex, _this.parent.getSelectedRowCellIndexes()[0].cellIndexes[0]);\n      }, 10);\n    }\n  };\n  /**\n   * Paste data from clipboard to selected cells.\n   * @param {boolean} data - Specifies the date for paste.\n   * @param {boolean} rowIndex - Specifies the row index.\n   * @param {boolean} colIndex - Specifies the column index.\n   */\n\n\n  Clipboard.prototype.paste = function (data, rowIndex, colIndex) {\n    var grid = this.parent;\n    var cIdx = colIndex;\n    var rIdx = rowIndex;\n    var col;\n    var value;\n    var isAvail;\n\n    if (!grid.editSettings.allowEditing || grid.editSettings.mode !== 'Batch' || grid.selectionSettings.mode !== 'Cell' || grid.selectionSettings.cellSelectionMode === 'Flow') {\n      return;\n    }\n\n    var rows = data.split('\\n');\n    var cols;\n    var dataRows = grid.getDataRows();\n    var mRows;\n    var isFrozen = this.parent.getFrozenColumns();\n\n    if (isFrozen) {\n      mRows = grid.getMovableDataRows();\n    }\n\n    for (var r = 0; r < rows.length; r++) {\n      cols = rows[r].split('\\t');\n      cIdx = colIndex;\n\n      if (r === rows.length - 1 && rows[r] === '' || isUndefined(grid.getRowByIndex(rIdx))) {\n        cIdx++;\n        break;\n      }\n\n      for (var c = 0; c < cols.length; c++) {\n        isAvail = grid.getCellFromIndex(rIdx, cIdx);\n\n        if (isFrozen) {\n          var fTr = dataRows[rIdx];\n          var mTr = mRows[rIdx];\n          isAvail = !fTr.querySelector('[aria-colindex=\"' + cIdx + '\"]') ? mTr.querySelector('[aria-colindex=\"' + cIdx + '\"]') : true;\n        }\n\n        if (!isAvail) {\n          cIdx++;\n          break;\n        }\n\n        col = grid.getColumnByIndex(cIdx);\n        value = col.getParser() ? col.getParser()(cols[c]) : cols[c];\n\n        if (col.allowEditing && !col.isPrimaryKey && !col.template) {\n          var args = {\n            column: col,\n            data: value,\n            rowIndex: rIdx\n          };\n          this.parent.trigger(events.beforePaste, args);\n          rIdx = args.rowIndex;\n\n          if (!args.cancel) {\n            if (grid.editModule) {\n              if (col.type === 'number') {\n                this.parent.editModule.updateCell(rIdx, col.field, parseInt(args.data, 10));\n              } else {\n                grid.editModule.updateCell(rIdx, col.field, args.data);\n              }\n            }\n          }\n        }\n\n        cIdx++;\n      }\n\n      rIdx++;\n    }\n\n    grid.selectionModule.selectCellsByRange({\n      rowIndex: rowIndex,\n      cellIndex: colIndex\n    }, {\n      rowIndex: rIdx - 1,\n      cellIndex: cIdx - 1\n    });\n    var cell = this.parent.getCellFromIndex(rIdx - 1, cIdx - 1);\n\n    if (cell) {\n      classList(cell, ['e-focus', 'e-focused'], []);\n    }\n  };\n\n  Clipboard.prototype.initialEnd = function () {\n    this.parent.off(events.contentReady, this.initialEnd);\n    this.clipBoardTextArea = this.parent.createElement('textarea', {\n      className: 'e-clipboard',\n      styles: 'opacity: 0',\n      attrs: {\n        tabindex: '-1',\n        'aria-label': 'clipboard'\n      }\n    });\n    this.parent.element.appendChild(this.clipBoardTextArea);\n  };\n\n  Clipboard.prototype.keyDownHandler = function (e) {\n    if (e.action === 'ctrlPlusC') {\n      this.copy();\n    } else if (e.action === 'ctrlShiftPlusH') {\n      this.copy(true);\n    }\n  };\n\n  Clipboard.prototype.setCopyData = function (withHeader) {\n    if (window.getSelection().toString() === '') {\n      var isFrozen = this.parent.getFrozenColumns();\n      this.clipBoardTextArea.value = this.copyContent = '';\n      var mRows = void 0;\n      var rows = this.parent.getRows();\n\n      if (isFrozen) {\n        mRows = this.parent.getMovableDataRows();\n      }\n\n      if (this.parent.selectionSettings.mode !== 'Cell') {\n        var selectedIndexes = this.parent.getSelectedRowIndexes().sort(function (a, b) {\n          return a - b;\n        });\n\n        if (withHeader) {\n          var headerTextArray = [];\n\n          for (var i = 0; i < this.parent.getVisibleColumns().length; i++) {\n            headerTextArray[i] = this.parent.getVisibleColumns()[i].headerText;\n          }\n\n          this.getCopyData(headerTextArray, false, '\\t', withHeader);\n          this.copyContent += '\\n';\n        }\n\n        for (var i = 0; i < selectedIndexes.length; i++) {\n          if (i > 0) {\n            this.copyContent += '\\n';\n          }\n\n          var cells = [].slice.call(rows[selectedIndexes[i]].querySelectorAll('.e-rowcell'));\n\n          if (isFrozen) {\n            cells.push.apply(cells, [].slice.call(mRows[selectedIndexes[i]].querySelectorAll('.e-rowcell')));\n          }\n\n          this.getCopyData(cells, false, '\\t', withHeader);\n        }\n      } else {\n        var obj = this.checkBoxSelection();\n\n        if (obj.status) {\n          if (withHeader) {\n            var headers = [];\n\n            for (var i = 0; i < obj.colIndexes.length; i++) {\n              headers.push(this.parent.getColumnHeaderByIndex(obj.colIndexes[i]));\n            }\n\n            this.getCopyData(headers, false, '\\t', withHeader);\n            this.copyContent += '\\n';\n          }\n\n          for (var i = 0; i < obj.rowIndexes.length; i++) {\n            if (i > 0) {\n              this.copyContent += '\\n';\n            }\n\n            var cells = [].slice.call(rows[obj.rowIndexes[i]].querySelectorAll('.e-cellselectionbackground'));\n\n            if (isFrozen) {\n              cells.push.apply(cells, [].slice.call(mRows[obj.rowIndexes[i]].querySelectorAll('.e-cellselectionbackground')));\n            }\n\n            this.getCopyData(cells, false, '\\t', withHeader);\n          }\n        } else {\n          this.getCopyData([].slice.call(this.parent.element.querySelectorAll('.e-cellselectionbackground')), true, '\\n', withHeader);\n        }\n      }\n\n      var args = {\n        data: this.copyContent,\n        cancel: false\n      };\n      this.parent.trigger(events.beforeCopy, args);\n\n      if (args.cancel) {\n        return;\n      }\n\n      this.clipBoardTextArea.value = this.copyContent = args.data;\n\n      if (!Browser.userAgent.match(/ipad|ipod|iphone/i)) {\n        this.clipBoardTextArea.select();\n      } else {\n        this.clipBoardTextArea.setSelectionRange(0, this.clipBoardTextArea.value.length);\n      }\n\n      this.isSelect = true;\n    }\n  };\n\n  Clipboard.prototype.getCopyData = function (cells, isCell, splitKey, withHeader) {\n    var isElement = typeof cells[0] !== 'string';\n\n    for (var j = 0; j < cells.length; j++) {\n      if (withHeader && isCell) {\n        this.copyContent += this.parent.getColumns()[parseInt(cells[j].getAttribute('aria-colindex'), 10)].headerText + '\\n';\n      }\n\n      if (isElement) {\n        if (!cells[j].classList.contains('e-hide')) {\n          if (isBlazor()) {\n            if (!cells[j].classList.contains('e-gridchkbox') && Object.keys(cells[j].querySelectorAll('.e-check')).length) {\n              this.copyContent += true;\n            } else if (!cells[j].classList.contains('e-gridchkbox') && Object.keys(cells[j].querySelectorAll('.e-uncheck')).length) {\n              this.copyContent += false;\n            } else {\n              this.copyContent += cells[j].innerText;\n            }\n          } else {\n            this.copyContent += cells[j].innerText;\n          }\n        }\n      } else {\n        this.copyContent += cells[j];\n      }\n\n      if (j < cells.length - 1) {\n        this.copyContent += splitKey;\n      }\n    }\n  };\n  /**\n   * Copy selected rows or cells data into clipboard.\n   * @param {boolean} withHeader - Specifies whether the column header data need to be copied or not.\n   */\n\n\n  Clipboard.prototype.copy = function (withHeader) {\n    if (document.queryCommandSupported('copy')) {\n      this.setCopyData(withHeader);\n      document.execCommand('copy');\n      this.clipBoardTextArea.blur();\n    }\n\n    if (this.isSelect) {\n      window.getSelection().removeAllRanges();\n      this.isSelect = false;\n    }\n  };\n  /**\n   * For internal use only - Get the module name.\n   * @private\n   */\n\n\n  Clipboard.prototype.getModuleName = function () {\n    return 'clipboard';\n  };\n  /**\n   * To destroy the clipboard\n   * @return {void}\n   * @hidden\n   */\n\n\n  Clipboard.prototype.destroy = function () {\n    this.removeEventListener();\n\n    if (this.clipBoardTextArea) {\n      remove(this.clipBoardTextArea);\n    }\n  };\n\n  Clipboard.prototype.checkBoxSelection = function () {\n    var gridObj = this.parent;\n    var obj = {\n      status: false\n    };\n\n    if (gridObj.selectionSettings.mode === 'Cell') {\n      var rowCellIndxes = gridObj.getSelectedRowCellIndexes();\n      var str = void 0;\n      var isBox = void 0;\n      var rowIndexes = [];\n      var i = void 0;\n\n      for (i = 0; i < rowCellIndxes.length; i++) {\n        if (rowCellIndxes[i].cellIndexes.length) {\n          rowIndexes.push(rowCellIndxes[i].rowIndex);\n        }\n\n        if (rowCellIndxes[i].cellIndexes.length) {\n          if (!str) {\n            str = JSON.stringify(rowCellIndxes[i].cellIndexes.sort());\n          }\n\n          if (str !== JSON.stringify(rowCellIndxes[i].cellIndexes.sort())) {\n            break;\n          }\n        }\n      }\n\n      rowIndexes.sort(function (a, b) {\n        return a - b;\n      });\n\n      if (i === rowCellIndxes.length && rowIndexes[rowIndexes.length - 1] - rowIndexes[0] === rowIndexes.length - 1) {\n        obj = {\n          status: true,\n          rowIndexes: rowIndexes,\n          colIndexes: rowCellIndxes[0].cellIndexes\n        };\n      }\n    }\n\n    return obj;\n  };\n\n  return Clipboard;\n}();\n\nexport { Clipboard };","map":{"version":3,"sources":["/home/nikhil/Desktop/data_grid_editor-master/node_modules/@syncfusion/ej2-grids/src/grid/actions/clipboard.js"],"names":["Browser","remove","EventHandler","isUndefined","closest","classList","isBlazor","parentsUntil","events","Clipboard","parent","copyContent","isSelect","addEventListener","prototype","isDestroyed","on","contentReady","initialEnd","keyPressed","keyDownHandler","click","clickHandler","add","element","pasteHandler","removeEventListener","off","e","target","_this","grid","keyCode","ctrlKey","isEdit","document","activeElement","editSettings","allowEditing","mode","selectionSettings","cellSelectionMode","clipBoardTextArea","value","x_1","window","scrollX","y_1","scrollY","focus","setTimeout","scrollTo","paste","getSelectedRowCellIndexes","rowIndex","cellIndexes","data","colIndex","cIdx","rIdx","col","isAvail","rows","split","cols","dataRows","getDataRows","mRows","isFrozen","getFrozenColumns","getMovableDataRows","r","length","getRowByIndex","c","getCellFromIndex","fTr","mTr","querySelector","getColumnByIndex","getParser","isPrimaryKey","template","args","column","trigger","beforePaste","cancel","editModule","type","updateCell","field","parseInt","selectionModule","selectCellsByRange","cellIndex","cell","createElement","className","styles","attrs","tabindex","appendChild","action","copy","setCopyData","withHeader","getSelection","toString","getRows","selectedIndexes","getSelectedRowIndexes","sort","a","b","headerTextArray","i","getVisibleColumns","headerText","getCopyData","cells","slice","call","querySelectorAll","push","apply","obj","checkBoxSelection","status","headers","colIndexes","getColumnHeaderByIndex","rowIndexes","beforeCopy","userAgent","match","select","setSelectionRange","isCell","splitKey","isElement","j","getColumns","getAttribute","contains","Object","keys","innerText","queryCommandSupported","execCommand","blur","removeAllRanges","getModuleName","destroy","gridObj","rowCellIndxes","str","isBox","JSON","stringify"],"mappings":"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","sourcesContent":["import { Browser, remove, EventHandler, isUndefined, closest, classList, isBlazor } from '@syncfusion/ej2-base';\nimport { parentsUntil } from '../base/util';\nimport * as events from '../base/constant';\n/**\n * The `Clipboard` module is used to handle clipboard copy action.\n */\nvar Clipboard = /** @class */ (function () {\n    /**\n     * Constructor for the Grid clipboard module\n     * @hidden\n     */\n    function Clipboard(parent) {\n        this.copyContent = '';\n        this.isSelect = false;\n        this.parent = parent;\n        this.addEventListener();\n    }\n    /**\n     * @hidden\n     */\n    Clipboard.prototype.addEventListener = function () {\n        if (this.parent.isDestroyed) {\n            return;\n        }\n        this.parent.on(events.contentReady, this.initialEnd, this);\n        this.parent.on(events.keyPressed, this.keyDownHandler, this);\n        this.parent.on(events.click, this.clickHandler, this);\n        EventHandler.add(this.parent.element, 'keydown', this.pasteHandler, this);\n    };\n    /**\n     * @hidden\n     */\n    Clipboard.prototype.removeEventListener = function () {\n        if (this.parent.isDestroyed) {\n            return;\n        }\n        this.parent.off(events.keyPressed, this.keyDownHandler);\n        this.parent.off(events.contentReady, this.initialEnd);\n        this.parent.off(events.click, this.clickHandler);\n        EventHandler.remove(this.parent.element, 'keydown', this.pasteHandler);\n    };\n    Clipboard.prototype.clickHandler = function (e) {\n        var target = e.target;\n        target = parentsUntil(target, 'e-rowcell');\n    };\n    Clipboard.prototype.pasteHandler = function (e) {\n        var _this = this;\n        var grid = this.parent;\n        if (e.keyCode === 86 && e.ctrlKey && !grid.isEdit) {\n            var target = closest(document.activeElement, '.e-rowcell');\n            if (!target || !grid.editSettings.allowEditing || grid.editSettings.mode !== 'Batch' ||\n                grid.selectionSettings.mode !== 'Cell' || grid.selectionSettings.cellSelectionMode === 'Flow') {\n                return;\n            }\n            this.activeElement = document.activeElement;\n            this.clipBoardTextArea.value = '';\n            var x_1 = window.scrollX;\n            var y_1 = window.scrollY;\n            this.clipBoardTextArea.focus();\n            setTimeout(function () {\n                _this.activeElement.focus();\n                window.scrollTo(x_1, y_1);\n                _this.paste(_this.clipBoardTextArea.value, _this.parent.getSelectedRowCellIndexes()[0].rowIndex, _this.parent.getSelectedRowCellIndexes()[0].cellIndexes[0]);\n            }, 10);\n        }\n    };\n    /**\n     * Paste data from clipboard to selected cells.\n     * @param {boolean} data - Specifies the date for paste.\n     * @param {boolean} rowIndex - Specifies the row index.\n     * @param {boolean} colIndex - Specifies the column index.\n     */\n    Clipboard.prototype.paste = function (data, rowIndex, colIndex) {\n        var grid = this.parent;\n        var cIdx = colIndex;\n        var rIdx = rowIndex;\n        var col;\n        var value;\n        var isAvail;\n        if (!grid.editSettings.allowEditing || grid.editSettings.mode !== 'Batch' ||\n            grid.selectionSettings.mode !== 'Cell' || grid.selectionSettings.cellSelectionMode === 'Flow') {\n            return;\n        }\n        var rows = data.split('\\n');\n        var cols;\n        var dataRows = grid.getDataRows();\n        var mRows;\n        var isFrozen = this.parent.getFrozenColumns();\n        if (isFrozen) {\n            mRows = grid.getMovableDataRows();\n        }\n        for (var r = 0; r < rows.length; r++) {\n            cols = rows[r].split('\\t');\n            cIdx = colIndex;\n            if ((r === rows.length - 1 && rows[r] === '') || isUndefined(grid.getRowByIndex(rIdx))) {\n                cIdx++;\n                break;\n            }\n            for (var c = 0; c < cols.length; c++) {\n                isAvail = grid.getCellFromIndex(rIdx, cIdx);\n                if (isFrozen) {\n                    var fTr = dataRows[rIdx];\n                    var mTr = mRows[rIdx];\n                    isAvail = !fTr.querySelector('[aria-colindex=\"' + cIdx + '\"]') ?\n                        mTr.querySelector('[aria-colindex=\"' + cIdx + '\"]') : true;\n                }\n                if (!isAvail) {\n                    cIdx++;\n                    break;\n                }\n                col = grid.getColumnByIndex(cIdx);\n                value = col.getParser() ? col.getParser()(cols[c]) : cols[c];\n                if (col.allowEditing && !col.isPrimaryKey && !col.template) {\n                    var args = {\n                        column: col,\n                        data: value,\n                        rowIndex: rIdx\n                    };\n                    this.parent.trigger(events.beforePaste, args);\n                    rIdx = args.rowIndex;\n                    if (!args.cancel) {\n                        if (grid.editModule) {\n                            if (col.type === 'number') {\n                                this.parent.editModule.updateCell(rIdx, col.field, parseInt(args.data, 10));\n                            }\n                            else {\n                                grid.editModule.updateCell(rIdx, col.field, args.data);\n                            }\n                        }\n                    }\n                }\n                cIdx++;\n            }\n            rIdx++;\n        }\n        grid.selectionModule.selectCellsByRange({ rowIndex: rowIndex, cellIndex: colIndex }, { rowIndex: rIdx - 1, cellIndex: cIdx - 1 });\n        var cell = this.parent.getCellFromIndex(rIdx - 1, cIdx - 1);\n        if (cell) {\n            classList(cell, ['e-focus', 'e-focused'], []);\n        }\n    };\n    Clipboard.prototype.initialEnd = function () {\n        this.parent.off(events.contentReady, this.initialEnd);\n        this.clipBoardTextArea = this.parent.createElement('textarea', {\n            className: 'e-clipboard',\n            styles: 'opacity: 0',\n            attrs: { tabindex: '-1', 'aria-label': 'clipboard' }\n        });\n        this.parent.element.appendChild(this.clipBoardTextArea);\n    };\n    Clipboard.prototype.keyDownHandler = function (e) {\n        if (e.action === 'ctrlPlusC') {\n            this.copy();\n        }\n        else if (e.action === 'ctrlShiftPlusH') {\n            this.copy(true);\n        }\n    };\n    Clipboard.prototype.setCopyData = function (withHeader) {\n        if (window.getSelection().toString() === '') {\n            var isFrozen = this.parent.getFrozenColumns();\n            this.clipBoardTextArea.value = this.copyContent = '';\n            var mRows = void 0;\n            var rows = this.parent.getRows();\n            if (isFrozen) {\n                mRows = this.parent.getMovableDataRows();\n            }\n            if (this.parent.selectionSettings.mode !== 'Cell') {\n                var selectedIndexes = this.parent.getSelectedRowIndexes().sort(function (a, b) { return a - b; });\n                if (withHeader) {\n                    var headerTextArray = [];\n                    for (var i = 0; i < this.parent.getVisibleColumns().length; i++) {\n                        headerTextArray[i] = this.parent.getVisibleColumns()[i].headerText;\n                    }\n                    this.getCopyData(headerTextArray, false, '\\t', withHeader);\n                    this.copyContent += '\\n';\n                }\n                for (var i = 0; i < selectedIndexes.length; i++) {\n                    if (i > 0) {\n                        this.copyContent += '\\n';\n                    }\n                    var cells = [].slice.call(rows[selectedIndexes[i]].querySelectorAll('.e-rowcell'));\n                    if (isFrozen) {\n                        cells.push.apply(cells, [].slice.call(mRows[selectedIndexes[i]].querySelectorAll('.e-rowcell')));\n                    }\n                    this.getCopyData(cells, false, '\\t', withHeader);\n                }\n            }\n            else {\n                var obj = this.checkBoxSelection();\n                if (obj.status) {\n                    if (withHeader) {\n                        var headers = [];\n                        for (var i = 0; i < obj.colIndexes.length; i++) {\n                            headers.push(this.parent.getColumnHeaderByIndex(obj.colIndexes[i]));\n                        }\n                        this.getCopyData(headers, false, '\\t', withHeader);\n                        this.copyContent += '\\n';\n                    }\n                    for (var i = 0; i < obj.rowIndexes.length; i++) {\n                        if (i > 0) {\n                            this.copyContent += '\\n';\n                        }\n                        var cells = [].slice.call(rows[obj.rowIndexes[i]].\n                            querySelectorAll('.e-cellselectionbackground'));\n                        if (isFrozen) {\n                            cells.push.apply(cells, [].slice.call(mRows[obj.rowIndexes[i]].querySelectorAll('.e-cellselectionbackground')));\n                        }\n                        this.getCopyData(cells, false, '\\t', withHeader);\n                    }\n                }\n                else {\n                    this.getCopyData([].slice.call(this.parent.element.querySelectorAll('.e-cellselectionbackground')), true, '\\n', withHeader);\n                }\n            }\n            var args = {\n                data: this.copyContent,\n                cancel: false,\n            };\n            this.parent.trigger(events.beforeCopy, args);\n            if (args.cancel) {\n                return;\n            }\n            this.clipBoardTextArea.value = this.copyContent = args.data;\n            if (!Browser.userAgent.match(/ipad|ipod|iphone/i)) {\n                this.clipBoardTextArea.select();\n            }\n            else {\n                this.clipBoardTextArea.setSelectionRange(0, this.clipBoardTextArea.value.length);\n            }\n            this.isSelect = true;\n        }\n    };\n    Clipboard.prototype.getCopyData = function (cells, isCell, splitKey, withHeader) {\n        var isElement = typeof cells[0] !== 'string';\n        for (var j = 0; j < cells.length; j++) {\n            if (withHeader && isCell) {\n                this.copyContent += this.parent.getColumns()[parseInt(cells[j].getAttribute('aria-colindex'), 10)].headerText + '\\n';\n            }\n            if (isElement) {\n                if (!cells[j].classList.contains('e-hide')) {\n                    if (isBlazor()) {\n                        if ((!cells[j].classList.contains('e-gridchkbox')) &&\n                            Object.keys(cells[j].querySelectorAll('.e-check')).length) {\n                            this.copyContent += true;\n                        }\n                        else if ((!cells[j].classList.contains('e-gridchkbox')) &&\n                            Object.keys(cells[j].querySelectorAll('.e-uncheck')).length) {\n                            this.copyContent += false;\n                        }\n                        else {\n                            this.copyContent += cells[j].innerText;\n                        }\n                    }\n                    else {\n                        this.copyContent += cells[j].innerText;\n                    }\n                }\n            }\n            else {\n                this.copyContent += cells[j];\n            }\n            if (j < cells.length - 1) {\n                this.copyContent += splitKey;\n            }\n        }\n    };\n    /**\n     * Copy selected rows or cells data into clipboard.\n     * @param {boolean} withHeader - Specifies whether the column header data need to be copied or not.\n     */\n    Clipboard.prototype.copy = function (withHeader) {\n        if (document.queryCommandSupported('copy')) {\n            this.setCopyData(withHeader);\n            document.execCommand('copy');\n            this.clipBoardTextArea.blur();\n        }\n        if (this.isSelect) {\n            window.getSelection().removeAllRanges();\n            this.isSelect = false;\n        }\n    };\n    /**\n     * For internal use only - Get the module name.\n     * @private\n     */\n    Clipboard.prototype.getModuleName = function () {\n        return 'clipboard';\n    };\n    /**\n     * To destroy the clipboard\n     * @return {void}\n     * @hidden\n     */\n    Clipboard.prototype.destroy = function () {\n        this.removeEventListener();\n        if (this.clipBoardTextArea) {\n            remove(this.clipBoardTextArea);\n        }\n    };\n    Clipboard.prototype.checkBoxSelection = function () {\n        var gridObj = this.parent;\n        var obj = { status: false };\n        if (gridObj.selectionSettings.mode === 'Cell') {\n            var rowCellIndxes = gridObj.getSelectedRowCellIndexes();\n            var str = void 0;\n            var isBox = void 0;\n            var rowIndexes = [];\n            var i = void 0;\n            for (i = 0; i < rowCellIndxes.length; i++) {\n                if (rowCellIndxes[i].cellIndexes.length) {\n                    rowIndexes.push(rowCellIndxes[i].rowIndex);\n                }\n                if (rowCellIndxes[i].cellIndexes.length) {\n                    if (!str) {\n                        str = JSON.stringify(rowCellIndxes[i].cellIndexes.sort());\n                    }\n                    if (str !== JSON.stringify(rowCellIndxes[i].cellIndexes.sort())) {\n                        break;\n                    }\n                }\n            }\n            rowIndexes.sort(function (a, b) { return a - b; });\n            if (i === rowCellIndxes.length && rowIndexes[rowIndexes.length - 1] - rowIndexes[0] === rowIndexes.length - 1) {\n                obj = { status: true, rowIndexes: rowIndexes, colIndexes: rowCellIndxes[0].cellIndexes };\n            }\n        }\n        return obj;\n    };\n    return Clipboard;\n}());\nexport { Clipboard };\n"]},"metadata":{},"sourceType":"module"}