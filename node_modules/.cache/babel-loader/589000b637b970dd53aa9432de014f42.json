{"ast":null,"code":"import { isNullOrUndefined, addClass, extend, closest, updateBlazorTemplate, isBlazor } from '@syncfusion/ej2-base';\nimport * as events from '../base/constant';\nimport { appendChildren, alignFrozenEditForm } from '../base/util';\n/**\n * Edit render module is used to render grid edit row.\n * @hidden\n */\n\nvar InlineEditRender =\n/** @class */\nfunction () {\n  /**\n   * Constructor for render module\n   */\n  function InlineEditRender(parent) {\n    this.parent = parent;\n  }\n\n  InlineEditRender.prototype.addNew = function (elements, args) {\n    this.isEdit = false;\n    var mTbody;\n    var tbody;\n\n    if (this.parent.frozenRows && this.parent.editSettings.newRowPosition === 'Top') {\n      tbody = this.parent.getHeaderContent().querySelector('tbody');\n    } else {\n      tbody = this.parent.getContentTable().querySelector('tbody');\n    }\n\n    args.row = this.parent.createElement('tr', {\n      className: 'e-row e-addedrow'\n    });\n\n    if (tbody.querySelector('.e-emptyrow')) {\n      tbody.querySelector('.e-emptyrow').remove();\n\n      if (this.parent.getFrozenColumns()) {\n        var moveTbody = this.parent.getContent().querySelector('.e-movablecontent').querySelector('tbody');\n        moveTbody.firstElementChild.remove();\n      }\n    }\n\n    this.parent.editSettings.newRowPosition === 'Top' ? tbody.insertBefore(args.row, tbody.firstChild) : tbody.appendChild(args.row);\n    args.row.appendChild(this.getEditElement(elements, false, undefined, args, true));\n    this.parent.editModule.checkLastRow(args.row, args);\n\n    if (this.parent.getFrozenColumns()) {\n      var mEle = this.renderMovableform(args.row, args);\n\n      if (this.parent.frozenRows && this.parent.editSettings.newRowPosition === 'Top') {\n        mTbody = this.parent.getHeaderContent().querySelector('.e-movableheader').querySelector('tbody');\n      } else {\n        mTbody = this.parent.getContent().querySelector('.e-movablecontent').querySelector('tbody');\n      }\n\n      this.parent.editSettings.newRowPosition === 'Top' ? mTbody.insertBefore(mEle, mTbody.firstChild) : mTbody.appendChild(mEle);\n      args.row.querySelector('.e-normaledit').setAttribute('colspan', this.parent.getVisibleFrozenColumns() + '');\n      mEle.setAttribute('colspan', '' + (this.parent.getVisibleColumns().length - this.parent.getVisibleFrozenColumns()));\n\n      if (this.parent.height === 'auto') {\n        this.parent.notify(events.frozenHeight, {});\n      }\n    }\n  };\n\n  InlineEditRender.prototype.renderMovableform = function (ele, args) {\n    var mEle = ele.cloneNode(true);\n    var form = args.movableForm = mEle.querySelector('form');\n\n    if (this.parent.editSettings.template) {\n      form.innerHTML = '';\n      this.appendChildren(form, args.rowData, false);\n      return mEle;\n    }\n\n    this.renderMovable(ele, mEle);\n    mEle.querySelector('colgroup').innerHTML = this.parent.getHeaderContent().querySelector('.e-movableheader').querySelector('colgroup').innerHTML;\n    return mEle;\n  };\n\n  InlineEditRender.prototype.updateFreezeEdit = function (row, td) {\n    td = td.concat([].slice.call(this.getFreezeRow(row).querySelectorAll('td.e-rowcell')));\n    return td;\n  };\n\n  InlineEditRender.prototype.getFreezeRow = function (row) {\n    if (this.parent.getFrozenColumns()) {\n      var idx = parseInt(row.getAttribute('aria-rowindex'), 10);\n      var fCont = this.parent.getContent().querySelector('.e-frozencontent').querySelector('tbody');\n      var mCont = this.parent.getContent().querySelector('.e-movablecontent').querySelector('tbody');\n      var fHdr = this.parent.getHeaderContent().querySelector('.e-frozenheader').querySelector('tbody');\n      var mHdr = this.parent.getHeaderContent().querySelector('.e-movableheader').querySelector('tbody');\n\n      if (this.parent.frozenRows && idx >= this.parent.frozenRows) {\n        idx -= this.parent.frozenRows;\n      }\n\n      if (fCont.contains(row)) {\n        if (this.parent.infiniteScrollSettings.enableCache) {\n          return this.parent.getMovableRowByIndex(idx);\n        }\n\n        return mCont.children[idx];\n      } else if (mCont.contains(row)) {\n        if (this.parent.infiniteScrollSettings.enableCache) {\n          return this.parent.getRowByIndex(idx);\n        }\n\n        return fCont.children[idx];\n      } else if (fHdr.contains(row)) {\n        return mHdr.children[idx];\n      } else if (mHdr.contains(row)) {\n        return fHdr.children[idx];\n      }\n    }\n\n    return row;\n  };\n\n  InlineEditRender.prototype.update = function (elements, args) {\n    this.isEdit = true;\n    var cloneRow = 'cloneRow';\n\n    if (closest(args.row, '.e-movablecontent')) {\n      args.row = this.getFreezeRow(args.row);\n\n      if (isBlazor() && this.parent.isServerRendered) {\n        args[cloneRow] = args.row.cloneNode(true);\n      }\n    }\n\n    if (isBlazor() && this.parent.isServerRendered) {\n      args.row.parentNode.insertBefore(args[cloneRow], args.row);\n      args.row.classList.add('e-hiddenrow');\n      var tdElement = [].slice.call(args[cloneRow].querySelectorAll('td.e-rowcell'));\n      args[cloneRow].innerHTML = '';\n      tdElement = this.updateFreezeEdit(args[cloneRow], tdElement);\n      args[cloneRow].appendChild(this.getEditElement(elements, true, tdElement, args, true));\n      args[cloneRow].classList.add('e-editedrow');\n      this.refreshFreezeEdit(args[cloneRow], args);\n    } else {\n      var tdElement = [].slice.call(args.row.querySelectorAll('td.e-rowcell'));\n      args.row.innerHTML = '';\n      tdElement = this.updateFreezeEdit(args.row, tdElement);\n      args.row.appendChild(this.getEditElement(elements, true, tdElement, args, true));\n      args.row.classList.add('e-editedrow');\n      this.parent.editModule.checkLastRow(args.row, args);\n      this.refreshFreezeEdit(args.row, args);\n    }\n  };\n\n  InlineEditRender.prototype.refreshFreezeEdit = function (row, args) {\n    var td = row.firstChild;\n    var fCls;\n    var cont;\n    var frozen = 'frozen';\n    var cloneFrozen = 'cloneFrozen';\n    var idx = parseInt(row.getAttribute('aria-rowindex'), 10);\n\n    if (this.parent.getFrozenColumns()) {\n      if (idx < this.parent.frozenRows) {\n        cont = this.parent.getHeaderContent();\n        fCls = '.e-frozenheader';\n      } else {\n        cont = this.parent.getContent();\n        fCls = '.e-frozencontent';\n      }\n\n      var mTd = td.cloneNode(true);\n      var form = args.movableForm = mTd.querySelector('form');\n\n      if (this.parent.editSettings.template) {\n        form.innerHTML = '';\n        this.appendChildren(form, args.rowData, false);\n      }\n\n      var fRows = void 0;\n\n      if (cont.querySelector(fCls).contains(row)) {\n        fRows = this.parent.getMovableRowByIndex(idx);\n\n        if (isBlazor() && this.parent.isServerRendered) {\n          args[frozen] = fRows;\n          args[cloneFrozen] = fRows.cloneNode(true);\n          fRows.classList.add('e-hiddenrow');\n          fRows.parentNode.insertBefore(args[cloneFrozen], fRows);\n          this.updateFrozenCont(args[cloneFrozen], td, mTd);\n        } else {\n          this.updateFrozenCont(fRows, td, mTd);\n        }\n      } else {\n        fRows = this.parent.getRowByIndex(idx);\n\n        if (isBlazor() && this.parent.isServerRendered) {\n          args[frozen] = fRows;\n          args[cloneFrozen] = fRows.cloneNode(true);\n          fRows.parentNode.insertBefore(args[cloneFrozen], fRows);\n          fRows.classList.add('e-hiddenrow');\n          this.updateFrozenCont(args[cloneFrozen], mTd, td);\n        } else {\n          this.updateFrozenCont(fRows, mTd, td);\n        }\n      }\n\n      if (isBlazor() && this.parent.isServerRendered) {\n        args[cloneFrozen].appendChild(mTd);\n        args[cloneFrozen].classList.add('e-editedrow');\n      } else {\n        fRows.appendChild(mTd);\n        fRows.classList.add('e-editedrow');\n      }\n\n      alignFrozenEditForm(args.movableForm.querySelector('td:not(.e-hide)'), args.form.querySelector('td:not(.e-hide)'));\n    }\n  };\n\n  InlineEditRender.prototype.updateFrozenCont = function (row, ele, mEle) {\n    row.innerHTML = '';\n\n    if (!this.parent.editSettings.template) {\n      this.renderMovable(ele, mEle);\n      mEle.querySelector('colgroup').innerHTML = this.parent.getHeaderContent().querySelector('.e-movableheader').querySelector('colgroup').innerHTML;\n    }\n\n    ele.setAttribute('colspan', this.parent.getVisibleFrozenColumns() + '');\n    mEle.setAttribute('colspan', this.parent.getVisibleColumns().length - this.parent.getVisibleFrozenColumns() + '');\n  };\n\n  InlineEditRender.prototype.renderMovable = function (ele, mEle) {\n    var frzCols = this.parent.getFrozenColumns();\n    mEle.querySelector('tr').innerHTML = '';\n\n    for (var i = frzCols; i < this.parent.getColumns().length; i++) {\n      mEle.querySelector('tr').appendChild(ele.querySelector('tr').removeChild(ele.querySelector('tr').children[frzCols]));\n    }\n  };\n\n  InlineEditRender.prototype.getEditElement = function (elements, isEdit, tdElement, args, isFrozen) {\n    var gObj = this.parent;\n    var gLen = 0;\n    var isDetail = !isNullOrUndefined(gObj.detailTemplate) || !isNullOrUndefined(gObj.childGrid) ? 1 : 0;\n\n    if (gObj.allowGrouping) {\n      gLen = gObj.groupSettings.columns.length;\n    }\n\n    var td = this.parent.createElement('td', {\n      className: 'e-editcell e-normaledit',\n      attrs: {\n        colspan: (gObj.getVisibleColumns().length - gObj.getVisibleFrozenColumns() + this.parent.getIndentCount()).toString()\n      }\n    });\n    var form = args.form = this.parent.createElement('form', {\n      id: gObj.element.id + 'EditForm',\n      className: 'e-gridform'\n    });\n\n    if (this.parent.editSettings.template) {\n      this.appendChildren(form, args.rowData, isFrozen);\n      td.appendChild(form);\n      return td;\n    }\n\n    var table = this.parent.createElement('table', {\n      className: 'e-table e-inline-edit',\n      attrs: {\n        cellspacing: '0.25'\n      }\n    });\n    table.appendChild(gObj.getContentTable().querySelector('colgroup').cloneNode(true));\n    var tbody = this.parent.createElement('tbody');\n    var tr = this.parent.createElement('tr');\n    var i = 0;\n\n    if (isDetail) {\n      tr.insertBefore(this.parent.createElement('td', {\n        className: 'e-detailrowcollapse'\n      }), tr.firstChild);\n    }\n\n    if (gObj.isRowDragable()) {\n      tr.appendChild(this.parent.createElement('td', {\n        className: 'e-dragindentcell'\n      }));\n    }\n\n    while (i < gLen) {\n      tr.appendChild(this.parent.createElement('td', {\n        className: 'e-indentcell'\n      }));\n      i++;\n    }\n\n    var m = 0;\n    i = 0;\n\n    while (isEdit && m < tdElement.length && i < gObj.getColumns().length || i < gObj.getColumns().length) {\n      var span = isEdit ? tdElement[m].getAttribute('colspan') : null;\n      var col = gObj.getColumns()[i];\n      var td_1 = this.parent.createElement('td', {\n        className: 'e-rowcell',\n        attrs: {\n          style: 'text-align:' + (col.textAlign ? col.textAlign : ''),\n          'colspan': span ? span : ''\n        }\n      });\n\n      if (col.visible) {\n        td_1.appendChild(elements[col.uid]);\n\n        if (col.editType === 'booleanedit') {\n          td_1.classList.add('e-boolcell');\n        } else if (col.commands || col.commandsTemplate) {\n          addClass([td_1], 'e-unboundcell');\n        }\n      } else {\n        td_1.classList.add('e-hide');\n      }\n\n      tr.appendChild(td_1);\n      i = span ? i + parseInt(span, 10) : i + 1;\n      m++;\n    }\n\n    tbody.appendChild(tr);\n    table.appendChild(tbody);\n    form.appendChild(table);\n    td.appendChild(form);\n    return td;\n  };\n\n  InlineEditRender.prototype.removeEventListener = function () {//To destroy the renderer\n  };\n\n  InlineEditRender.prototype.appendChildren = function (form, data, isFrozen) {\n    var _this = this;\n\n    var dummyData = extend({}, data, {\n      isAdd: !this.isEdit,\n      isFrozen: isFrozen\n    }, true);\n    var editTemplateID = this.parent.element.id + 'editSettingsTemplate';\n    appendChildren(form, this.parent.getEditTemplate()(dummyData, this.parent, 'editSettingsTemplate', editTemplateID));\n\n    var setRules = function () {\n      var cols = _this.parent.getColumns();\n\n      for (var i = 0; i < cols.length; i++) {\n        if (cols[i].validationRules) {\n          _this.parent.editModule.formObj.rules[cols[i].field] = cols[i].validationRules;\n        }\n      }\n    };\n\n    updateBlazorTemplate(editTemplateID, 'Template', this.parent.editSettings, true, setRules);\n  };\n\n  return InlineEditRender;\n}();\n\nexport { InlineEditRender };","map":{"version":3,"sources":["/home/nikhil/Desktop/data_grid_editor-master/node_modules/@syncfusion/ej2-grids/src/grid/renderer/inline-edit-renderer.js"],"names":["isNullOrUndefined","addClass","extend","closest","updateBlazorTemplate","isBlazor","events","appendChildren","alignFrozenEditForm","InlineEditRender","parent","prototype","addNew","elements","args","isEdit","mTbody","tbody","frozenRows","editSettings","newRowPosition","getHeaderContent","querySelector","getContentTable","row","createElement","className","remove","getFrozenColumns","moveTbody","getContent","firstElementChild","insertBefore","firstChild","appendChild","getEditElement","undefined","editModule","checkLastRow","mEle","renderMovableform","setAttribute","getVisibleFrozenColumns","getVisibleColumns","length","height","notify","frozenHeight","ele","cloneNode","form","movableForm","template","innerHTML","rowData","renderMovable","updateFreezeEdit","td","concat","slice","call","getFreezeRow","querySelectorAll","idx","parseInt","getAttribute","fCont","mCont","fHdr","mHdr","contains","infiniteScrollSettings","enableCache","getMovableRowByIndex","children","getRowByIndex","update","cloneRow","isServerRendered","parentNode","classList","add","tdElement","refreshFreezeEdit","fCls","cont","frozen","cloneFrozen","mTd","fRows","updateFrozenCont","frzCols","i","getColumns","removeChild","isFrozen","gObj","gLen","isDetail","detailTemplate","childGrid","allowGrouping","groupSettings","columns","attrs","colspan","getIndentCount","toString","id","element","table","cellspacing","tr","isRowDragable","m","span","col","td_1","style","textAlign","visible","uid","editType","commands","commandsTemplate","removeEventListener","data","_this","dummyData","isAdd","editTemplateID","getEditTemplate","setRules","cols","validationRules","formObj","rules","field"],"mappings":"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","sourcesContent":["import { isNullOrUndefined, addClass, extend, closest, updateBlazorTemplate, isBlazor } from '@syncfusion/ej2-base';\nimport * as events from '../base/constant';\nimport { appendChildren, alignFrozenEditForm } from '../base/util';\n/**\n * Edit render module is used to render grid edit row.\n * @hidden\n */\nvar InlineEditRender = /** @class */ (function () {\n    /**\n     * Constructor for render module\n     */\n    function InlineEditRender(parent) {\n        this.parent = parent;\n    }\n    InlineEditRender.prototype.addNew = function (elements, args) {\n        this.isEdit = false;\n        var mTbody;\n        var tbody;\n        if (this.parent.frozenRows && this.parent.editSettings.newRowPosition === 'Top') {\n            tbody = this.parent.getHeaderContent().querySelector('tbody');\n        }\n        else {\n            tbody = this.parent.getContentTable().querySelector('tbody');\n        }\n        args.row = this.parent.createElement('tr', { className: 'e-row e-addedrow' });\n        if (tbody.querySelector('.e-emptyrow')) {\n            tbody.querySelector('.e-emptyrow').remove();\n            if (this.parent.getFrozenColumns()) {\n                var moveTbody = this.parent.getContent().querySelector('.e-movablecontent').querySelector('tbody');\n                moveTbody.firstElementChild.remove();\n            }\n        }\n        this.parent.editSettings.newRowPosition === 'Top' ? tbody.insertBefore(args.row, tbody.firstChild) : tbody.appendChild(args.row);\n        args.row.appendChild(this.getEditElement(elements, false, undefined, args, true));\n        this.parent.editModule.checkLastRow(args.row, args);\n        if (this.parent.getFrozenColumns()) {\n            var mEle = this.renderMovableform(args.row, args);\n            if (this.parent.frozenRows && this.parent.editSettings.newRowPosition === 'Top') {\n                mTbody = this.parent.getHeaderContent().querySelector('.e-movableheader').querySelector('tbody');\n            }\n            else {\n                mTbody = this.parent.getContent().querySelector('.e-movablecontent').querySelector('tbody');\n            }\n            this.parent.editSettings.newRowPosition === 'Top' ? mTbody.insertBefore(mEle, mTbody.firstChild) : mTbody.appendChild(mEle);\n            args.row.querySelector('.e-normaledit').setAttribute('colspan', this.parent.getVisibleFrozenColumns() + '');\n            mEle.setAttribute('colspan', '' + (this.parent.getVisibleColumns().length - this.parent.getVisibleFrozenColumns()));\n            if (this.parent.height === 'auto') {\n                this.parent.notify(events.frozenHeight, {});\n            }\n        }\n    };\n    InlineEditRender.prototype.renderMovableform = function (ele, args) {\n        var mEle = ele.cloneNode(true);\n        var form = args.movableForm = mEle.querySelector('form');\n        if (this.parent.editSettings.template) {\n            form.innerHTML = '';\n            this.appendChildren(form, args.rowData, false);\n            return mEle;\n        }\n        this.renderMovable(ele, mEle);\n        mEle.querySelector('colgroup').innerHTML = this.parent.getHeaderContent()\n            .querySelector('.e-movableheader').querySelector('colgroup').innerHTML;\n        return mEle;\n    };\n    InlineEditRender.prototype.updateFreezeEdit = function (row, td) {\n        td = td.concat([].slice.call(this.getFreezeRow(row).querySelectorAll('td.e-rowcell')));\n        return td;\n    };\n    InlineEditRender.prototype.getFreezeRow = function (row) {\n        if (this.parent.getFrozenColumns()) {\n            var idx = parseInt(row.getAttribute('aria-rowindex'), 10);\n            var fCont = this.parent.getContent().querySelector('.e-frozencontent').querySelector('tbody');\n            var mCont = this.parent.getContent().querySelector('.e-movablecontent').querySelector('tbody');\n            var fHdr = this.parent.getHeaderContent().querySelector('.e-frozenheader').querySelector('tbody');\n            var mHdr = this.parent.getHeaderContent().querySelector('.e-movableheader').querySelector('tbody');\n            if (this.parent.frozenRows && idx >= this.parent.frozenRows) {\n                idx -= this.parent.frozenRows;\n            }\n            if (fCont.contains(row)) {\n                if (this.parent.infiniteScrollSettings.enableCache) {\n                    return this.parent.getMovableRowByIndex(idx);\n                }\n                return mCont.children[idx];\n            }\n            else if (mCont.contains(row)) {\n                if (this.parent.infiniteScrollSettings.enableCache) {\n                    return this.parent.getRowByIndex(idx);\n                }\n                return fCont.children[idx];\n            }\n            else if (fHdr.contains(row)) {\n                return mHdr.children[idx];\n            }\n            else if (mHdr.contains(row)) {\n                return fHdr.children[idx];\n            }\n        }\n        return row;\n    };\n    InlineEditRender.prototype.update = function (elements, args) {\n        this.isEdit = true;\n        var cloneRow = 'cloneRow';\n        if (closest(args.row, '.e-movablecontent')) {\n            args.row = this.getFreezeRow(args.row);\n            if (isBlazor() && this.parent.isServerRendered) {\n                args[cloneRow] = args.row.cloneNode(true);\n            }\n        }\n        if (isBlazor() && this.parent.isServerRendered) {\n            args.row.parentNode.insertBefore(args[cloneRow], args.row);\n            args.row.classList.add('e-hiddenrow');\n            var tdElement = [].slice.call(args[cloneRow].querySelectorAll('td.e-rowcell'));\n            args[cloneRow].innerHTML = '';\n            tdElement = this.updateFreezeEdit(args[cloneRow], tdElement);\n            args[cloneRow].appendChild(this.getEditElement(elements, true, tdElement, args, true));\n            args[cloneRow].classList.add('e-editedrow');\n            this.refreshFreezeEdit(args[cloneRow], args);\n        }\n        else {\n            var tdElement = [].slice.call(args.row.querySelectorAll('td.e-rowcell'));\n            args.row.innerHTML = '';\n            tdElement = this.updateFreezeEdit(args.row, tdElement);\n            args.row.appendChild(this.getEditElement(elements, true, tdElement, args, true));\n            args.row.classList.add('e-editedrow');\n            this.parent.editModule.checkLastRow(args.row, args);\n            this.refreshFreezeEdit(args.row, args);\n        }\n    };\n    InlineEditRender.prototype.refreshFreezeEdit = function (row, args) {\n        var td = row.firstChild;\n        var fCls;\n        var cont;\n        var frozen = 'frozen';\n        var cloneFrozen = 'cloneFrozen';\n        var idx = parseInt(row.getAttribute('aria-rowindex'), 10);\n        if (this.parent.getFrozenColumns()) {\n            if (idx < this.parent.frozenRows) {\n                cont = this.parent.getHeaderContent();\n                fCls = '.e-frozenheader';\n            }\n            else {\n                cont = this.parent.getContent();\n                fCls = '.e-frozencontent';\n            }\n            var mTd = td.cloneNode(true);\n            var form = args.movableForm = mTd.querySelector('form');\n            if (this.parent.editSettings.template) {\n                form.innerHTML = '';\n                this.appendChildren(form, args.rowData, false);\n            }\n            var fRows = void 0;\n            if (cont.querySelector(fCls).contains(row)) {\n                fRows = this.parent.getMovableRowByIndex(idx);\n                if (isBlazor() && this.parent.isServerRendered) {\n                    args[frozen] = fRows;\n                    args[cloneFrozen] = fRows.cloneNode(true);\n                    fRows.classList.add('e-hiddenrow');\n                    fRows.parentNode.insertBefore(args[cloneFrozen], fRows);\n                    this.updateFrozenCont(args[cloneFrozen], td, mTd);\n                }\n                else {\n                    this.updateFrozenCont(fRows, td, mTd);\n                }\n            }\n            else {\n                fRows = this.parent.getRowByIndex(idx);\n                if (isBlazor() && this.parent.isServerRendered) {\n                    args[frozen] = fRows;\n                    args[cloneFrozen] = fRows.cloneNode(true);\n                    fRows.parentNode.insertBefore(args[cloneFrozen], fRows);\n                    fRows.classList.add('e-hiddenrow');\n                    this.updateFrozenCont(args[cloneFrozen], mTd, td);\n                }\n                else {\n                    this.updateFrozenCont(fRows, mTd, td);\n                }\n            }\n            if (isBlazor() && this.parent.isServerRendered) {\n                args[cloneFrozen].appendChild(mTd);\n                args[cloneFrozen].classList.add('e-editedrow');\n            }\n            else {\n                fRows.appendChild(mTd);\n                fRows.classList.add('e-editedrow');\n            }\n            alignFrozenEditForm(args.movableForm.querySelector('td:not(.e-hide)'), args.form.querySelector('td:not(.e-hide)'));\n        }\n    };\n    InlineEditRender.prototype.updateFrozenCont = function (row, ele, mEle) {\n        row.innerHTML = '';\n        if (!this.parent.editSettings.template) {\n            this.renderMovable(ele, mEle);\n            mEle.querySelector('colgroup').innerHTML = this.parent.getHeaderContent()\n                .querySelector('.e-movableheader').querySelector('colgroup').innerHTML;\n        }\n        ele.setAttribute('colspan', this.parent.getVisibleFrozenColumns() + '');\n        mEle.setAttribute('colspan', this.parent.getVisibleColumns().length - this.parent.getVisibleFrozenColumns() + '');\n    };\n    InlineEditRender.prototype.renderMovable = function (ele, mEle) {\n        var frzCols = this.parent.getFrozenColumns();\n        mEle.querySelector('tr').innerHTML = '';\n        for (var i = frzCols; i < this.parent.getColumns().length; i++) {\n            mEle.querySelector('tr').appendChild(ele.querySelector('tr').removeChild(ele.querySelector('tr').children[frzCols]));\n        }\n    };\n    InlineEditRender.prototype.getEditElement = function (elements, isEdit, tdElement, args, isFrozen) {\n        var gObj = this.parent;\n        var gLen = 0;\n        var isDetail = !isNullOrUndefined(gObj.detailTemplate) || !isNullOrUndefined(gObj.childGrid) ? 1 : 0;\n        if (gObj.allowGrouping) {\n            gLen = gObj.groupSettings.columns.length;\n        }\n        var td = this.parent.createElement('td', {\n            className: 'e-editcell e-normaledit',\n            attrs: { colspan: (gObj.getVisibleColumns().length - gObj.getVisibleFrozenColumns() + this.parent.getIndentCount()).toString() }\n        });\n        var form = args.form =\n            this.parent.createElement('form', { id: gObj.element.id + 'EditForm', className: 'e-gridform' });\n        if (this.parent.editSettings.template) {\n            this.appendChildren(form, args.rowData, isFrozen);\n            td.appendChild(form);\n            return td;\n        }\n        var table = this.parent.createElement('table', { className: 'e-table e-inline-edit', attrs: { cellspacing: '0.25' } });\n        table.appendChild(gObj.getContentTable().querySelector('colgroup').cloneNode(true));\n        var tbody = this.parent.createElement('tbody');\n        var tr = this.parent.createElement('tr');\n        var i = 0;\n        if (isDetail) {\n            tr.insertBefore(this.parent.createElement('td', { className: 'e-detailrowcollapse' }), tr.firstChild);\n        }\n        if (gObj.isRowDragable()) {\n            tr.appendChild(this.parent.createElement('td', { className: 'e-dragindentcell' }));\n        }\n        while (i < gLen) {\n            tr.appendChild(this.parent.createElement('td', { className: 'e-indentcell' }));\n            i++;\n        }\n        var m = 0;\n        i = 0;\n        while ((isEdit && m < tdElement.length && i < gObj.getColumns().length) || i < gObj.getColumns().length) {\n            var span = isEdit ? tdElement[m].getAttribute('colspan') : null;\n            var col = gObj.getColumns()[i];\n            var td_1 = this.parent.createElement('td', {\n                className: 'e-rowcell', attrs: { style: 'text-align:' + (col.textAlign ? col.textAlign : ''), 'colspan': span ? span : '' }\n            });\n            if (col.visible) {\n                td_1.appendChild(elements[col.uid]);\n                if (col.editType === 'booleanedit') {\n                    td_1.classList.add('e-boolcell');\n                }\n                else if (col.commands || col.commandsTemplate) {\n                    addClass([td_1], 'e-unboundcell');\n                }\n            }\n            else {\n                td_1.classList.add('e-hide');\n            }\n            tr.appendChild(td_1);\n            i = span ? i + parseInt(span, 10) : i + 1;\n            m++;\n        }\n        tbody.appendChild(tr);\n        table.appendChild(tbody);\n        form.appendChild(table);\n        td.appendChild(form);\n        return td;\n    };\n    InlineEditRender.prototype.removeEventListener = function () {\n        //To destroy the renderer\n    };\n    InlineEditRender.prototype.appendChildren = function (form, data, isFrozen) {\n        var _this = this;\n        var dummyData = extend({}, data, { isAdd: !this.isEdit, isFrozen: isFrozen }, true);\n        var editTemplateID = this.parent.element.id + 'editSettingsTemplate';\n        appendChildren(form, this.parent.getEditTemplate()(dummyData, this.parent, 'editSettingsTemplate', editTemplateID));\n        var setRules = function () {\n            var cols = _this.parent.getColumns();\n            for (var i = 0; i < cols.length; i++) {\n                if (cols[i].validationRules) {\n                    _this.parent.editModule.formObj.rules[cols[i].field] =\n                        cols[i].validationRules;\n                }\n            }\n        };\n        updateBlazorTemplate(editTemplateID, 'Template', this.parent.editSettings, true, setRules);\n    };\n    return InlineEditRender;\n}());\nexport { InlineEditRender };\n"]},"metadata":{},"sourceType":"module"}