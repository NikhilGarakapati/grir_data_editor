{"ast":null,"code":"import * as events from '../base/constant';\nimport { PdfDocument, PdfGrid, PdfBorders, PdfPen, PdfPaddings } from '@syncfusion/ej2-pdf-export';\nimport { PdfStandardFont, PdfFontFamily, PdfFontStyle, PdfBitmap } from '@syncfusion/ej2-pdf-export';\nimport { PdfStringFormat, PdfTextAlignment, PdfColor, PdfSolidBrush } from '@syncfusion/ej2-pdf-export';\nimport { PdfVerticalAlignment, RectangleF, PdfPageTemplateElement } from '@syncfusion/ej2-pdf-export';\nimport { PointF, PdfPageNumberField, PdfCompositeField } from '@syncfusion/ej2-pdf-export';\nimport { PdfPageCountField, SizeF, PdfPageSettings, PdfPageOrientation } from '@syncfusion/ej2-pdf-export';\nimport { PdfTrueTypeFont } from '@syncfusion/ej2-pdf-export';\nimport { ExportHelper, ExportValueFormatter } from './export-helper';\nimport { Data } from '../actions/data';\nimport { SummaryModelGenerator, GroupSummaryModelGenerator, CaptionSummaryModelGenerator } from '../services/summary-model-generator';\nimport { compile, getEnumValue, isNullOrUndefined, detach, isBlazor } from '@syncfusion/ej2-base';\nimport { CellType, AggregateTemplateType } from '../base/enum';\nimport { DataManager, Query } from '@syncfusion/ej2-data';\nimport { getValue } from '@syncfusion/ej2-base';\nimport { getUid, getPrintGridModel, measureColumnDepth, isExportColumns, updateColumnTypeForExportColumns, prepareColumns } from '../base/util';\n/**\n * `PDF Export` module is used to handle the exportToPDF action.\n * @hidden\n */\n\nvar PdfExport =\n/** @class */\nfunction () {\n  /**\n   * Constructor for the Grid PDF Export module\n   * @hidden\n   */\n  function PdfExport(parent) {\n    this.hideColumnInclude = false;\n    this.currentViewData = false;\n    this.customDataSource = false;\n    this.isGrouping = false;\n    this.headerOnPages = [];\n    this.drawPosition = {\n      xPosition: 0,\n      yPosition: 0\n    };\n    this.parent = parent;\n    this.helper = new ExportHelper(parent);\n    this.gridPool = {};\n  }\n  /**\n   * For internal use only - Get the module name.\n   */\n\n\n  PdfExport.prototype.getModuleName = function () {\n    return 'PdfExport';\n  };\n\n  PdfExport.prototype.init = function (parent) {\n    this.exportValueFormatter = new ExportValueFormatter(parent.locale);\n    this.pdfDocument = undefined;\n    this.hideColumnInclude = false;\n    this.currentViewData = false;\n    this.parent = parent;\n    this.isGrouping = false;\n    this.isExporting = true;\n    parent.id = getUid('main-grid');\n    this.gridPool[parent.id] = false;\n    this.pdfPageSettings = new PdfPageSettings();\n  };\n\n  PdfExport.prototype.exportWithData = function (parent, pdfDoc, resolve, returnType, pdfExportProperties, isMultipleExport, reject) {\n    var _this = this;\n\n    this.init(parent);\n\n    if (!isNullOrUndefined(pdfDoc)) {\n      this.pdfDocument = pdfDoc;\n    } else {\n      this.pdfDocument = new PdfDocument();\n    }\n\n    this.processExport(parent, returnType, pdfExportProperties, isMultipleExport).then(function () {\n      _this.isExporting = false;\n      parent.trigger(events.pdfExportComplete, _this.isBlob ? {\n        promise: _this.blobPromise\n      } : {});\n\n      _this.parent.log('exporting_complete', _this.getModuleName());\n\n      resolve(_this.pdfDocument);\n    }).catch(function (e) {\n      reject(_this.pdfDocument);\n\n      _this.parent.trigger(events.actionFailure, e);\n    });\n  };\n  /**\n   * Used to map the input data\n   * @return {void}\n   */\n\n\n  PdfExport.prototype.Map = function (parent, pdfExportProperties, isMultipleExport, pdfDoc, isBlob) {\n    var _this = this;\n\n    this.data = new Data(this.parent);\n    this.isBlob = isBlob;\n    this.gridPool = {};\n\n    if (parent.childGrid && !(!isNullOrUndefined(pdfExportProperties) && pdfExportProperties.hierarchyExportMode === 'None')) {\n      parent.expandedRows = getPrintGridModel(parent).expandedRows;\n    }\n\n    var args = {\n      requestType: 'beforePdfExport',\n      cancel: false,\n      headerPageNumbers: [],\n      gridDrawPosition: {\n        xPosition: 0,\n        yPosition: 0\n      }\n    };\n\n    if (!isBlazor()) {\n      var gridObject = 'gridObject';\n      args[gridObject] = parent;\n    }\n\n    var can = 'cancel';\n    var header = 'headerPageNumbers';\n    var drawPos = 'gridDrawPosition';\n    parent.trigger(events.beforePdfExport, args);\n\n    if (args[can] === true) {\n      return new Promise(function (resolve, reject) {\n        return resolve();\n      });\n    }\n\n    if (isExportColumns(pdfExportProperties)) {\n      updateColumnTypeForExportColumns(pdfExportProperties, parent);\n    }\n\n    this.headerOnPages = args[header];\n    this.drawPosition = args[drawPos];\n    this.parent.log('exporting_begin', this.getModuleName());\n\n    if (!isNullOrUndefined(pdfExportProperties) && !isNullOrUndefined(pdfExportProperties.dataSource)) {\n      if (!(pdfExportProperties.dataSource instanceof DataManager)) {\n        pdfExportProperties.dataSource = new DataManager(pdfExportProperties.dataSource);\n      }\n\n      return new Promise(function (resolve, reject) {\n        pdfExportProperties.dataSource.executeQuery(new Query()).then(function (returnType) {\n          _this.exportWithData(parent, pdfDoc, resolve, returnType, pdfExportProperties, isMultipleExport, reject);\n        });\n      });\n    } else if (!isNullOrUndefined(pdfExportProperties) && pdfExportProperties.exportType === 'CurrentPage') {\n      return new Promise(function (resolve, reject) {\n        _this.exportWithData(parent, pdfDoc, resolve, _this.parent.getCurrentViewRecords(), pdfExportProperties, isMultipleExport, reject);\n      });\n    } else {\n      var allPromise_1 = [];\n      allPromise_1.push(this.data.getData({}, ExportHelper.getQuery(parent, this.data)));\n      allPromise_1.push(this.helper.getColumnData(parent));\n      return new Promise(function (resolve, reject) {\n        Promise.all(allPromise_1).then(function (e) {\n          _this.init(parent);\n\n          if (!isNullOrUndefined(pdfDoc)) {\n            _this.pdfDocument = pdfDoc;\n          } else {\n            _this.pdfDocument = new PdfDocument();\n          }\n\n          _this.processExport(parent, e[0], pdfExportProperties, isMultipleExport).then(function () {\n            _this.isExporting = false;\n            parent.trigger(events.pdfExportComplete, _this.isBlob ? {\n              promise: _this.blobPromise\n            } : {});\n\n            _this.parent.log('exporting_complete', _this.getModuleName());\n\n            resolve(_this.pdfDocument);\n          }).catch(function (e) {\n            reject(_this.pdfDocument);\n\n            _this.parent.trigger(events.actionFailure, e);\n          });\n        });\n      });\n    }\n  };\n\n  PdfExport.prototype.processExport = function (gObj, returnType, pdfExportProperties, isMultipleExport) {\n    var _this = this;\n\n    var section = this.pdfDocument.sections.add();\n    var pdfGrid;\n    this.processSectionExportProperties(section, pdfExportProperties);\n    var pdfPage = section.pages.add();\n    return new Promise(function (resolve, reject) {\n      pdfGrid = _this.processGridExport(gObj, returnType, pdfExportProperties);\n      _this.globalResolve = resolve;\n      _this.gridPool[gObj.id] = true;\n\n      _this.helper.checkAndExport(_this.gridPool, _this.globalResolve);\n    }).then(function () {\n      // draw the grid\n      var xPosition = 'xPosition';\n      var yPosition = 'yPosition';\n      pdfGrid.draw(pdfPage, _this.drawPosition[xPosition], _this.drawPosition[yPosition]);\n\n      _this.drawHeader(pdfExportProperties);\n\n      if (!isMultipleExport) {\n        // save the PDF\n        if (!_this.isBlob) {\n          if (!isNullOrUndefined(pdfExportProperties) && pdfExportProperties.fileName) {\n            _this.pdfDocument.save(pdfExportProperties.fileName);\n          } else {\n            _this.pdfDocument.save('Export.pdf');\n          }\n        } else {\n          _this.blobPromise = _this.pdfDocument.save();\n        }\n\n        _this.pdfDocument.destroy();\n\n        delete gObj.expandedRows;\n      }\n\n      return _this.pdfDocument;\n    });\n  };\n\n  PdfExport.prototype.processSectionExportProperties = function (section, pdfExportProperties) {\n    if (!isNullOrUndefined(pdfExportProperties) && (!isNullOrUndefined(pdfExportProperties.pageOrientation) || !isNullOrUndefined(pdfExportProperties.pageSize))) {\n      this.pdfPageSettings.orientation = pdfExportProperties.pageOrientation === 'Landscape' ? PdfPageOrientation.Landscape : PdfPageOrientation.Portrait;\n      this.pdfPageSettings.size = this.getPageSize(pdfExportProperties.pageSize);\n      section.setPageSettings(this.pdfPageSettings);\n    }\n\n    return section;\n  };\n\n  PdfExport.prototype.processGridExport = function (gObj, returnType, pdfExportProperties) {\n    var allowHorizontalOverflow = true;\n\n    if (!isNullOrUndefined(pdfExportProperties)) {\n      this.gridTheme = pdfExportProperties.theme;\n\n      if (isBlazor() && !isNullOrUndefined(this.gridTheme)) {\n        this.getGridPdfFont(this.gridTheme);\n      }\n\n      allowHorizontalOverflow = isNullOrUndefined(pdfExportProperties.allowHorizontalOverflow) ? true : pdfExportProperties.allowHorizontalOverflow;\n    }\n\n    var helper = new ExportHelper(gObj);\n    var dataSource = this.processExportProperties(pdfExportProperties, returnType.result);\n    var columns = isExportColumns(pdfExportProperties) ? prepareColumns(pdfExportProperties.columns, gObj.enableColumnVirtualization) : helper.getGridExportColumns(gObj.columns);\n    columns = columns.filter(function (columns) {\n      return isNullOrUndefined(columns.commands);\n    });\n    var isGrouping = false;\n\n    if (gObj.groupSettings.columns.length) {\n      isGrouping = true;\n    }\n\n    if (gObj.childGrid && !isNullOrUndefined(pdfExportProperties)) {\n      gObj.hierarchyPrintMode = pdfExportProperties.hierarchyExportMode || 'Expanded';\n    } // create a grid\n\n\n    var pdfGrid = new PdfGrid(); // get header theme style\n\n    var headerThemeStyle = this.getHeaderThemeStyle();\n    var border = headerThemeStyle.border;\n    var headerFont = headerThemeStyle.font;\n    var headerBrush = headerThemeStyle.brush;\n    var returnValue = helper.getHeaders(columns, this.hideColumnInclude); // Column collection with respect to the records in the grid\n\n    var gridColumns = returnValue.columns; // process grid header content\n\n    pdfGrid = this.processGridHeaders(gObj.groupSettings.columns.length, pdfGrid, returnValue.rows, gridColumns, border, headerFont, headerBrush, gObj, allowHorizontalOverflow, columns); // set alignment, width and type of the values of the column\n\n    this.setColumnProperties(gridColumns, pdfGrid, helper, gObj, allowHorizontalOverflow);\n    var captionThemeStyle = this.getSummaryCaptionThemeStyle();\n\n    if (!isNullOrUndefined(dataSource) && dataSource.length) {\n      if (isGrouping) {\n        if (!isNullOrUndefined(captionThemeStyle.border)) {\n          border = captionThemeStyle.border;\n        }\n\n        this.processGroupedRecords(pdfGrid, dataSource, gridColumns, gObj, border, 0, captionThemeStyle.font, captionThemeStyle.brush, captionThemeStyle.backgroundBrush, returnType, pdfExportProperties, helper, 0);\n      } else {\n        this.processRecord(border, gridColumns, gObj, dataSource, pdfGrid, 0, pdfExportProperties, helper, 0);\n      }\n\n      if (!isNullOrUndefined(returnType.aggregates)) {\n        var summaryModel = new SummaryModelGenerator(gObj);\n        var sRows = void 0;\n\n        if (gObj.aggregates.length && this.parent !== gObj) {\n          gObj.aggregateModule.prepareSummaryInfo();\n        }\n\n        if (this.customDataSource) {\n          sRows = summaryModel.generateRows(dataSource, returnType.aggregates);\n        } else if (this.currentViewData) {\n          sRows = summaryModel.generateRows(this.parent.getCurrentViewRecords(), returnType.aggregates);\n        } else if (isGrouping) {\n          sRows = summaryModel.generateRows(dataSource.records, returnType.aggregates);\n        } else {\n          sRows = summaryModel.generateRows(returnType.result, returnType.aggregates, null, null, columns);\n        }\n\n        this.processAggregates(sRows, pdfGrid, border, captionThemeStyle.font, captionThemeStyle.brush, captionThemeStyle.backgroundBrush, false);\n      }\n    } else {\n      var row = pdfGrid.rows.addRow();\n      row.style.setBorder(border);\n    }\n\n    return pdfGrid;\n  };\n\n  PdfExport.prototype.getSummaryCaptionThemeStyle = function () {\n    if (!isNullOrUndefined(this.gridTheme) && !isNullOrUndefined(this.gridTheme.caption)) {\n      var fontSize = !isNullOrUndefined(this.gridTheme.caption.fontSize) ? this.gridTheme.caption.fontSize : 9.75;\n      var fontFamily = !isNullOrUndefined(this.gridTheme.caption.fontName) ? this.getFontFamily(this.gridTheme.caption.fontName) : PdfFontFamily.Helvetica;\n      var fontStyle = this.getFontStyle(this.gridTheme.caption);\n      var pdfColor = new PdfColor(0, 0, 0);\n\n      if (!isNullOrUndefined(this.gridTheme.caption.fontColor)) {\n        var penBrushColor = this.hexToRgb(this.gridTheme.caption.fontColor);\n        pdfColor = new PdfColor(penBrushColor.r, penBrushColor.g, penBrushColor.b);\n      }\n\n      var borderCaption = this.gridTheme.caption.border ? this.getBorderStyle(this.gridTheme.caption.border) : null;\n      var font = new PdfStandardFont(fontFamily, fontSize, fontStyle);\n\n      if (!isNullOrUndefined(this.gridTheme.caption.font)) {\n        font = this.gridTheme.caption.font;\n      }\n\n      return {\n        font: font,\n        brush: new PdfSolidBrush(pdfColor),\n        backgroundBrush: new PdfSolidBrush(new PdfColor(246, 246, 246)),\n        border: borderCaption\n      };\n    } else {\n      //Material theme\n      return {\n        font: new PdfStandardFont(PdfFontFamily.Helvetica, 9.75),\n        brush: new PdfSolidBrush(new PdfColor(0, 0, 0)),\n        backgroundBrush: new PdfSolidBrush(new PdfColor(246, 246, 246))\n      };\n    }\n  };\n\n  PdfExport.prototype.getGridPdfFont = function (args) {\n    var fontFamily = 'fontFamily';\n    var fontSize = 'fontSize';\n    var fontStyle = 'fontStyle';\n    var isTrueType = 'isTrueType';\n    var style = 0;\n\n    if (args.header && args.header.font) {\n      var headerFont = args.header.font[fontFamily];\n      var headerSize = args.header.font[fontSize];\n      var headerStyle = args.header.font[fontStyle];\n      style = isNullOrUndefined(PdfFontStyle[headerStyle]) ? 0 : PdfFontStyle[headerStyle];\n\n      if (args.header.font[isTrueType]) {\n        args.header.font = new PdfTrueTypeFont(headerFont, headerSize, style);\n      } else {\n        var fontFamily_1 = !isNullOrUndefined(headerFont) ? this.getFontFamily(headerFont) : PdfFontFamily.Helvetica;\n        args.header.font = new PdfStandardFont(fontFamily_1, headerSize, style);\n      }\n    }\n\n    if (args.caption && args.caption.font) {\n      var captionFont = args.caption.font[fontFamily];\n      var captionSize = args.caption.font[fontSize];\n      var captionStyle = args.caption.font[fontStyle];\n      style = isNullOrUndefined(PdfFontStyle[captionStyle]) ? 0 : PdfFontStyle[captionStyle];\n\n      if (args.caption.font[isTrueType]) {\n        args.caption.font = new PdfTrueTypeFont(captionFont, captionSize, style);\n      } else {\n        var fontFamily_2 = !isNullOrUndefined(captionFont) ? this.getFontFamily(captionFont) : PdfFontFamily.Helvetica;\n        args.caption.font = new PdfStandardFont(fontFamily_2, captionSize, style);\n      }\n    }\n\n    if (args.record && args.record.font) {\n      var recordFont = args.record.font[fontFamily];\n      var recordSize = args.record.font[fontSize];\n      var recordStyle = args.record.font[fontStyle];\n      style = isNullOrUndefined(PdfFontStyle[recordStyle]) ? 0 : PdfFontStyle[recordStyle];\n\n      if (args.record.font[isTrueType]) {\n        args.record.font = new PdfTrueTypeFont(recordFont, recordSize, style);\n      } else {\n        var fontFamily_3 = !isNullOrUndefined(recordFont) ? this.getFontFamily(recordFont) : PdfFontFamily.Helvetica;\n        args.record.font = new PdfStandardFont(fontFamily_3, recordSize, style);\n      }\n    }\n  };\n\n  PdfExport.prototype.getHeaderThemeStyle = function () {\n    var border = new PdfBorders();\n\n    if (!isNullOrUndefined(this.gridTheme) && !isNullOrUndefined(this.gridTheme.header)) {\n      var fontFamily = !isNullOrUndefined(this.gridTheme.header.fontName) ? this.getFontFamily(this.gridTheme.header.fontName) : PdfFontFamily.Helvetica;\n      var fontStyle = this.getFontStyle(this.gridTheme.header);\n      var fontSize = !isNullOrUndefined(this.gridTheme.header.fontSize) ? this.gridTheme.header.fontSize : 10.5;\n      var pdfColor = new PdfColor();\n\n      if (!isNullOrUndefined(this.gridTheme.header.fontColor)) {\n        var penBrushColor = this.hexToRgb(this.gridTheme.header.fontColor);\n        pdfColor = new PdfColor(penBrushColor.r, penBrushColor.g, penBrushColor.b);\n      }\n\n      var font = new PdfStandardFont(fontFamily, fontSize, fontStyle);\n\n      if (!isNullOrUndefined(this.gridTheme.header.font)) {\n        font = this.gridTheme.header.font;\n      }\n\n      return {\n        border: this.getBorderStyle(this.gridTheme.header.border),\n        font: font,\n        brush: new PdfSolidBrush(pdfColor)\n      };\n    } else {\n      //Material theme\n      border.all = new PdfPen(new PdfColor(234, 234, 234));\n      return {\n        border: border,\n        font: new PdfStandardFont(PdfFontFamily.Helvetica, 10.5),\n        brush: new PdfSolidBrush(new PdfColor(102, 102, 102))\n      };\n    }\n  };\n  /* tslint:disable-next-line:no-any */\n\n\n  PdfExport.prototype.processGroupedRecords = function (pdfGrid, dataSource, gridColumns, gObj, border, level, font, brush, backgroundBrush, returnType, pdfExportProperties, helper, index) {\n    var _this = this;\n\n    var groupIndex = level;\n\n    var _loop_1 = function (dataSourceItems) {\n      var row = pdfGrid.rows.addRow();\n      var col = gObj.getColumnByField(dataSourceItems.field);\n      /* tslint:disable-next-line:no-any */\n\n      var args = {\n        value: dataSourceItems.key,\n        column: col,\n        style: undefined,\n        isForeignKey: col.isForeignColumn()\n      };\n      /* tslint:disable-next-line:max-line-length */\n\n      var value = this_1.parent.getColumnByField(dataSourceItems.field).headerText + ': ' + (!col.enableGroupByFormat ? this_1.exportValueFormatter.formatCellValue(args) : dataSourceItems.key) + ' - ' + dataSourceItems.count + (dataSource.count > 1 ? ' items' : ' item');\n      var cArgs = {\n        captionText: value,\n        type: 'PDF'\n      };\n      this_1.parent.trigger(events.exportGroupCaption, cArgs, function (cArgs) {\n        row.cells.getCell(groupIndex).value = cArgs.captionText;\n        row.cells.getCell(groupIndex + 1).style.stringFormat = new PdfStringFormat(PdfTextAlignment.Left);\n        row.style.setBorder(border);\n        row.style.setFont(font);\n        row.style.setTextBrush(brush);\n        row.style.setBackgroundBrush(backgroundBrush);\n        var sRows;\n        var captionSummaryModel = new CaptionSummaryModelGenerator(gObj);\n\n        if (!isNullOrUndefined(dataSourceItems.items.records)) {\n          sRows = captionSummaryModel.generateRows(dataSourceItems.items.records, dataSourceItems);\n        } else {\n          sRows = captionSummaryModel.generateRows(dataSourceItems.items, dataSourceItems);\n        }\n\n        if (!isNullOrUndefined(sRows) && sRows.length === 0) {\n          row.cells.getCell(groupIndex + 1).columnSpan = pdfGrid.columns.count - (groupIndex + 1);\n        }\n\n        if (!isNullOrUndefined(dataSource.childLevels) && dataSource.childLevels > 0) {\n          _this.processAggregates(sRows, pdfGrid, border, font, brush, backgroundBrush, true, row, groupIndex);\n\n          _this.processGroupedRecords(pdfGrid, dataSourceItems.items, gridColumns, gObj, border, groupIndex + 1, font, brush, backgroundBrush, returnType, pdfExportProperties, helper, index);\n\n          var groupSummaryModel = new GroupSummaryModelGenerator(gObj);\n          sRows = groupSummaryModel.generateRows(dataSourceItems.items.records, dataSourceItems);\n\n          _this.processAggregates(sRows, pdfGrid, border, font, brush, backgroundBrush, false);\n        } else {\n          _this.processAggregates(sRows, pdfGrid, border, font, brush, backgroundBrush, true, row, groupIndex);\n\n          index = _this.processRecord(border, gridColumns, gObj, dataSourceItems.items, pdfGrid, groupIndex + 1, pdfExportProperties, helper, index);\n          var groupSummaryModel = new GroupSummaryModelGenerator(gObj);\n          sRows = groupSummaryModel.generateRows(dataSourceItems.items, dataSourceItems);\n          var isGroupedFooter = true;\n\n          _this.processAggregates(sRows, pdfGrid, border, font, brush, backgroundBrush, false, null, null, isGroupedFooter);\n        }\n      });\n    };\n\n    var this_1 = this;\n\n    for (var _i = 0, dataSource_1 = dataSource; _i < dataSource_1.length; _i++) {\n      var dataSourceItems = dataSource_1[_i];\n\n      _loop_1(dataSourceItems);\n    }\n  };\n\n  PdfExport.prototype.processGridHeaders = function (childLevels, pdfGrid, rows, gridColumn, border, headerFont, headerBrush, grid, allowHorizontalOverflow, eCols) {\n    var _this = this;\n\n    var columnCount = gridColumn.length + childLevels;\n    var depth = measureColumnDepth(eCols);\n    var cols = eCols;\n    var index = 0;\n\n    if (this.parent.allowGrouping) {\n      index = this.parent.groupSettings.columns.length;\n    }\n\n    pdfGrid.columns.add(columnCount);\n    pdfGrid.headers.add(rows.length);\n\n    var applyTextAndSpan = function (rowIdx, colIdx, col, rowSpan, colSpan) {\n      var gridHeader = pdfGrid.headers.getHeader(rowIdx);\n      var pdfCell = gridHeader.cells.getCell(colIdx);\n      var cell = rows[rowIdx].cells[colIdx];\n\n      if (!isNullOrUndefined(col.headerTextAlign)) {\n        pdfCell.style.stringFormat = _this.getHorizontalAlignment(col.headerTextAlign);\n      }\n\n      if (rowSpan > 0) {\n        pdfCell.rowSpan = rowSpan;\n        pdfCell.style.stringFormat = _this.getVerticalAlignment('Bottom', pdfCell.style.stringFormat, col.textAlign);\n      }\n\n      if (colSpan > 0) {\n        pdfCell.columnSpan = colSpan;\n      }\n\n      gridHeader.style.setBorder(border);\n      gridHeader.style.setFont(headerFont);\n      gridHeader.style.setTextBrush(headerBrush);\n      pdfCell.value = col.headerText;\n\n      if (!isNullOrUndefined(cell) && (cell.cellType === CellType.HeaderIndent || cell.cellType === CellType.DetailHeader)) {\n        pdfCell.value = '';\n        pdfCell.width = 20;\n      }\n\n      var args = {\n        cell: pdfCell,\n        gridCell: cell,\n        style: pdfCell.style\n      };\n\n      _this.parent.trigger(events.pdfHeaderQueryCellInfo, args);\n    };\n\n    var recuHeader = function (cols, depth, spanCnt, colIndex, rowIndex, isRoot) {\n      var cidx = 0;\n\n      for (var i = 0; i < cols.length; i++) {\n        if (isRoot) {\n          cidx = cidx + spanCnt + (i === 0 ? 0 : -1);\n          colIndex = cidx;\n          spanCnt = 0;\n        }\n\n        if (cols[i].columns && cols[i].columns.length) {\n          var newSpanCnt = recuHeader(cols[i].columns, depth - 1, 0, i + colIndex, rowIndex + 1, false);\n          applyTextAndSpan(rowIndex, i + colIndex, cols[i], 0, newSpanCnt);\n          spanCnt = spanCnt + newSpanCnt;\n          colIndex = colIndex + newSpanCnt - 1;\n        } else if (cols[i].visible || _this.hideColumnInclude) {\n          spanCnt++;\n          applyTextAndSpan(rowIndex, i + colIndex + index, cols[i], depth, 0);\n        }\n      }\n\n      return spanCnt;\n    };\n\n    recuHeader(cols, depth, 0, 0, 0, true);\n\n    if (pdfGrid.columns.count >= 6 && allowHorizontalOverflow) {\n      pdfGrid.style.allowHorizontalOverflow = true;\n    }\n\n    return pdfGrid;\n  };\n\n  PdfExport.prototype.processExportProperties = function (pdfExportProperties, dataSource) {\n    if (!isNullOrUndefined(pdfExportProperties)) {\n      if (!isNullOrUndefined(pdfExportProperties.theme)) {\n        this.gridTheme = pdfExportProperties.theme;\n      }\n\n      var clientSize = this.pdfPageSettings.size;\n      this.drawHeader(pdfExportProperties);\n\n      if (!isNullOrUndefined(pdfExportProperties.footer)) {\n        /* tslint:disable-next-line:no-any */\n        var footer = pdfExportProperties.footer;\n        var position = new PointF(0, clientSize.width - 80 - footer.fromBottom * 0.75);\n        var size = new SizeF(clientSize.width - 80, footer.height * 0.75);\n        var bounds = new RectangleF(position, size);\n        this.pdfDocument.template.bottom = this.drawPageTemplate(new PdfPageTemplateElement(bounds), footer);\n      }\n\n      if (!isNullOrUndefined(pdfExportProperties.includeHiddenColumn) && !this.isGrouping) {\n        this.hideColumnInclude = pdfExportProperties.includeHiddenColumn;\n      }\n\n      if (!isNullOrUndefined(pdfExportProperties.dataSource)) {\n        if (!(pdfExportProperties.dataSource instanceof DataManager)) {\n          dataSource = pdfExportProperties.dataSource;\n        }\n\n        this.customDataSource = true;\n        this.currentViewData = false;\n      } else if (!isNullOrUndefined(pdfExportProperties.exportType)) {\n        if (pdfExportProperties.exportType === 'CurrentPage') {\n          dataSource = this.parent.currentViewData;\n          this.currentViewData = true;\n          this.customDataSource = false;\n        } else {\n          this.currentViewData = false;\n          this.customDataSource = false;\n        }\n      } else {\n        this.currentViewData = false;\n        this.customDataSource = false;\n      }\n    } else {\n      this.currentViewData = false;\n      this.customDataSource = false;\n    }\n\n    return dataSource;\n  };\n\n  PdfExport.prototype.drawHeader = function (pdfExportProperties) {\n    var _this = this;\n\n    var clientSize = this.pdfPageSettings.size;\n\n    if (!isNullOrUndefined(pdfExportProperties) && !isNullOrUndefined(pdfExportProperties.header)) {\n      /* tslint:disable-next-line:no-any */\n      var header = pdfExportProperties.header;\n      var position = new PointF(0, header.fromTop);\n      var size = new SizeF(clientSize.width - 80, header.height * 0.75);\n      var bounds = new RectangleF(position, size);\n\n      if (!this.headerOnPages.length) {\n        this.pdfDocument.template.top = this.drawPageTemplate(new PdfPageTemplateElement(bounds), header);\n      } else {\n        var headerTemplate_1 = this.drawPageTemplate(new PdfPageTemplateElement(bounds), header);\n        this.headerOnPages.filter(function (index) {\n          if (index - 1 >= 0 && index - 1 < _this.pdfDocument.pages.count - 1) {\n            _this.pdfDocument.pages.getPageByIndex(index - 1).graphics.drawPdfTemplate(headerTemplate_1.template, new PointF(0, 0));\n          }\n        });\n      }\n    }\n  };\n\n  PdfExport.prototype.drawPageTemplate = function (template, element) {\n    for (var _i = 0, _a = element.contents; _i < _a.length; _i++) {\n      var content = _a[_i];\n      this.processContentValidation(content);\n\n      switch (content.type) {\n        case 'Text':\n          /* tslint:disable-next-line:max-line-length */\n          if (content.value === '' || content.value === undefined || content.value === null || typeof content.value !== 'string') {\n            throw new Error('please enter the valid input value in text content...');\n          }\n\n          this.drawText(template, content);\n          break;\n\n        case 'PageNumber':\n          this.drawPageNumber(template, content);\n          break;\n\n        case 'Image':\n          if (content.src === undefined || content.src === null || content.src === '') {\n            throw new Error('please enter the valid base64 string in image content...');\n          }\n\n          this.drawImage(template, content);\n          break;\n\n        case 'Line':\n          this.drawLine(template, content);\n          break;\n\n        default:\n          throw new Error('Please set valid content type...');\n      }\n    }\n\n    return template;\n  };\n\n  PdfExport.prototype.processContentValidation = function (content) {\n    if (content.type === undefined || content.type === null) {\n      throw new Error('please set valid content type...');\n    } else {\n      if (content.type === 'Line') {\n        if (content.points === undefined || content.points === null) {\n          throw new Error('please enter valid points in ' + content.type + ' content...');\n        } else {\n          if (content.points.x1 === undefined || content.points.x1 === null || typeof content.points.x1 !== 'number') {\n            throw new Error('please enter valid x1 co-ordinate in ' + content.type + ' points...');\n          }\n\n          if (content.points.y1 === undefined || content.points.y1 === null || typeof content.points.y1 !== 'number') {\n            throw new Error('please enter valid y1 co-ordinate in ' + content.type + ' points...');\n          }\n\n          if (content.points.x2 === undefined || content.points.x2 === null || typeof content.points.x2 !== 'number') {\n            throw new Error('please enter valid x2 co-ordinate in ' + content.type + ' points...');\n          }\n\n          if (content.points.y2 === undefined || content.points.y2 === null || typeof content.points.y2 !== 'number') {\n            throw new Error('please enter valid y2 co-ordinate in ' + content.type + ' points...');\n          }\n        }\n      } else {\n        if (content.position === undefined || content.position === null) {\n          throw new Error('please enter valid position in ' + content.type + ' content...');\n        } else {\n          if (content.position.x === undefined || content.position.x === null || typeof content.position.x !== 'number') {\n            throw new Error('please enter valid x co-ordinate in ' + content.type + ' position...');\n          }\n\n          if (content.position.y === undefined || content.position.y === null || typeof content.position.y !== 'number') {\n            throw new Error('please enter valid y co-ordinate in ' + content.type + ' position...');\n          }\n        }\n      }\n    }\n  };\n  /* tslint:disable-next-line:no-any */\n\n\n  PdfExport.prototype.drawText = function (pageTemplate, content) {\n    var font = this.getFont(content);\n    var brush = this.getBrushFromContent(content);\n    var pen = null;\n\n    if (!isNullOrUndefined(content.style.textPenColor)) {\n      var penColor = this.hexToRgb(content.style.textPenColor);\n      pen = new PdfPen(new PdfColor(penColor.r, penColor.g, penColor.b));\n    }\n\n    if (brush == null && pen == null) {\n      brush = new PdfSolidBrush(new PdfColor(0, 0, 0));\n    }\n\n    var value = content.value.toString();\n    var x = content.position.x * 0.75;\n    var y = content.position.y * 0.75;\n    var format = new PdfStringFormat();\n    var result = this.setContentFormat(content, format);\n\n    if (result !== null && !isNullOrUndefined(result.format) && !isNullOrUndefined(result.size)) {\n      pageTemplate.graphics.drawString(value, font, pen, brush, x, y, result.size.width, result.size.height, result.format);\n    } else {\n      pageTemplate.graphics.drawString(value, font, pen, brush, x, y, format);\n    }\n  };\n  /* tslint:disable-next-line:no-any */\n\n\n  PdfExport.prototype.drawPageNumber = function (documentHeader, content) {\n    var font = this.getFont(content);\n    var brush = null;\n\n    if (!isNullOrUndefined(content.style.textBrushColor)) {\n      /* tslint:disable-next-line:max-line-length */\n      var brushColor = this.hexToRgb(content.style.textBrushColor);\n      brush = new PdfSolidBrush(new PdfColor(brushColor.r, brushColor.g, brushColor.b));\n    } else {\n      brush = new PdfSolidBrush(new PdfColor(0, 0, 0));\n    }\n\n    var pageNumber = new PdfPageNumberField(font, brush);\n    pageNumber.numberStyle = this.getPageNumberStyle(content.pageNumberType);\n    var compositeField;\n    var format;\n\n    if (!isNullOrUndefined(content.format)) {\n      if (content.format.indexOf('$total') !== -1 && content.format.indexOf('$current') !== -1) {\n        var pageCount = new PdfPageCountField(font);\n        pageCount.numberStyle = this.getPageNumberStyle(content.pageNumberType);\n\n        if (content.format.indexOf('$total') > content.format.indexOf('$current')) {\n          format = content.format.replace('$current', '0');\n          format = format.replace('$total', '1');\n        } else {\n          format = content.format.replace('$current', '1');\n          format = format.replace('$total', '0');\n        }\n\n        compositeField = new PdfCompositeField(font, brush, format, pageNumber, pageCount);\n      } else if (content.format.indexOf('$current') !== -1 && content.format.indexOf('$total') === -1) {\n        format = content.format.replace('$current', '0');\n        compositeField = new PdfCompositeField(font, brush, format, pageNumber);\n      } else {\n        var pageCount = new PdfPageCountField(font);\n        format = content.format.replace('$total', '0');\n        compositeField = new PdfCompositeField(font, brush, format, pageCount);\n      }\n    } else {\n      format = '{0}';\n      compositeField = new PdfCompositeField(font, brush, format, pageNumber);\n    }\n\n    var x = content.position.x * 0.75;\n    var y = content.position.y * 0.75;\n    var result = this.setContentFormat(content, compositeField.stringFormat);\n\n    if (result !== null && !isNullOrUndefined(result.format) && !isNullOrUndefined(result.size)) {\n      compositeField.stringFormat = result.format;\n      compositeField.bounds = new RectangleF(x, y, result.size.width, result.size.height);\n    }\n\n    compositeField.draw(documentHeader.graphics, x, y);\n  };\n  /* tslint:disable-next-line:no-any */\n\n\n  PdfExport.prototype.drawImage = function (documentHeader, content) {\n    var x = content.position.x * 0.75;\n    var y = content.position.y * 0.75;\n    var width = !isNullOrUndefined(content.size) ? content.size.width * 0.75 : undefined;\n    var height = !isNullOrUndefined(content.size) ? content.size.height * 0.75 : undefined;\n    var image = new PdfBitmap(content.src);\n\n    if (!isNullOrUndefined(width)) {\n      documentHeader.graphics.drawImage(image, x, y, width, height);\n    } else {\n      documentHeader.graphics.drawImage(image, x, y);\n    }\n  };\n  /* tslint:disable-next-line:no-any */\n\n\n  PdfExport.prototype.drawLine = function (documentHeader, content) {\n    var x1 = content.points.x1 * 0.75;\n    var y1 = content.points.y1 * 0.75;\n    var x2 = content.points.x2 * 0.75;\n    var y2 = content.points.y2 * 0.75;\n    var pen = this.getPenFromContent(content);\n\n    if (!isNullOrUndefined(content.style) && content.style !== null) {\n      if (!isNullOrUndefined(content.style.penSize) && content.style.penSize !== null && typeof content.style.penSize === 'number') {\n        pen.width = content.style.penSize * 0.75;\n      }\n\n      pen.dashStyle = this.getDashStyle(content.style.dashStyle);\n    }\n\n    documentHeader.graphics.drawLine(pen, x1, y1, x2, y2);\n  };\n  /* tslint:disable-next-line:no-any */\n\n  /* tslint:disable-next-line:max-line-length */\n\n\n  PdfExport.prototype.processAggregates = function (sRows, pdfGrid, border, font, brush, backgroundBrush, isCaption, captionRow, groupIndex, isGroupedFooter) {\n    for (var _i = 0, sRows_1 = sRows; _i < sRows_1.length; _i++) {\n      var row = sRows_1[_i];\n      var startIndex = 0;\n      var leastCaptionSummaryIndex = -1;\n      var index = 0;\n      var isEmpty = true;\n      /* tslint:disable-next-line:no-any */\n\n      var value = [];\n\n      for (var i = 0; i < pdfGrid.columns.count; i++) {\n        var cell = row.cells[index];\n\n        if (cell.cellType === CellType.DetailFooterIntent) {\n          i--;\n          index++;\n          continue;\n        }\n\n        if (!this.hideColumnInclude) {\n          while (cell.visible === undefined) {\n            if (cell.cellType === CellType.DetailFooterIntent) {\n              continue;\n            }\n\n            if (!isNullOrUndefined(captionRow)) {\n              if (!isNullOrUndefined(captionRow.cells.getCell(i).value)) {\n                /* tslint:disable-next-line:max-line-length */\n                var args = {\n                  row: row,\n                  type: AggregateTemplateType.GroupCaption,\n                  style: captionRow.cells\n                };\n                this.parent.trigger(events.pdfAggregateQueryCellInfo, args);\n                value.push('');\n                value.push(captionRow.cells.getCell(i).value);\n                isEmpty = false;\n\n                if (!isCaption) {\n                  i += 1;\n                }\n              } else {\n                value.push('');\n              }\n            } else {\n              value.push('');\n            }\n\n            i += 1;\n            index = index + 1;\n            cell = row.cells[index];\n          }\n\n          while (!isNullOrUndefined(cell.visible) && !cell.visible) {\n            index = index + 1;\n            cell = row.cells[index];\n          }\n        }\n\n        if (cell.isDataCell) {\n          var templateFn = {};\n          /* tslint:disable-next-line:max-line-length */\n\n          if (!isNullOrUndefined(cell.column.footerTemplate) || !isNullOrUndefined(cell.column.groupCaptionTemplate) || !isNullOrUndefined(cell.column.groupFooterTemplate)) {\n            /* tslint:disable-next-line:no-any */\n            var result = this.getTemplateFunction(templateFn, i, leastCaptionSummaryIndex, cell);\n            templateFn = result.templateFunction;\n            leastCaptionSummaryIndex = result.leastCaptionSummaryIndex;\n            /* tslint:disable-next-line:max-line-length */\n\n            var txt = templateFn[getEnumValue(CellType, cell.cellType)](row.data[cell.column.field ? cell.column.field : cell.column.columnName]);\n            value.push(txt[0].textContent);\n            isEmpty = false;\n          } else {\n            /* tslint:disable-next-line:no-any */\n            var result = this.getSummaryWithoutTemplate(row.data[cell.column.field]);\n\n            if (!isNullOrUndefined(result)) {\n              value.push(result);\n            }\n          }\n        } else {\n          value.push('');\n        }\n\n        if (isEmpty && value[i] !== '' && !isNullOrUndefined(value[i]) && value[i] !== null) {\n          isEmpty = false;\n        }\n\n        index += 1;\n      }\n\n      if (isCaption) {\n        for (var i = this.parent.groupSettings.columns.length + 1; i < value.length - 1; i++) {\n          value[i] = value[i + 1];\n        }\n      }\n\n      if (!isEmpty) {\n        if (!isCaption) {\n          var gridRow = pdfGrid.rows.addRow();\n          gridRow.style.setBorder(border);\n          gridRow.style.setFont(font);\n          gridRow.style.setTextBrush(brush);\n          gridRow.style.setBackgroundBrush(backgroundBrush);\n          /* tslint:disable-next-line:max-line-length */\n\n          var args = {\n            row: row,\n            type: isGroupedFooter ? AggregateTemplateType.GroupFooter : AggregateTemplateType.Footer,\n            style: gridRow.cells\n          };\n          this.parent.trigger(events.pdfAggregateQueryCellInfo, args);\n\n          for (var i = 0; i < pdfGrid.columns.count; i++) {\n            gridRow.cells.getCell(i).value = value[i].toString();\n          }\n        } else {\n          for (var i = 0; i < pdfGrid.columns.count; i++) {\n            captionRow.cells.getCell(i).value = value[i].toString();\n\n            if (i === groupIndex + 1 && leastCaptionSummaryIndex !== -1 && leastCaptionSummaryIndex !== 1) {\n              captionRow.cells.getCell(i).columnSpan = leastCaptionSummaryIndex - (groupIndex + 1);\n            } else if (i === groupIndex + 1 && leastCaptionSummaryIndex === -1) {\n              captionRow.cells.getCell(i).columnSpan = pdfGrid.columns.count - (groupIndex + 1);\n            }\n          }\n        }\n      }\n    }\n  };\n  /* tslint:disable-next-line:no-any */\n\n\n  PdfExport.prototype.getTemplateFunction = function (templateFn, index, leastCaptionSummaryIndex, cell) {\n    if (!isNullOrUndefined(cell.column.footerTemplate) && cell.cellType === CellType.Summary) {\n      templateFn[getEnumValue(CellType, CellType.Summary)] = compile(cell.column.footerTemplate);\n    } else if (!isNullOrUndefined(cell.column.groupCaptionTemplate)) {\n      if (leastCaptionSummaryIndex === -1) {\n        leastCaptionSummaryIndex = index;\n      }\n\n      templateFn[getEnumValue(CellType, CellType.CaptionSummary)] = compile(cell.column.groupCaptionTemplate);\n    } else {\n      templateFn[getEnumValue(CellType, CellType.GroupSummary)] = compile(cell.column.groupFooterTemplate);\n    }\n\n    return {\n      templateFunction: templateFn,\n      leastCaptionSummaryIndex: leastCaptionSummaryIndex\n    };\n  };\n  /* tslint:disable-next-line:no-any */\n\n\n  PdfExport.prototype.getSummaryWithoutTemplate = function (data) {\n    if (!isNullOrUndefined(data.Sum)) {\n      return data.Sum;\n    } else if (!isNullOrUndefined(data.Average)) {\n      return data.Average;\n    } else if (!isNullOrUndefined(data.Max)) {\n      return data.Max;\n    } else if (!isNullOrUndefined(data.Min)) {\n      return data.Min;\n    } else if (!isNullOrUndefined(data.Count)) {\n      return data.Count;\n    } else if (!isNullOrUndefined(data.TrueCount)) {\n      return data.TrueCount;\n    } else if (!isNullOrUndefined(data.FalseCount)) {\n      return data.FalseCount;\n    } else if (!isNullOrUndefined(data.Custom)) {\n      return data.Custom;\n    }\n  };\n  /**\n   * Set alignment, width and type of the values of the column\n   */\n\n\n  PdfExport.prototype.setColumnProperties = function (gridColumns, pdfGrid, helper, gObj, allowHorizontalOverflow) {\n    var startIndex = gObj.groupSettings.columns.length;\n\n    for (var i = 0; i < startIndex; i++) {\n      pdfGrid.columns.getColumn(i).width = 20;\n    }\n\n    for (var i = 0; i < gridColumns.length; i++) {\n      if (!isNullOrUndefined(gridColumns[i].textAlign)) {\n        pdfGrid.columns.getColumn(i + startIndex).format = this.getHorizontalAlignment(gridColumns[i].textAlign);\n      } // Need to add width consideration with % value\n\n\n      if (pdfGrid.style.allowHorizontalOverflow && !isNullOrUndefined(gridColumns[i].width) && allowHorizontalOverflow) {\n        pdfGrid.columns.getColumn(i + startIndex).width = typeof gridColumns[i].width === 'number' ? gridColumns[i].width * 0.75 : helper.getConvertedWidth(gridColumns[i].width) * 0.75;\n      }\n    }\n  };\n  /**\n   * set default style properties of each rows in exporting grid\n   * @private\n   */\n\n\n  PdfExport.prototype.setRecordThemeStyle = function (row, border) {\n    if (!isNullOrUndefined(this.gridTheme) && !isNullOrUndefined(this.gridTheme.record)) {\n      var fontFamily = !isNullOrUndefined(this.gridTheme.record.fontName) ? this.getFontFamily(this.gridTheme.record.fontName) : PdfFontFamily.Helvetica;\n      var fontSize = !isNullOrUndefined(this.gridTheme.record.fontSize) ? this.gridTheme.record.fontSize : 9.75;\n      var fontStyle = this.getFontStyle(this.gridTheme.record);\n      var font = new PdfStandardFont(fontFamily, fontSize, fontStyle);\n\n      if (!isNullOrUndefined(this.gridTheme.record.font)) {\n        font = this.gridTheme.record.font;\n      }\n\n      row.style.setFont(font);\n      var pdfColor = new PdfColor();\n\n      if (!isNullOrUndefined(this.gridTheme.record.fontColor)) {\n        var penBrushColor = this.hexToRgb(this.gridTheme.record.fontColor);\n        pdfColor = new PdfColor(penBrushColor.r, penBrushColor.g, penBrushColor.b);\n      }\n\n      row.style.setTextBrush(new PdfSolidBrush(pdfColor));\n    } else {\n      row.style.setTextBrush(new PdfSolidBrush(new PdfColor(0, 0, 0)));\n    }\n\n    var borderRecord = this.gridTheme && this.gridTheme.record && this.gridTheme.record.border ? this.getBorderStyle(this.gridTheme.record.border) : border;\n    row.style.setBorder(borderRecord);\n    return row;\n  };\n  /**\n   * generate the formatted cell values\n   * @private\n   */\n\n\n  PdfExport.prototype.processRecord = function (border, columns, gObj, dataSource, pdfGrid, startIndex, pdfExportProperties, helper, rowIndex) {\n    var rows = helper.getGridRowModel(columns, dataSource, gObj, rowIndex);\n\n    for (var _i = 0, rows_1 = rows; _i < rows_1.length; _i++) {\n      var row = rows_1[_i];\n      rowIndex++; // create a new row and set default style properties\n\n      var gridRow = this.setRecordThemeStyle(pdfGrid.rows.addRow(), border);\n      var cellLength = row.cells.length;\n\n      for (var j = 0; j < cellLength; j++) {\n        var gridCell = row.cells[j];\n\n        if (gridCell.cellType !== CellType.Data) {\n          continue;\n        }\n\n        var column = gridCell.column;\n        var field = column.field;\n        var cellValue = !isNullOrUndefined(field) ? column.valueAccessor(field, row.data, column) : '';\n        var value = !isNullOrUndefined(cellValue) ? cellValue : '';\n        var foreignKeyData = void 0;\n\n        if (column.isForeignColumn && column.isForeignColumn()) {\n          foreignKeyData = helper.getFData(value, column);\n          value = getValue(column.foreignKeyValue, foreignKeyData);\n        }\n\n        var data = row.data;\n        var cell = gridRow.cells.getCell(j);\n        var args = {\n          data: data,\n          value: value,\n          column: column,\n          style: undefined,\n          colSpan: 1,\n          cell: cell\n        };\n        args.value = this.exportValueFormatter.formatCellValue(args, gObj.isServerRendered);\n        this.parent.trigger(events.pdfQueryCellInfo, args);\n        cell.value = args.value;\n\n        if (!isNullOrUndefined(args.style)) {\n          this.processCellStyle(cell, args);\n        }\n\n        if (args.colSpan > 1) {\n          if (j + 1 + args.colSpan > gridRow.cells.count) {\n            args.colSpan = gridRow.cells.count - (j + 1);\n          }\n\n          cell.columnSpan = args.colSpan;\n\n          for (var i = 1; i < cell.columnSpan; i++) {\n            var spanCell = gridRow.cells.getCell(j + i);\n            spanCell.value = '';\n          }\n\n          j += args.colSpan - 1;\n        }\n      }\n\n      if (row.isExpand) {\n        var gridRow_1 = this.setRecordThemeStyle(pdfGrid.rows.addRow(), border);\n        var cell = gridRow_1.cells.getCell(startIndex);\n        cell.columnSpan = gridRow_1.cells.count - startIndex;\n        cell.style.cellPadding = new PdfPaddings(10, 10, 10, 10);\n        gObj.isPrinting = true;\n        var exportType = !isNullOrUndefined(pdfExportProperties) && pdfExportProperties.exportType ? pdfExportProperties.exportType : 'AllPages';\n        var returnValue = this.helper.createChildGrid(gObj, row, exportType, this.gridPool);\n        var childGridObj = returnValue.childGrid;\n        var element = returnValue.element;\n        childGridObj.actionFailure = helper.failureHandler(this.gridPool, childGridObj, this.globalResolve);\n        var args = {\n          childGrid: childGridObj,\n          row: row,\n          cell: cell,\n          exportProperties: pdfExportProperties\n        };\n        this.parent.trigger(events.exportDetailDataBound, args);\n        childGridObj.beforeDataBound = this.childGridCell(cell, childGridObj, pdfExportProperties);\n        childGridObj.appendTo(element);\n      }\n\n      this.parent.notify(events.exportRowDataBound, {\n        type: 'pdf',\n        rowObj: row\n      });\n    }\n\n    return rowIndex;\n  };\n\n  PdfExport.prototype.childGridCell = function (cell, childGridObj, pdfExportProperties) {\n    var _this = this;\n\n    return function (result) {\n      childGridObj.beforeDataBound = null;\n      result.cancel = true;\n      cell.value = _this.processGridExport(childGridObj, result, pdfExportProperties);\n      childGridObj.destroy();\n      detach(childGridObj.element);\n      _this.gridPool[childGridObj.id] = true;\n\n      _this.helper.checkAndExport(_this.gridPool, _this.globalResolve);\n\n      return cell;\n    };\n  };\n\n  PdfExport.prototype.processCellStyle = function (cell, args) {\n    if (!isNullOrUndefined(args.style.backgroundColor)) {\n      var backColor = this.hexToRgb(args.style.backgroundColor);\n      cell.style.backgroundBrush = new PdfSolidBrush(new PdfColor(backColor.r, backColor.g, backColor.b));\n    }\n\n    if (!isNullOrUndefined(args.style.textAlignment)) {\n      cell.style.stringFormat = this.getHorizontalAlignment(args.style.textAlignment);\n    }\n\n    if (!isNullOrUndefined(args.style.cellPadding)) {\n      cell.style.cellPadding = args.style.cellPadding;\n    }\n\n    if (!isNullOrUndefined(args.style.verticalAlignment)) {\n      cell.style.stringFormat = this.getVerticalAlignment(args.style.verticalAlignment, cell.style.stringFormat);\n    }\n\n    if (!isNullOrUndefined(args.style.textBrushColor)) {\n      var textBrushColor = this.hexToRgb(args.style.textBrushColor);\n      cell.style.textBrush = new PdfSolidBrush(new PdfColor(textBrushColor.r, textBrushColor.g, textBrushColor.b));\n    }\n\n    if (!isNullOrUndefined(args.style.textPenColor)) {\n      var textPenColor = this.hexToRgb(args.style.textPenColor);\n      cell.style.textPen = new PdfPen(new PdfColor(textPenColor.r, textPenColor.g, textPenColor.b));\n    }\n\n    if (!isNullOrUndefined(args.style.fontFamily) || !isNullOrUndefined(args.style.fontSize) || !isNullOrUndefined(args.style.bold) || !isNullOrUndefined(args.style.italic) || !isNullOrUndefined(args.style.underline) || !isNullOrUndefined(args.style.strikeout)) {\n      cell.style.font = this.getFont(args);\n    }\n\n    if (!isNullOrUndefined(args.style.border)) {\n      var border = new PdfBorders();\n      var borderWidth = args.style.border.width; // set border width\n\n      var width = !isNullOrUndefined(borderWidth) && typeof borderWidth === 'number' ? borderWidth * 0.75 : undefined; // set border color\n\n      var color = new PdfColor(196, 196, 196);\n\n      if (!isNullOrUndefined(args.style.border.color)) {\n        var borderColor = this.hexToRgb(args.style.border.color);\n        color = new PdfColor(borderColor.r, borderColor.g, borderColor.b);\n      }\n\n      var pen = new PdfPen(color, width); // set border dashStyle 'Solid <default>, Dash, Dot, DashDot, DashDotDot'\n\n      if (!isNullOrUndefined(args.style.border.dashStyle)) {\n        pen.dashStyle = this.getDashStyle(args.style.border.dashStyle);\n      }\n\n      border.all = pen;\n      cell.style.borders = border;\n    }\n\n    if (!isNullOrUndefined(args.style.paragraphIndent)) {\n      cell.style.stringFormat = new PdfStringFormat();\n      cell.style.stringFormat.paragraphIndent = args.style.paragraphIndent;\n    }\n  };\n  /**\n   * set text alignment of each columns in exporting grid\n   * @private\n   */\n\n\n  PdfExport.prototype.getHorizontalAlignment = function (textAlign, format) {\n    if (format === undefined) {\n      format = new PdfStringFormat();\n    }\n\n    switch (textAlign) {\n      case 'Right':\n        format.alignment = PdfTextAlignment.Right;\n        break;\n\n      case 'Center':\n        format.alignment = PdfTextAlignment.Center;\n        break;\n\n      case 'Justify':\n        format.alignment = PdfTextAlignment.Justify;\n        break;\n\n      case 'Left':\n        format.alignment = PdfTextAlignment.Left;\n        break;\n    }\n\n    return format;\n  };\n  /**\n   * set vertical alignment of each columns in exporting grid\n   * @private\n   */\n\n\n  PdfExport.prototype.getVerticalAlignment = function (verticalAlign, format, textAlign) {\n    if (format === undefined) {\n      format = new PdfStringFormat();\n      format = this.getHorizontalAlignment(textAlign, format);\n    }\n\n    switch (verticalAlign) {\n      case 'Bottom':\n        format.lineAlignment = PdfVerticalAlignment.Bottom;\n        break;\n\n      case 'Middle':\n        format.lineAlignment = PdfVerticalAlignment.Middle;\n        break;\n\n      case 'Top':\n        format.lineAlignment = PdfVerticalAlignment.Top;\n        break;\n    }\n\n    return format;\n  };\n\n  PdfExport.prototype.getFontFamily = function (fontFamily) {\n    switch (fontFamily) {\n      case 'TimesRoman':\n        return 2;\n\n      case 'Courier':\n        return 1;\n\n      case 'Symbol':\n        return 3;\n\n      case 'ZapfDingbats':\n        return 4;\n\n      default:\n        return 0;\n    }\n  };\n  /* tslint:disable-next-line:no-any */\n\n\n  PdfExport.prototype.getFont = function (content) {\n    if (content.font) {\n      return content.font;\n    }\n\n    var fontSize = !isNullOrUndefined(content.style.fontSize) ? content.style.fontSize * 0.75 : 9.75;\n    var fontFamily = !isNullOrUndefined(content.style.fontFamily) ? this.getFontFamily(content.style.fontFamily) : PdfFontFamily.TimesRoman;\n    var fontStyle = PdfFontStyle.Regular;\n\n    if (!isNullOrUndefined(content.style.bold) && content.style.bold) {\n      fontStyle |= PdfFontStyle.Bold;\n    }\n\n    if (!isNullOrUndefined(content.style.italic) && content.style.italic) {\n      fontStyle |= PdfFontStyle.Italic;\n    }\n\n    if (!isNullOrUndefined(content.style.underline) && content.style.underline) {\n      fontStyle |= PdfFontStyle.Underline;\n    }\n\n    if (!isNullOrUndefined(content.style.strikeout) && content.style.strikeout) {\n      fontStyle |= PdfFontStyle.Strikeout;\n    }\n\n    return new PdfStandardFont(fontFamily, fontSize, fontStyle);\n  };\n\n  PdfExport.prototype.getPageNumberStyle = function (pageNumberType) {\n    switch (pageNumberType) {\n      case 'LowerLatin':\n        return 2;\n\n      case 'LowerRoman':\n        return 3;\n\n      case 'UpperLatin':\n        return 4;\n\n      case 'UpperRoman':\n        return 5;\n\n      default:\n        return 1;\n    }\n  };\n\n  PdfExport.prototype.setContentFormat = function (content, format) {\n    if (!isNullOrUndefined(content.size)) {\n      var width = content.size.width * 0.75;\n      var height = content.size.height * 0.75;\n      format = new PdfStringFormat(PdfTextAlignment.Left, PdfVerticalAlignment.Middle);\n\n      if (!isNullOrUndefined(content.style.hAlign)) {\n        switch (content.style.hAlign) {\n          case 'Right':\n            format.alignment = PdfTextAlignment.Right;\n            break;\n\n          case 'Center':\n            format.alignment = PdfTextAlignment.Center;\n            break;\n\n          case 'Justify':\n            format.alignment = PdfTextAlignment.Justify;\n            break;\n\n          default:\n            format.alignment = PdfTextAlignment.Left;\n        }\n      }\n\n      if (!isNullOrUndefined(content.style.vAlign)) {\n        format = this.getVerticalAlignment(content.style.vAlign, format);\n      }\n\n      return {\n        format: format,\n        size: new SizeF(width, height)\n      };\n    }\n\n    return null;\n  };\n\n  PdfExport.prototype.getPageSize = function (pageSize) {\n    switch (pageSize) {\n      case 'Letter':\n        return new SizeF(612, 792);\n\n      case 'Note':\n        return new SizeF(540, 720);\n\n      case 'Legal':\n        return new SizeF(612, 1008);\n\n      case 'A0':\n        return new SizeF(2380, 3368);\n\n      case 'A1':\n        return new SizeF(1684, 2380);\n\n      case 'A2':\n        return new SizeF(1190, 1684);\n\n      case 'A3':\n        return new SizeF(842, 1190);\n\n      case 'A5':\n        return new SizeF(421, 595);\n\n      case 'A6':\n        return new SizeF(297, 421);\n\n      case 'A7':\n        return new SizeF(210, 297);\n\n      case 'A8':\n        return new SizeF(148, 210);\n\n      case 'A9':\n        return new SizeF(105, 148);\n      // case 'A10':\n      //     return new SizeF(74, 105);\n\n      case 'B0':\n        return new SizeF(2836, 4008);\n\n      case 'B1':\n        return new SizeF(2004, 2836);\n\n      case 'B2':\n        return new SizeF(1418, 2004);\n\n      case 'B3':\n        return new SizeF(1002, 1418);\n\n      case 'B4':\n        return new SizeF(709, 1002);\n\n      case 'B5':\n        return new SizeF(501, 709);\n\n      case 'Archa':\n        return new SizeF(648, 864);\n\n      case 'Archb':\n        return new SizeF(864, 1296);\n\n      case 'Archc':\n        return new SizeF(1296, 1728);\n\n      case 'Archd':\n        return new SizeF(1728, 2592);\n\n      case 'Arche':\n        return new SizeF(2592, 3456);\n\n      case 'Flsa':\n        return new SizeF(612, 936);\n\n      case 'HalfLetter':\n        return new SizeF(396, 612);\n\n      case 'Letter11x17':\n        return new SizeF(792, 1224);\n\n      case 'Ledger':\n        return new SizeF(1224, 792);\n\n      default:\n        return new SizeF(595, 842);\n    }\n  };\n\n  PdfExport.prototype.getDashStyle = function (dashStyle) {\n    switch (dashStyle) {\n      case 'Dash':\n        return 1;\n\n      case 'Dot':\n        return 2;\n\n      case 'DashDot':\n        return 3;\n\n      case 'DashDotDot':\n        return 4;\n\n      default:\n        return 0;\n    }\n  };\n\n  PdfExport.prototype.getPenFromContent = function (content) {\n    var pen = new PdfPen(new PdfColor(0, 0, 0));\n\n    if (!isNullOrUndefined(content.style) && content.style !== null && !isNullOrUndefined(content.style.penColor)) {\n      var penColor = this.hexToRgb(content.style.penColor);\n      pen = new PdfPen(new PdfColor(penColor.r, penColor.g, penColor.b));\n    }\n\n    return pen;\n  };\n\n  PdfExport.prototype.getBrushFromContent = function (content) {\n    var brush = null;\n\n    if (!isNullOrUndefined(content.style.textBrushColor)) {\n      /* tslint:disable-next-line:max-line-length */\n      var brushColor = this.hexToRgb(content.style.textBrushColor);\n      brush = new PdfSolidBrush(new PdfColor(brushColor.r, brushColor.g, brushColor.b));\n    }\n\n    return brush;\n  };\n\n  PdfExport.prototype.hexToRgb = function (hex) {\n    if (hex === null || hex === '' || hex.length !== 7) {\n      throw new Error('please set valid hex value for color...');\n    }\n\n    hex = hex.substring(1);\n    var bigint = parseInt(hex, 16);\n    var r = bigint >> 16 & 255;\n    var g = bigint >> 8 & 255;\n    var b = bigint & 255;\n    return {\n      r: r,\n      g: g,\n      b: b\n    };\n  };\n\n  PdfExport.prototype.getFontStyle = function (theme) {\n    var fontStyle = PdfFontStyle.Regular;\n\n    if (!isNullOrUndefined(theme) && theme.bold) {\n      fontStyle |= PdfFontStyle.Bold;\n    }\n\n    if (!isNullOrUndefined(theme) && theme.italic) {\n      fontStyle |= PdfFontStyle.Italic;\n    }\n\n    if (!isNullOrUndefined(theme) && theme.underline) {\n      fontStyle |= PdfFontStyle.Underline;\n    }\n\n    if (!isNullOrUndefined(theme) && theme.strikeout) {\n      fontStyle |= PdfFontStyle.Strikeout;\n    }\n\n    return fontStyle;\n  };\n\n  PdfExport.prototype.getBorderStyle = function (border) {\n    var borders = new PdfBorders();\n\n    if (!isNullOrUndefined(border)) {\n      var borderWidth = border.width; // set border width\n\n      var width = !isNullOrUndefined(borderWidth) && typeof borderWidth === 'number' ? borderWidth * 0.75 : undefined; // set border color\n\n      var color = new PdfColor(196, 196, 196);\n\n      if (!isNullOrUndefined(border.color)) {\n        var borderColor = this.hexToRgb(border.color);\n        color = new PdfColor(borderColor.r, borderColor.g, borderColor.b);\n      }\n\n      var pen = new PdfPen(color, width); // set border dashStyle 'Solid <default>, Dash, Dot, DashDot, DashDotDot'\n\n      if (!isNullOrUndefined(border.dashStyle)) {\n        pen.dashStyle = this.getDashStyle(border.dashStyle);\n      }\n\n      borders.all = pen;\n    } else {\n      borders.all = new PdfPen(new PdfColor(234, 234, 234));\n    }\n\n    return borders;\n  };\n  /**\n   * To destroy the pdf export\n   * @return{void}\n   * @hidden\n   */\n\n\n  PdfExport.prototype.destroy = function () {//destroy for exporting\n  };\n\n  return PdfExport;\n}();\n\nexport { PdfExport };","map":{"version":3,"sources":["/home/nikhil/Desktop/data_grid_editor-master/node_modules/@syncfusion/ej2-grids/src/grid/actions/pdf-export.js"],"names":["events","PdfDocument","PdfGrid","PdfBorders","PdfPen","PdfPaddings","PdfStandardFont","PdfFontFamily","PdfFontStyle","PdfBitmap","PdfStringFormat","PdfTextAlignment","PdfColor","PdfSolidBrush","PdfVerticalAlignment","RectangleF","PdfPageTemplateElement","PointF","PdfPageNumberField","PdfCompositeField","PdfPageCountField","SizeF","PdfPageSettings","PdfPageOrientation","PdfTrueTypeFont","ExportHelper","ExportValueFormatter","Data","SummaryModelGenerator","GroupSummaryModelGenerator","CaptionSummaryModelGenerator","compile","getEnumValue","isNullOrUndefined","detach","isBlazor","CellType","AggregateTemplateType","DataManager","Query","getValue","getUid","getPrintGridModel","measureColumnDepth","isExportColumns","updateColumnTypeForExportColumns","prepareColumns","PdfExport","parent","hideColumnInclude","currentViewData","customDataSource","isGrouping","headerOnPages","drawPosition","xPosition","yPosition","helper","gridPool","prototype","getModuleName","init","exportValueFormatter","locale","pdfDocument","undefined","isExporting","id","pdfPageSettings","exportWithData","pdfDoc","resolve","returnType","pdfExportProperties","isMultipleExport","reject","_this","processExport","then","trigger","pdfExportComplete","isBlob","promise","blobPromise","log","catch","e","actionFailure","Map","data","childGrid","hierarchyExportMode","expandedRows","args","requestType","cancel","headerPageNumbers","gridDrawPosition","gridObject","can","header","drawPos","beforePdfExport","Promise","dataSource","executeQuery","exportType","getCurrentViewRecords","allPromise_1","push","getData","getQuery","getColumnData","all","gObj","section","sections","add","pdfGrid","processSectionExportProperties","pdfPage","pages","processGridExport","globalResolve","checkAndExport","draw","drawHeader","fileName","save","destroy","pageOrientation","pageSize","orientation","Landscape","Portrait","size","getPageSize","setPageSettings","allowHorizontalOverflow","gridTheme","theme","getGridPdfFont","processExportProperties","result","columns","enableColumnVirtualization","getGridExportColumns","filter","commands","groupSettings","length","hierarchyPrintMode","headerThemeStyle","getHeaderThemeStyle","border","headerFont","font","headerBrush","brush","returnValue","getHeaders","gridColumns","processGridHeaders","rows","setColumnProperties","captionThemeStyle","getSummaryCaptionThemeStyle","processGroupedRecords","backgroundBrush","processRecord","aggregates","summaryModel","sRows","aggregateModule","prepareSummaryInfo","generateRows","records","processAggregates","row","addRow","style","setBorder","caption","fontSize","fontFamily","fontName","getFontFamily","Helvetica","fontStyle","getFontStyle","pdfColor","fontColor","penBrushColor","hexToRgb","r","g","b","borderCaption","getBorderStyle","isTrueType","headerSize","headerStyle","fontFamily_1","captionFont","captionSize","captionStyle","fontFamily_2","record","recordFont","recordSize","recordStyle","fontFamily_3","level","index","groupIndex","_loop_1","dataSourceItems","col","getColumnByField","field","value","key","column","isForeignKey","isForeignColumn","this_1","headerText","enableGroupByFormat","formatCellValue","count","cArgs","captionText","type","exportGroupCaption","cells","getCell","stringFormat","Left","setFont","setTextBrush","setBackgroundBrush","captionSummaryModel","items","columnSpan","childLevels","groupSummaryModel","isGroupedFooter","_i","dataSource_1","gridColumn","grid","eCols","columnCount","depth","cols","allowGrouping","headers","applyTextAndSpan","rowIdx","colIdx","rowSpan","colSpan","gridHeader","getHeader","pdfCell","cell","headerTextAlign","getHorizontalAlignment","getVerticalAlignment","textAlign","cellType","HeaderIndent","DetailHeader","width","gridCell","pdfHeaderQueryCellInfo","recuHeader","spanCnt","colIndex","rowIndex","isRoot","cidx","i","newSpanCnt","visible","clientSize","footer","position","fromBottom","height","bounds","template","bottom","drawPageTemplate","includeHiddenColumn","fromTop","top","headerTemplate_1","getPageByIndex","graphics","drawPdfTemplate","element","_a","contents","content","processContentValidation","Error","drawText","drawPageNumber","src","drawImage","drawLine","points","x1","y1","x2","y2","x","y","pageTemplate","getFont","getBrushFromContent","pen","textPenColor","penColor","toString","format","setContentFormat","drawString","documentHeader","textBrushColor","brushColor","pageNumber","numberStyle","getPageNumberStyle","pageNumberType","compositeField","indexOf","pageCount","replace","image","getPenFromContent","penSize","dashStyle","getDashStyle","isCaption","captionRow","sRows_1","startIndex","leastCaptionSummaryIndex","isEmpty","DetailFooterIntent","GroupCaption","pdfAggregateQueryCellInfo","isDataCell","templateFn","footerTemplate","groupCaptionTemplate","groupFooterTemplate","getTemplateFunction","templateFunction","txt","columnName","textContent","getSummaryWithoutTemplate","gridRow","GroupFooter","Footer","Summary","CaptionSummary","GroupSummary","Sum","Average","Max","Min","Count","TrueCount","FalseCount","Custom","getColumn","getConvertedWidth","setRecordThemeStyle","borderRecord","getGridRowModel","rows_1","cellLength","j","cellValue","valueAccessor","foreignKeyData","getFData","foreignKeyValue","isServerRendered","pdfQueryCellInfo","processCellStyle","spanCell","isExpand","gridRow_1","cellPadding","isPrinting","createChildGrid","childGridObj","failureHandler","exportProperties","exportDetailDataBound","beforeDataBound","childGridCell","appendTo","notify","exportRowDataBound","rowObj","backgroundColor","backColor","textAlignment","verticalAlignment","textBrush","textPen","bold","italic","underline","strikeout","borderWidth","color","borderColor","borders","paragraphIndent","alignment","Right","Center","Justify","verticalAlign","lineAlignment","Bottom","Middle","Top","TimesRoman","Regular","Bold","Italic","Underline","Strikeout","hAlign","vAlign","hex","substring","bigint","parseInt"],"mappings":"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","sourcesContent":["import * as events from '../base/constant';\nimport { PdfDocument, PdfGrid, PdfBorders, PdfPen, PdfPaddings } from '@syncfusion/ej2-pdf-export';\nimport { PdfStandardFont, PdfFontFamily, PdfFontStyle, PdfBitmap } from '@syncfusion/ej2-pdf-export';\nimport { PdfStringFormat, PdfTextAlignment, PdfColor, PdfSolidBrush } from '@syncfusion/ej2-pdf-export';\nimport { PdfVerticalAlignment, RectangleF, PdfPageTemplateElement } from '@syncfusion/ej2-pdf-export';\nimport { PointF, PdfPageNumberField, PdfCompositeField } from '@syncfusion/ej2-pdf-export';\nimport { PdfPageCountField, SizeF, PdfPageSettings, PdfPageOrientation } from '@syncfusion/ej2-pdf-export';\nimport { PdfTrueTypeFont } from '@syncfusion/ej2-pdf-export';\nimport { ExportHelper, ExportValueFormatter } from './export-helper';\nimport { Data } from '../actions/data';\nimport { SummaryModelGenerator, GroupSummaryModelGenerator, CaptionSummaryModelGenerator } from '../services/summary-model-generator';\nimport { compile, getEnumValue, isNullOrUndefined, detach, isBlazor } from '@syncfusion/ej2-base';\nimport { CellType, AggregateTemplateType } from '../base/enum';\nimport { DataManager, Query } from '@syncfusion/ej2-data';\nimport { getValue } from '@syncfusion/ej2-base';\nimport { getUid, getPrintGridModel, measureColumnDepth, isExportColumns, updateColumnTypeForExportColumns, prepareColumns } from '../base/util';\n/**\n * `PDF Export` module is used to handle the exportToPDF action.\n * @hidden\n */\nvar PdfExport = /** @class */ (function () {\n    /**\n     * Constructor for the Grid PDF Export module\n     * @hidden\n     */\n    function PdfExport(parent) {\n        this.hideColumnInclude = false;\n        this.currentViewData = false;\n        this.customDataSource = false;\n        this.isGrouping = false;\n        this.headerOnPages = [];\n        this.drawPosition = { xPosition: 0, yPosition: 0 };\n        this.parent = parent;\n        this.helper = new ExportHelper(parent);\n        this.gridPool = {};\n    }\n    /**\n     * For internal use only - Get the module name.\n     */\n    PdfExport.prototype.getModuleName = function () {\n        return 'PdfExport';\n    };\n    PdfExport.prototype.init = function (parent) {\n        this.exportValueFormatter = new ExportValueFormatter(parent.locale);\n        this.pdfDocument = undefined;\n        this.hideColumnInclude = false;\n        this.currentViewData = false;\n        this.parent = parent;\n        this.isGrouping = false;\n        this.isExporting = true;\n        parent.id = getUid('main-grid');\n        this.gridPool[parent.id] = false;\n        this.pdfPageSettings = new PdfPageSettings();\n    };\n    PdfExport.prototype.exportWithData = function (parent, pdfDoc, resolve, returnType, pdfExportProperties, isMultipleExport, reject) {\n        var _this = this;\n        this.init(parent);\n        if (!isNullOrUndefined(pdfDoc)) {\n            this.pdfDocument = pdfDoc;\n        }\n        else {\n            this.pdfDocument = new PdfDocument();\n        }\n        this.processExport(parent, returnType, pdfExportProperties, isMultipleExport).then(function () {\n            _this.isExporting = false;\n            parent.trigger(events.pdfExportComplete, _this.isBlob ? { promise: _this.blobPromise } : {});\n            _this.parent.log('exporting_complete', _this.getModuleName());\n            resolve(_this.pdfDocument);\n        }).catch(function (e) {\n            reject(_this.pdfDocument);\n            _this.parent.trigger(events.actionFailure, e);\n        });\n    };\n    /**\n     * Used to map the input data\n     * @return {void}\n     */\n    PdfExport.prototype.Map = function (parent, pdfExportProperties, isMultipleExport, pdfDoc, isBlob) {\n        var _this = this;\n        this.data = new Data(this.parent);\n        this.isBlob = isBlob;\n        this.gridPool = {};\n        if (parent.childGrid && !(!isNullOrUndefined(pdfExportProperties) && pdfExportProperties.hierarchyExportMode === 'None')) {\n            parent.expandedRows = getPrintGridModel(parent).expandedRows;\n        }\n        var args = {\n            requestType: 'beforePdfExport', cancel: false,\n            headerPageNumbers: [], gridDrawPosition: { xPosition: 0, yPosition: 0 }\n        };\n        if (!isBlazor()) {\n            var gridObject = 'gridObject';\n            args[gridObject] = parent;\n        }\n        var can = 'cancel';\n        var header = 'headerPageNumbers';\n        var drawPos = 'gridDrawPosition';\n        parent.trigger(events.beforePdfExport, args);\n        if (args[can] === true) {\n            return new Promise(function (resolve, reject) {\n                return resolve();\n            });\n        }\n        if (isExportColumns(pdfExportProperties)) {\n            updateColumnTypeForExportColumns(pdfExportProperties, parent);\n        }\n        this.headerOnPages = args[header];\n        this.drawPosition = args[drawPos];\n        this.parent.log('exporting_begin', this.getModuleName());\n        if (!isNullOrUndefined(pdfExportProperties) && !isNullOrUndefined(pdfExportProperties.dataSource)) {\n            if (!(pdfExportProperties.dataSource instanceof DataManager)) {\n                pdfExportProperties.dataSource = new DataManager(pdfExportProperties.dataSource);\n            }\n            return new Promise(function (resolve, reject) {\n                pdfExportProperties.dataSource.executeQuery(new Query()).then(function (returnType) {\n                    _this.exportWithData(parent, pdfDoc, resolve, returnType, pdfExportProperties, isMultipleExport, reject);\n                });\n            });\n        }\n        else if (!isNullOrUndefined(pdfExportProperties) && pdfExportProperties.exportType === 'CurrentPage') {\n            return new Promise(function (resolve, reject) {\n                _this.exportWithData(parent, pdfDoc, resolve, _this.parent.getCurrentViewRecords(), pdfExportProperties, isMultipleExport, reject);\n            });\n        }\n        else {\n            var allPromise_1 = [];\n            allPromise_1.push(this.data.getData({}, ExportHelper.getQuery(parent, this.data)));\n            allPromise_1.push(this.helper.getColumnData(parent));\n            return new Promise(function (resolve, reject) {\n                Promise.all(allPromise_1).then(function (e) {\n                    _this.init(parent);\n                    if (!isNullOrUndefined(pdfDoc)) {\n                        _this.pdfDocument = pdfDoc;\n                    }\n                    else {\n                        _this.pdfDocument = new PdfDocument();\n                    }\n                    _this.processExport(parent, e[0], pdfExportProperties, isMultipleExport).then(function () {\n                        _this.isExporting = false;\n                        parent.trigger(events.pdfExportComplete, _this.isBlob ? { promise: _this.blobPromise } : {});\n                        _this.parent.log('exporting_complete', _this.getModuleName());\n                        resolve(_this.pdfDocument);\n                    }).catch(function (e) {\n                        reject(_this.pdfDocument);\n                        _this.parent.trigger(events.actionFailure, e);\n                    });\n                });\n            });\n        }\n    };\n    PdfExport.prototype.processExport = function (gObj, returnType, pdfExportProperties, isMultipleExport) {\n        var _this = this;\n        var section = this.pdfDocument.sections.add();\n        var pdfGrid;\n        this.processSectionExportProperties(section, pdfExportProperties);\n        var pdfPage = section.pages.add();\n        return new Promise(function (resolve, reject) {\n            pdfGrid = _this.processGridExport(gObj, returnType, pdfExportProperties);\n            _this.globalResolve = resolve;\n            _this.gridPool[gObj.id] = true;\n            _this.helper.checkAndExport(_this.gridPool, _this.globalResolve);\n        }).then(function () {\n            // draw the grid\n            var xPosition = 'xPosition';\n            var yPosition = 'yPosition';\n            pdfGrid.draw(pdfPage, _this.drawPosition[xPosition], _this.drawPosition[yPosition]);\n            _this.drawHeader(pdfExportProperties);\n            if (!isMultipleExport) {\n                // save the PDF\n                if (!_this.isBlob) {\n                    if (!isNullOrUndefined(pdfExportProperties) && pdfExportProperties.fileName) {\n                        _this.pdfDocument.save(pdfExportProperties.fileName);\n                    }\n                    else {\n                        _this.pdfDocument.save('Export.pdf');\n                    }\n                }\n                else {\n                    _this.blobPromise = _this.pdfDocument.save();\n                }\n                _this.pdfDocument.destroy();\n                delete gObj.expandedRows;\n            }\n            return _this.pdfDocument;\n        });\n    };\n    PdfExport.prototype.processSectionExportProperties = function (section, pdfExportProperties) {\n        if (!isNullOrUndefined(pdfExportProperties) && (!isNullOrUndefined(pdfExportProperties.pageOrientation)\n            || !isNullOrUndefined(pdfExportProperties.pageSize))) {\n            this.pdfPageSettings.orientation = (pdfExportProperties.pageOrientation === 'Landscape') ?\n                PdfPageOrientation.Landscape : PdfPageOrientation.Portrait;\n            this.pdfPageSettings.size = this.getPageSize(pdfExportProperties.pageSize);\n            section.setPageSettings(this.pdfPageSettings);\n        }\n        return section;\n    };\n    PdfExport.prototype.processGridExport = function (gObj, returnType, pdfExportProperties) {\n        var allowHorizontalOverflow = true;\n        if (!isNullOrUndefined(pdfExportProperties)) {\n            this.gridTheme = pdfExportProperties.theme;\n            if (isBlazor() && !isNullOrUndefined(this.gridTheme)) {\n                this.getGridPdfFont(this.gridTheme);\n            }\n            allowHorizontalOverflow = isNullOrUndefined(pdfExportProperties.allowHorizontalOverflow) ?\n                true : pdfExportProperties.allowHorizontalOverflow;\n        }\n        var helper = new ExportHelper(gObj);\n        var dataSource = this.processExportProperties(pdfExportProperties, returnType.result);\n        var columns = isExportColumns(pdfExportProperties) ?\n            prepareColumns(pdfExportProperties.columns, gObj.enableColumnVirtualization) :\n            helper.getGridExportColumns(gObj.columns);\n        columns = columns.filter(function (columns) { return isNullOrUndefined(columns.commands); });\n        var isGrouping = false;\n        if (gObj.groupSettings.columns.length) {\n            isGrouping = true;\n        }\n        if (gObj.childGrid && !isNullOrUndefined(pdfExportProperties)) {\n            gObj.hierarchyPrintMode = pdfExportProperties.hierarchyExportMode || 'Expanded';\n        }\n        // create a grid\n        var pdfGrid = new PdfGrid();\n        // get header theme style\n        var headerThemeStyle = this.getHeaderThemeStyle();\n        var border = headerThemeStyle.border;\n        var headerFont = headerThemeStyle.font;\n        var headerBrush = headerThemeStyle.brush;\n        var returnValue = helper.getHeaders(columns, this.hideColumnInclude);\n        // Column collection with respect to the records in the grid\n        var gridColumns = returnValue.columns;\n        // process grid header content\n        pdfGrid = this.processGridHeaders(gObj.groupSettings.columns.length, pdfGrid, returnValue.rows, gridColumns, border, headerFont, headerBrush, gObj, allowHorizontalOverflow, columns);\n        // set alignment, width and type of the values of the column\n        this.setColumnProperties(gridColumns, pdfGrid, helper, gObj, allowHorizontalOverflow);\n        var captionThemeStyle = this.getSummaryCaptionThemeStyle();\n        if (!isNullOrUndefined(dataSource) && dataSource.length) {\n            if (isGrouping) {\n                if (!isNullOrUndefined(captionThemeStyle.border)) {\n                    border = captionThemeStyle.border;\n                }\n                this.processGroupedRecords(pdfGrid, dataSource, gridColumns, gObj, border, 0, captionThemeStyle.font, captionThemeStyle.\n                    brush, captionThemeStyle.backgroundBrush, returnType, pdfExportProperties, helper, 0);\n            }\n            else {\n                this.processRecord(border, gridColumns, gObj, dataSource, pdfGrid, 0, pdfExportProperties, helper, 0);\n            }\n            if (!isNullOrUndefined(returnType.aggregates)) {\n                var summaryModel = new SummaryModelGenerator(gObj);\n                var sRows = void 0;\n                if (gObj.aggregates.length && this.parent !== gObj) {\n                    gObj.aggregateModule.prepareSummaryInfo();\n                }\n                if (this.customDataSource) {\n                    sRows = summaryModel.generateRows(dataSource, returnType.aggregates);\n                }\n                else if (this.currentViewData) {\n                    sRows = summaryModel.generateRows(this.parent.getCurrentViewRecords(), returnType.aggregates);\n                }\n                else if (isGrouping) {\n                    sRows = summaryModel.generateRows(dataSource.records, returnType.aggregates);\n                }\n                else {\n                    sRows = summaryModel.generateRows(returnType.result, returnType.aggregates, null, null, columns);\n                }\n                this.processAggregates(sRows, pdfGrid, border, captionThemeStyle.font, captionThemeStyle.brush, captionThemeStyle.backgroundBrush, false);\n            }\n        }\n        else {\n            var row = pdfGrid.rows.addRow();\n            row.style.setBorder(border);\n        }\n        return pdfGrid;\n    };\n    PdfExport.prototype.getSummaryCaptionThemeStyle = function () {\n        if (!isNullOrUndefined(this.gridTheme) && !isNullOrUndefined(this.gridTheme.caption)) {\n            var fontSize = !isNullOrUndefined(this.gridTheme.caption.fontSize) ? this.gridTheme.caption.fontSize : 9.75;\n            var fontFamily = !isNullOrUndefined(this.gridTheme.caption.fontName) ?\n                this.getFontFamily(this.gridTheme.caption.fontName) : PdfFontFamily.Helvetica;\n            var fontStyle = this.getFontStyle(this.gridTheme.caption);\n            var pdfColor = new PdfColor(0, 0, 0);\n            if (!isNullOrUndefined(this.gridTheme.caption.fontColor)) {\n                var penBrushColor = this.hexToRgb(this.gridTheme.caption.fontColor);\n                pdfColor = new PdfColor(penBrushColor.r, penBrushColor.g, penBrushColor.b);\n            }\n            var borderCaption = this.gridTheme.caption.border ? this.getBorderStyle(this.gridTheme.caption.border) : null;\n            var font = new PdfStandardFont(fontFamily, fontSize, fontStyle);\n            if (!isNullOrUndefined(this.gridTheme.caption.font)) {\n                font = this.gridTheme.caption.font;\n            }\n            return { font: font, brush: new PdfSolidBrush(pdfColor), backgroundBrush: new PdfSolidBrush(new PdfColor(246, 246, 246)),\n                border: borderCaption };\n        }\n        else {\n            //Material theme\n            return { font: new PdfStandardFont(PdfFontFamily.Helvetica, 9.75), brush: new PdfSolidBrush(new PdfColor(0, 0, 0)),\n                backgroundBrush: new PdfSolidBrush(new PdfColor(246, 246, 246)) };\n        }\n    };\n    PdfExport.prototype.getGridPdfFont = function (args) {\n        var fontFamily = 'fontFamily';\n        var fontSize = 'fontSize';\n        var fontStyle = 'fontStyle';\n        var isTrueType = 'isTrueType';\n        var style = 0;\n        if (args.header && args.header.font) {\n            var headerFont = args.header.font[fontFamily];\n            var headerSize = args.header.font[fontSize];\n            var headerStyle = args.header.font[fontStyle];\n            style = (isNullOrUndefined(PdfFontStyle[headerStyle]) ? 0 : PdfFontStyle[headerStyle]);\n            if (args.header.font[isTrueType]) {\n                args.header.font = new PdfTrueTypeFont(headerFont, headerSize, style);\n            }\n            else {\n                var fontFamily_1 = !isNullOrUndefined(headerFont) ?\n                    this.getFontFamily(headerFont) : PdfFontFamily.Helvetica;\n                args.header.font = new PdfStandardFont(fontFamily_1, headerSize, style);\n            }\n        }\n        if (args.caption && args.caption.font) {\n            var captionFont = args.caption.font[fontFamily];\n            var captionSize = args.caption.font[fontSize];\n            var captionStyle = args.caption.font[fontStyle];\n            style = (isNullOrUndefined(PdfFontStyle[captionStyle]) ? 0 : PdfFontStyle[captionStyle]);\n            if (args.caption.font[isTrueType]) {\n                args.caption.font = new PdfTrueTypeFont(captionFont, captionSize, style);\n            }\n            else {\n                var fontFamily_2 = !isNullOrUndefined(captionFont) ?\n                    this.getFontFamily(captionFont) : PdfFontFamily.Helvetica;\n                args.caption.font = new PdfStandardFont(fontFamily_2, captionSize, style);\n            }\n        }\n        if (args.record && args.record.font) {\n            var recordFont = args.record.font[fontFamily];\n            var recordSize = args.record.font[fontSize];\n            var recordStyle = args.record.font[fontStyle];\n            style = (isNullOrUndefined(PdfFontStyle[recordStyle]) ? 0 : PdfFontStyle[recordStyle]);\n            if (args.record.font[isTrueType]) {\n                args.record.font = new PdfTrueTypeFont(recordFont, recordSize, style);\n            }\n            else {\n                var fontFamily_3 = !isNullOrUndefined(recordFont) ?\n                    this.getFontFamily(recordFont) : PdfFontFamily.Helvetica;\n                args.record.font = new PdfStandardFont(fontFamily_3, recordSize, style);\n            }\n        }\n    };\n    PdfExport.prototype.getHeaderThemeStyle = function () {\n        var border = new PdfBorders();\n        if (!isNullOrUndefined(this.gridTheme) && !isNullOrUndefined(this.gridTheme.header)) {\n            var fontFamily = !isNullOrUndefined(this.gridTheme.header.fontName) ?\n                this.getFontFamily(this.gridTheme.header.fontName) : PdfFontFamily.Helvetica;\n            var fontStyle = this.getFontStyle(this.gridTheme.header);\n            var fontSize = !isNullOrUndefined(this.gridTheme.header.fontSize) ? this.gridTheme.header.fontSize : 10.5;\n            var pdfColor = new PdfColor();\n            if (!isNullOrUndefined(this.gridTheme.header.fontColor)) {\n                var penBrushColor = this.hexToRgb(this.gridTheme.header.fontColor);\n                pdfColor = new PdfColor(penBrushColor.r, penBrushColor.g, penBrushColor.b);\n            }\n            var font = new PdfStandardFont(fontFamily, fontSize, fontStyle);\n            if (!isNullOrUndefined(this.gridTheme.header.font)) {\n                font = this.gridTheme.header.font;\n            }\n            return { border: this.getBorderStyle(this.gridTheme.header.border), font: font, brush: new PdfSolidBrush(pdfColor) };\n        }\n        else {\n            //Material theme\n            border.all = new PdfPen(new PdfColor(234, 234, 234));\n            return { border: border, font: new PdfStandardFont(PdfFontFamily.Helvetica, 10.5),\n                brush: new PdfSolidBrush(new PdfColor(102, 102, 102)) };\n        }\n    };\n    /* tslint:disable-next-line:no-any */\n    PdfExport.prototype.processGroupedRecords = function (pdfGrid, dataSource, gridColumns, gObj, border, level, font, brush, backgroundBrush, returnType, pdfExportProperties, helper, index) {\n        var _this = this;\n        var groupIndex = level;\n        var _loop_1 = function (dataSourceItems) {\n            var row = pdfGrid.rows.addRow();\n            var col = gObj.getColumnByField(dataSourceItems.field);\n            /* tslint:disable-next-line:no-any */\n            var args = {\n                value: dataSourceItems.key,\n                column: col,\n                style: undefined,\n                isForeignKey: col.isForeignColumn(),\n            };\n            /* tslint:disable-next-line:max-line-length */\n            var value = this_1.parent.getColumnByField(dataSourceItems.field).headerText + ': ' + (!col.enableGroupByFormat ? this_1.exportValueFormatter.formatCellValue(args) : dataSourceItems.key) + ' - ' + dataSourceItems.count + (dataSource.count > 1 ? ' items' : ' item');\n            var cArgs = { captionText: value, type: 'PDF' };\n            this_1.parent.trigger(events.exportGroupCaption, cArgs, function (cArgs) {\n                row.cells.getCell(groupIndex).value = cArgs.captionText;\n                row.cells.getCell(groupIndex + 1).style.stringFormat = new PdfStringFormat(PdfTextAlignment.Left);\n                row.style.setBorder(border);\n                row.style.setFont(font);\n                row.style.setTextBrush(brush);\n                row.style.setBackgroundBrush(backgroundBrush);\n                var sRows;\n                var captionSummaryModel = new CaptionSummaryModelGenerator(gObj);\n                if (!isNullOrUndefined(dataSourceItems.items.records)) {\n                    sRows = captionSummaryModel.generateRows(dataSourceItems.items.records, dataSourceItems);\n                }\n                else {\n                    sRows = captionSummaryModel.generateRows(dataSourceItems.items, dataSourceItems);\n                }\n                if (!isNullOrUndefined(sRows) && sRows.length === 0) {\n                    row.cells.getCell(groupIndex + 1).columnSpan = pdfGrid.columns.count - (groupIndex + 1);\n                }\n                if (!isNullOrUndefined(dataSource.childLevels) && dataSource.childLevels > 0) {\n                    _this.processAggregates(sRows, pdfGrid, border, font, brush, backgroundBrush, true, row, groupIndex);\n                    _this.processGroupedRecords(pdfGrid, dataSourceItems.items, gridColumns, gObj, border, (groupIndex + 1), font, brush, backgroundBrush, returnType, pdfExportProperties, helper, index);\n                    var groupSummaryModel = new GroupSummaryModelGenerator(gObj);\n                    sRows = groupSummaryModel.generateRows(dataSourceItems.items.records, dataSourceItems);\n                    _this.processAggregates(sRows, pdfGrid, border, font, brush, backgroundBrush, false);\n                }\n                else {\n                    _this.processAggregates(sRows, pdfGrid, border, font, brush, backgroundBrush, true, row, groupIndex);\n                    index = _this.processRecord(border, gridColumns, gObj, dataSourceItems.items, pdfGrid, (groupIndex + 1), pdfExportProperties, helper, index);\n                    var groupSummaryModel = new GroupSummaryModelGenerator(gObj);\n                    sRows = groupSummaryModel.generateRows(dataSourceItems.items, dataSourceItems);\n                    var isGroupedFooter = true;\n                    _this.processAggregates(sRows, pdfGrid, border, font, brush, backgroundBrush, false, null, null, isGroupedFooter);\n                }\n            });\n        };\n        var this_1 = this;\n        for (var _i = 0, dataSource_1 = dataSource; _i < dataSource_1.length; _i++) {\n            var dataSourceItems = dataSource_1[_i];\n            _loop_1(dataSourceItems);\n        }\n    };\n    PdfExport.prototype.processGridHeaders = function (childLevels, pdfGrid, rows, gridColumn, border, headerFont, headerBrush, grid, allowHorizontalOverflow, eCols) {\n        var _this = this;\n        var columnCount = gridColumn.length + childLevels;\n        var depth = measureColumnDepth(eCols);\n        var cols = eCols;\n        var index = 0;\n        if (this.parent.allowGrouping) {\n            index = this.parent.groupSettings.columns.length;\n        }\n        pdfGrid.columns.add(columnCount);\n        pdfGrid.headers.add(rows.length);\n        var applyTextAndSpan = function (rowIdx, colIdx, col, rowSpan, colSpan) {\n            var gridHeader = pdfGrid.headers.getHeader(rowIdx);\n            var pdfCell = gridHeader.cells.getCell(colIdx);\n            var cell = rows[rowIdx].cells[colIdx];\n            if (!isNullOrUndefined(col.headerTextAlign)) {\n                pdfCell.style.stringFormat = _this.getHorizontalAlignment(col.headerTextAlign);\n            }\n            if (rowSpan > 0) {\n                pdfCell.rowSpan = rowSpan;\n                pdfCell.style.stringFormat = _this.getVerticalAlignment('Bottom', pdfCell.style.stringFormat, col.textAlign);\n            }\n            if (colSpan > 0) {\n                pdfCell.columnSpan = colSpan;\n            }\n            gridHeader.style.setBorder(border);\n            gridHeader.style.setFont(headerFont);\n            gridHeader.style.setTextBrush(headerBrush);\n            pdfCell.value = col.headerText;\n            if (!isNullOrUndefined(cell) && (cell.cellType === CellType.HeaderIndent || cell.cellType === CellType.DetailHeader)) {\n                pdfCell.value = '';\n                pdfCell.width = 20;\n            }\n            var args = {\n                cell: pdfCell,\n                gridCell: cell,\n                style: pdfCell.style\n            };\n            _this.parent.trigger(events.pdfHeaderQueryCellInfo, args);\n        };\n        var recuHeader = function (cols, depth, spanCnt, colIndex, rowIndex, isRoot) {\n            var cidx = 0;\n            for (var i = 0; i < cols.length; i++) {\n                if (isRoot) {\n                    cidx = cidx + spanCnt + (i === 0 ? 0 : -1);\n                    colIndex = cidx;\n                    spanCnt = 0;\n                }\n                if (cols[i].columns && cols[i].columns.length) {\n                    var newSpanCnt = recuHeader(cols[i].columns, depth - 1, 0, i + colIndex, rowIndex + 1, false);\n                    applyTextAndSpan(rowIndex, i + colIndex, cols[i], 0, newSpanCnt);\n                    spanCnt = spanCnt + newSpanCnt;\n                    colIndex = colIndex + newSpanCnt - 1;\n                }\n                else if (cols[i].visible || _this.hideColumnInclude) {\n                    spanCnt++;\n                    applyTextAndSpan(rowIndex, i + colIndex + index, cols[i], depth, 0);\n                }\n            }\n            return spanCnt;\n        };\n        recuHeader(cols, depth, 0, 0, 0, true);\n        if (pdfGrid.columns.count >= 6 && allowHorizontalOverflow) {\n            pdfGrid.style.allowHorizontalOverflow = true;\n        }\n        return pdfGrid;\n    };\n    PdfExport.prototype.processExportProperties = function (pdfExportProperties, dataSource) {\n        if (!isNullOrUndefined(pdfExportProperties)) {\n            if (!isNullOrUndefined(pdfExportProperties.theme)) {\n                this.gridTheme = pdfExportProperties.theme;\n            }\n            var clientSize = this.pdfPageSettings.size;\n            this.drawHeader(pdfExportProperties);\n            if (!isNullOrUndefined(pdfExportProperties.footer)) {\n                /* tslint:disable-next-line:no-any */\n                var footer = pdfExportProperties.footer;\n                var position = new PointF(0, ((clientSize.width - 80) - (footer.fromBottom * 0.75)));\n                var size = new SizeF((clientSize.width - 80), (footer.height * 0.75));\n                var bounds = new RectangleF(position, size);\n                this.pdfDocument.template.bottom = this.drawPageTemplate(new PdfPageTemplateElement(bounds), footer);\n            }\n            if (!isNullOrUndefined(pdfExportProperties.includeHiddenColumn) && !this.isGrouping) {\n                this.hideColumnInclude = pdfExportProperties.includeHiddenColumn;\n            }\n            if (!isNullOrUndefined(pdfExportProperties.dataSource)) {\n                if (!(pdfExportProperties.dataSource instanceof DataManager)) {\n                    dataSource = pdfExportProperties.dataSource;\n                }\n                this.customDataSource = true;\n                this.currentViewData = false;\n            }\n            else if (!isNullOrUndefined(pdfExportProperties.exportType)) {\n                if (pdfExportProperties.exportType === 'CurrentPage') {\n                    dataSource = this.parent.currentViewData;\n                    this.currentViewData = true;\n                    this.customDataSource = false;\n                }\n                else {\n                    this.currentViewData = false;\n                    this.customDataSource = false;\n                }\n            }\n            else {\n                this.currentViewData = false;\n                this.customDataSource = false;\n            }\n        }\n        else {\n            this.currentViewData = false;\n            this.customDataSource = false;\n        }\n        return dataSource;\n    };\n    PdfExport.prototype.drawHeader = function (pdfExportProperties) {\n        var _this = this;\n        var clientSize = this.pdfPageSettings.size;\n        if (!isNullOrUndefined(pdfExportProperties) && !isNullOrUndefined(pdfExportProperties.header)) {\n            /* tslint:disable-next-line:no-any */\n            var header = pdfExportProperties.header;\n            var position = new PointF(0, header.fromTop);\n            var size = new SizeF((clientSize.width - 80), (header.height * 0.75));\n            var bounds = new RectangleF(position, size);\n            if (!this.headerOnPages.length) {\n                this.pdfDocument.template.top = this.drawPageTemplate(new PdfPageTemplateElement(bounds), header);\n            }\n            else {\n                var headerTemplate_1 = this.drawPageTemplate(new PdfPageTemplateElement(bounds), header);\n                this.headerOnPages.filter(function (index) {\n                    if (index - 1 >= 0 && index - 1 < _this.pdfDocument.pages.count - 1) {\n                        _this.pdfDocument.pages.getPageByIndex(index - 1).graphics\n                            .drawPdfTemplate(headerTemplate_1.template, new PointF(0, 0));\n                    }\n                });\n            }\n        }\n    };\n    PdfExport.prototype.drawPageTemplate = function (template, element) {\n        for (var _i = 0, _a = element.contents; _i < _a.length; _i++) {\n            var content = _a[_i];\n            this.processContentValidation(content);\n            switch (content.type) {\n                case 'Text':\n                    /* tslint:disable-next-line:max-line-length */\n                    if (content.value === '' || content.value === undefined || content.value === null || typeof content.value !== 'string') {\n                        throw new Error('please enter the valid input value in text content...');\n                    }\n                    this.drawText(template, content);\n                    break;\n                case 'PageNumber':\n                    this.drawPageNumber(template, content);\n                    break;\n                case 'Image':\n                    if (content.src === undefined || content.src === null || content.src === '') {\n                        throw new Error('please enter the valid base64 string in image content...');\n                    }\n                    this.drawImage(template, content);\n                    break;\n                case 'Line':\n                    this.drawLine(template, content);\n                    break;\n                default:\n                    throw new Error('Please set valid content type...');\n            }\n        }\n        return template;\n    };\n    PdfExport.prototype.processContentValidation = function (content) {\n        if (content.type === undefined || content.type === null) {\n            throw new Error('please set valid content type...');\n        }\n        else {\n            if (content.type === 'Line') {\n                if (content.points === undefined || content.points === null) {\n                    throw new Error('please enter valid points in ' + content.type + ' content...');\n                }\n                else {\n                    if (content.points.x1 === undefined || content.points.x1 === null || typeof content.points.x1 !== 'number') {\n                        throw new Error('please enter valid x1 co-ordinate in ' + content.type + ' points...');\n                    }\n                    if (content.points.y1 === undefined || content.points.y1 === null || typeof content.points.y1 !== 'number') {\n                        throw new Error('please enter valid y1 co-ordinate in ' + content.type + ' points...');\n                    }\n                    if (content.points.x2 === undefined || content.points.x2 === null || typeof content.points.x2 !== 'number') {\n                        throw new Error('please enter valid x2 co-ordinate in ' + content.type + ' points...');\n                    }\n                    if (content.points.y2 === undefined || content.points.y2 === null || typeof content.points.y2 !== 'number') {\n                        throw new Error('please enter valid y2 co-ordinate in ' + content.type + ' points...');\n                    }\n                }\n            }\n            else {\n                if (content.position === undefined || content.position === null) {\n                    throw new Error('please enter valid position in ' + content.type + ' content...');\n                }\n                else {\n                    if (content.position.x === undefined || content.position.x === null || typeof content.position.x !== 'number') {\n                        throw new Error('please enter valid x co-ordinate in ' + content.type + ' position...');\n                    }\n                    if (content.position.y === undefined || content.position.y === null || typeof content.position.y !== 'number') {\n                        throw new Error('please enter valid y co-ordinate in ' + content.type + ' position...');\n                    }\n                }\n            }\n        }\n    };\n    /* tslint:disable-next-line:no-any */\n    PdfExport.prototype.drawText = function (pageTemplate, content) {\n        var font = this.getFont(content);\n        var brush = this.getBrushFromContent(content);\n        var pen = null;\n        if (!isNullOrUndefined(content.style.textPenColor)) {\n            var penColor = this.hexToRgb(content.style.textPenColor);\n            pen = new PdfPen(new PdfColor(penColor.r, penColor.g, penColor.b));\n        }\n        if (brush == null && pen == null) {\n            brush = new PdfSolidBrush(new PdfColor(0, 0, 0));\n        }\n        var value = content.value.toString();\n        var x = content.position.x * 0.75;\n        var y = content.position.y * 0.75;\n        var format = new PdfStringFormat();\n        var result = this.setContentFormat(content, format);\n        if (result !== null && !isNullOrUndefined(result.format) && !isNullOrUndefined(result.size)) {\n            pageTemplate.graphics.drawString(value, font, pen, brush, x, y, result.size.width, result.size.height, result.format);\n        }\n        else {\n            pageTemplate.graphics.drawString(value, font, pen, brush, x, y, format);\n        }\n    };\n    /* tslint:disable-next-line:no-any */\n    PdfExport.prototype.drawPageNumber = function (documentHeader, content) {\n        var font = this.getFont(content);\n        var brush = null;\n        if (!isNullOrUndefined(content.style.textBrushColor)) {\n            /* tslint:disable-next-line:max-line-length */\n            var brushColor = this.hexToRgb(content.style.textBrushColor);\n            brush = new PdfSolidBrush(new PdfColor(brushColor.r, brushColor.g, brushColor.b));\n        }\n        else {\n            brush = new PdfSolidBrush(new PdfColor(0, 0, 0));\n        }\n        var pageNumber = new PdfPageNumberField(font, brush);\n        pageNumber.numberStyle = this.getPageNumberStyle(content.pageNumberType);\n        var compositeField;\n        var format;\n        if (!isNullOrUndefined(content.format)) {\n            if (content.format.indexOf('$total') !== -1 && content.format.indexOf('$current') !== -1) {\n                var pageCount = new PdfPageCountField(font);\n                pageCount.numberStyle = this.getPageNumberStyle(content.pageNumberType);\n                if (content.format.indexOf('$total') > content.format.indexOf('$current')) {\n                    format = content.format.replace('$current', '0');\n                    format = format.replace('$total', '1');\n                }\n                else {\n                    format = content.format.replace('$current', '1');\n                    format = format.replace('$total', '0');\n                }\n                compositeField = new PdfCompositeField(font, brush, format, pageNumber, pageCount);\n            }\n            else if (content.format.indexOf('$current') !== -1 && content.format.indexOf('$total') === -1) {\n                format = content.format.replace('$current', '0');\n                compositeField = new PdfCompositeField(font, brush, format, pageNumber);\n            }\n            else {\n                var pageCount = new PdfPageCountField(font);\n                format = content.format.replace('$total', '0');\n                compositeField = new PdfCompositeField(font, brush, format, pageCount);\n            }\n        }\n        else {\n            format = '{0}';\n            compositeField = new PdfCompositeField(font, brush, format, pageNumber);\n        }\n        var x = content.position.x * 0.75;\n        var y = content.position.y * 0.75;\n        var result = this.setContentFormat(content, compositeField.stringFormat);\n        if (result !== null && !isNullOrUndefined(result.format) && !isNullOrUndefined(result.size)) {\n            compositeField.stringFormat = result.format;\n            compositeField.bounds = new RectangleF(x, y, result.size.width, result.size.height);\n        }\n        compositeField.draw(documentHeader.graphics, x, y);\n    };\n    /* tslint:disable-next-line:no-any */\n    PdfExport.prototype.drawImage = function (documentHeader, content) {\n        var x = content.position.x * 0.75;\n        var y = content.position.y * 0.75;\n        var width = (!isNullOrUndefined(content.size)) ? (content.size.width * 0.75) : undefined;\n        var height = (!isNullOrUndefined(content.size)) ? (content.size.height * 0.75) : undefined;\n        var image = new PdfBitmap(content.src);\n        if (!isNullOrUndefined(width)) {\n            documentHeader.graphics.drawImage(image, x, y, width, height);\n        }\n        else {\n            documentHeader.graphics.drawImage(image, x, y);\n        }\n    };\n    /* tslint:disable-next-line:no-any */\n    PdfExport.prototype.drawLine = function (documentHeader, content) {\n        var x1 = content.points.x1 * 0.75;\n        var y1 = content.points.y1 * 0.75;\n        var x2 = content.points.x2 * 0.75;\n        var y2 = content.points.y2 * 0.75;\n        var pen = this.getPenFromContent(content);\n        if (!isNullOrUndefined(content.style) && content.style !== null) {\n            if (!isNullOrUndefined(content.style.penSize) && content.style.penSize !== null && typeof content.style.penSize === 'number') {\n                pen.width = content.style.penSize * 0.75;\n            }\n            pen.dashStyle = this.getDashStyle(content.style.dashStyle);\n        }\n        documentHeader.graphics.drawLine(pen, x1, y1, x2, y2);\n    };\n    /* tslint:disable-next-line:no-any */ /* tslint:disable-next-line:max-line-length */\n    PdfExport.prototype.processAggregates = function (sRows, pdfGrid, border, font, brush, backgroundBrush, isCaption, captionRow, groupIndex, isGroupedFooter) {\n        for (var _i = 0, sRows_1 = sRows; _i < sRows_1.length; _i++) {\n            var row = sRows_1[_i];\n            var startIndex = 0;\n            var leastCaptionSummaryIndex = -1;\n            var index = 0;\n            var isEmpty = true;\n            /* tslint:disable-next-line:no-any */\n            var value = [];\n            for (var i = 0; i < pdfGrid.columns.count; i++) {\n                var cell = row.cells[index];\n                if (cell.cellType === CellType.DetailFooterIntent) {\n                    i--;\n                    index++;\n                    continue;\n                }\n                if (!this.hideColumnInclude) {\n                    while (cell.visible === undefined) {\n                        if (cell.cellType === CellType.DetailFooterIntent) {\n                            continue;\n                        }\n                        if (!isNullOrUndefined(captionRow)) {\n                            if (!isNullOrUndefined(captionRow.cells.getCell(i).value)) {\n                                /* tslint:disable-next-line:max-line-length */\n                                var args = { row: row, type: AggregateTemplateType.GroupCaption, style: captionRow.cells };\n                                this.parent.trigger(events.pdfAggregateQueryCellInfo, args);\n                                value.push('');\n                                value.push(captionRow.cells.getCell(i).value);\n                                isEmpty = false;\n                                if (!isCaption) {\n                                    i += 1;\n                                }\n                            }\n                            else {\n                                value.push('');\n                            }\n                        }\n                        else {\n                            value.push('');\n                        }\n                        i += 1;\n                        index = index + 1;\n                        cell = row.cells[index];\n                    }\n                    while (!isNullOrUndefined(cell.visible) && !cell.visible) {\n                        index = index + 1;\n                        cell = row.cells[index];\n                    }\n                }\n                if (cell.isDataCell) {\n                    var templateFn = {};\n                    /* tslint:disable-next-line:max-line-length */\n                    if (!isNullOrUndefined(cell.column.footerTemplate) || !isNullOrUndefined(cell.column.groupCaptionTemplate) || !isNullOrUndefined(cell.column.groupFooterTemplate)) {\n                        /* tslint:disable-next-line:no-any */\n                        var result = this.getTemplateFunction(templateFn, i, leastCaptionSummaryIndex, cell);\n                        templateFn = result.templateFunction;\n                        leastCaptionSummaryIndex = result.leastCaptionSummaryIndex;\n                        /* tslint:disable-next-line:max-line-length */\n                        var txt = (templateFn[getEnumValue(CellType, cell.cellType)](row.data[cell.column.field ? cell.column.field : cell.column.columnName]));\n                        value.push(txt[0].textContent);\n                        isEmpty = false;\n                    }\n                    else {\n                        /* tslint:disable-next-line:no-any */\n                        var result = this.getSummaryWithoutTemplate(row.data[cell.column.field]);\n                        if (!isNullOrUndefined(result)) {\n                            value.push(result);\n                        }\n                    }\n                }\n                else {\n                    value.push('');\n                }\n                if (isEmpty && value[i] !== '' && !isNullOrUndefined(value[i]) && value[i] !== null) {\n                    isEmpty = false;\n                }\n                index += 1;\n            }\n            if (isCaption) {\n                for (var i = (this.parent.groupSettings.columns.length) + 1; i < value.length - 1; i++) {\n                    value[i] = value[i + 1];\n                }\n            }\n            if (!isEmpty) {\n                if (!isCaption) {\n                    var gridRow = pdfGrid.rows.addRow();\n                    gridRow.style.setBorder(border);\n                    gridRow.style.setFont(font);\n                    gridRow.style.setTextBrush(brush);\n                    gridRow.style.setBackgroundBrush(backgroundBrush);\n                    /* tslint:disable-next-line:max-line-length */\n                    var args = { row: row, type: isGroupedFooter ? AggregateTemplateType.GroupFooter : AggregateTemplateType.Footer, style: gridRow.cells };\n                    this.parent.trigger(events.pdfAggregateQueryCellInfo, args);\n                    for (var i = 0; i < pdfGrid.columns.count; i++) {\n                        gridRow.cells.getCell(i).value = value[i].toString();\n                    }\n                }\n                else {\n                    for (var i = 0; i < pdfGrid.columns.count; i++) {\n                        captionRow.cells.getCell(i).value = value[i].toString();\n                        if (i === (groupIndex + 1) && leastCaptionSummaryIndex !== -1 && leastCaptionSummaryIndex !== 1) {\n                            captionRow.cells.getCell(i).columnSpan = leastCaptionSummaryIndex - (groupIndex + 1);\n                        }\n                        else if (i === (groupIndex + 1) && leastCaptionSummaryIndex === -1) {\n                            captionRow.cells.getCell(i).columnSpan = pdfGrid.columns.count - (groupIndex + 1);\n                        }\n                    }\n                }\n            }\n        }\n    };\n    /* tslint:disable-next-line:no-any */\n    PdfExport.prototype.getTemplateFunction = function (templateFn, index, leastCaptionSummaryIndex, cell) {\n        if (!isNullOrUndefined(cell.column.footerTemplate) && cell.cellType === CellType.Summary) {\n            templateFn[getEnumValue(CellType, CellType.Summary)] = compile(cell.column.footerTemplate);\n        }\n        else if (!isNullOrUndefined(cell.column.groupCaptionTemplate)) {\n            if (leastCaptionSummaryIndex === -1) {\n                leastCaptionSummaryIndex = index;\n            }\n            templateFn[getEnumValue(CellType, CellType.CaptionSummary)] = compile(cell.column.groupCaptionTemplate);\n        }\n        else {\n            templateFn[getEnumValue(CellType, CellType.GroupSummary)] = compile(cell.column.groupFooterTemplate);\n        }\n        return { templateFunction: templateFn, leastCaptionSummaryIndex: leastCaptionSummaryIndex };\n    };\n    /* tslint:disable-next-line:no-any */\n    PdfExport.prototype.getSummaryWithoutTemplate = function (data) {\n        if (!isNullOrUndefined(data.Sum)) {\n            return data.Sum;\n        }\n        else if (!isNullOrUndefined(data.Average)) {\n            return data.Average;\n        }\n        else if (!isNullOrUndefined(data.Max)) {\n            return data.Max;\n        }\n        else if (!isNullOrUndefined(data.Min)) {\n            return data.Min;\n        }\n        else if (!isNullOrUndefined(data.Count)) {\n            return data.Count;\n        }\n        else if (!isNullOrUndefined(data.TrueCount)) {\n            return data.TrueCount;\n        }\n        else if (!isNullOrUndefined(data.FalseCount)) {\n            return data.FalseCount;\n        }\n        else if (!isNullOrUndefined(data.Custom)) {\n            return data.Custom;\n        }\n    };\n    /**\n     * Set alignment, width and type of the values of the column\n     */\n    PdfExport.prototype.setColumnProperties = function (gridColumns, pdfGrid, helper, gObj, allowHorizontalOverflow) {\n        var startIndex = gObj.groupSettings.columns.length;\n        for (var i = 0; i < startIndex; i++) {\n            pdfGrid.columns.getColumn(i).width = 20;\n        }\n        for (var i = 0; i < gridColumns.length; i++) {\n            if (!isNullOrUndefined(gridColumns[i].textAlign)) {\n                pdfGrid.columns.getColumn(i + startIndex).format = this.getHorizontalAlignment(gridColumns[i].textAlign);\n            }\n            // Need to add width consideration with % value\n            if (pdfGrid.style.allowHorizontalOverflow && !isNullOrUndefined(gridColumns[i].width) && allowHorizontalOverflow) {\n                pdfGrid.columns.getColumn(i + startIndex).width = typeof gridColumns[i].width === 'number' ?\n                    gridColumns[i].width * 0.75 : helper.getConvertedWidth(gridColumns[i].width) * 0.75;\n            }\n        }\n    };\n    /**\n     * set default style properties of each rows in exporting grid\n     * @private\n     */\n    PdfExport.prototype.setRecordThemeStyle = function (row, border) {\n        if (!isNullOrUndefined(this.gridTheme) && !isNullOrUndefined(this.gridTheme.record)) {\n            var fontFamily = !isNullOrUndefined(this.gridTheme.record.fontName) ?\n                this.getFontFamily(this.gridTheme.record.fontName) : PdfFontFamily.Helvetica;\n            var fontSize = !isNullOrUndefined(this.gridTheme.record.fontSize) ? this.gridTheme.record.fontSize : 9.75;\n            var fontStyle = this.getFontStyle(this.gridTheme.record);\n            var font = new PdfStandardFont(fontFamily, fontSize, fontStyle);\n            if (!isNullOrUndefined(this.gridTheme.record.font)) {\n                font = this.gridTheme.record.font;\n            }\n            row.style.setFont(font);\n            var pdfColor = new PdfColor();\n            if (!isNullOrUndefined(this.gridTheme.record.fontColor)) {\n                var penBrushColor = this.hexToRgb(this.gridTheme.record.fontColor);\n                pdfColor = new PdfColor(penBrushColor.r, penBrushColor.g, penBrushColor.b);\n            }\n            row.style.setTextBrush(new PdfSolidBrush(pdfColor));\n        }\n        else {\n            row.style.setTextBrush(new PdfSolidBrush(new PdfColor(0, 0, 0)));\n        }\n        var borderRecord = this.gridTheme && this.gridTheme.record &&\n            this.gridTheme.record.border ? this.getBorderStyle(this.gridTheme.record.border) : border;\n        row.style.setBorder(borderRecord);\n        return row;\n    };\n    /**\n     * generate the formatted cell values\n     * @private\n     */\n    PdfExport.prototype.processRecord = function (border, columns, gObj, dataSource, pdfGrid, startIndex, pdfExportProperties, helper, rowIndex) {\n        var rows = helper.getGridRowModel(columns, dataSource, gObj, rowIndex);\n        for (var _i = 0, rows_1 = rows; _i < rows_1.length; _i++) {\n            var row = rows_1[_i];\n            rowIndex++;\n            // create a new row and set default style properties\n            var gridRow = this.setRecordThemeStyle(pdfGrid.rows.addRow(), border);\n            var cellLength = row.cells.length;\n            for (var j = 0; j < cellLength; j++) {\n                var gridCell = row.cells[j];\n                if (gridCell.cellType !== CellType.Data) {\n                    continue;\n                }\n                var column = gridCell.column;\n                var field = column.field;\n                var cellValue = !isNullOrUndefined(field) ? column.valueAccessor(field, row.data, column) : '';\n                var value = !isNullOrUndefined(cellValue) ? cellValue : '';\n                var foreignKeyData = void 0;\n                if (column.isForeignColumn && column.isForeignColumn()) {\n                    foreignKeyData = helper.getFData(value, column);\n                    value = getValue(column.foreignKeyValue, foreignKeyData);\n                }\n                var data = row.data;\n                var cell = gridRow.cells.getCell(j);\n                var args = {\n                    data: data,\n                    value: value,\n                    column: column,\n                    style: undefined,\n                    colSpan: 1,\n                    cell: cell\n                };\n                args.value = this.exportValueFormatter.formatCellValue(args, gObj.isServerRendered);\n                this.parent.trigger(events.pdfQueryCellInfo, args);\n                cell.value = args.value;\n                if (!isNullOrUndefined(args.style)) {\n                    this.processCellStyle(cell, args);\n                }\n                if (args.colSpan > 1) {\n                    if ((j + 1 + args.colSpan) > gridRow.cells.count) {\n                        args.colSpan = gridRow.cells.count - (j + 1);\n                    }\n                    cell.columnSpan = args.colSpan;\n                    for (var i = 1; i < cell.columnSpan; i++) {\n                        var spanCell = gridRow.cells.getCell(j + i);\n                        spanCell.value = '';\n                    }\n                    j += (args.colSpan - 1);\n                }\n            }\n            if (row.isExpand) {\n                var gridRow_1 = this.setRecordThemeStyle(pdfGrid.rows.addRow(), border);\n                var cell = gridRow_1.cells.getCell(startIndex);\n                cell.columnSpan = gridRow_1.cells.count - (startIndex);\n                cell.style.cellPadding = new PdfPaddings(10, 10, 10, 10);\n                gObj.isPrinting = true;\n                var exportType = (!isNullOrUndefined(pdfExportProperties) && pdfExportProperties.exportType) ?\n                    pdfExportProperties.exportType : 'AllPages';\n                var returnValue = this.helper.createChildGrid(gObj, row, exportType, this.gridPool);\n                var childGridObj = returnValue.childGrid;\n                var element = returnValue.element;\n                childGridObj.actionFailure =\n                    helper.failureHandler(this.gridPool, childGridObj, this.globalResolve);\n                var args = { childGrid: childGridObj, row: row, cell: cell, exportProperties: pdfExportProperties };\n                this.parent.trigger(events.exportDetailDataBound, args);\n                childGridObj.beforeDataBound = this.childGridCell(cell, childGridObj, pdfExportProperties);\n                childGridObj.appendTo(element);\n            }\n            this.parent.notify(events.exportRowDataBound, { type: 'pdf', rowObj: row });\n        }\n        return rowIndex;\n    };\n    PdfExport.prototype.childGridCell = function (cell, childGridObj, pdfExportProperties) {\n        var _this = this;\n        return function (result) {\n            childGridObj.beforeDataBound = null;\n            result.cancel = true;\n            cell.value = _this.processGridExport(childGridObj, result, pdfExportProperties);\n            childGridObj.destroy();\n            detach(childGridObj.element);\n            _this.gridPool[childGridObj.id] = true;\n            _this.helper.checkAndExport(_this.gridPool, _this.globalResolve);\n            return cell;\n        };\n    };\n    PdfExport.prototype.processCellStyle = function (cell, args) {\n        if (!isNullOrUndefined(args.style.backgroundColor)) {\n            var backColor = this.hexToRgb(args.style.backgroundColor);\n            cell.style.backgroundBrush = new PdfSolidBrush(new PdfColor(backColor.r, backColor.g, backColor.b));\n        }\n        if (!isNullOrUndefined(args.style.textAlignment)) {\n            cell.style.stringFormat = this.getHorizontalAlignment(args.style.textAlignment);\n        }\n        if (!isNullOrUndefined(args.style.cellPadding)) {\n            cell.style.cellPadding = args.style.cellPadding;\n        }\n        if (!isNullOrUndefined(args.style.verticalAlignment)) {\n            cell.style.stringFormat = this.getVerticalAlignment(args.style.verticalAlignment, cell.style.stringFormat);\n        }\n        if (!isNullOrUndefined(args.style.textBrushColor)) {\n            var textBrushColor = this.hexToRgb(args.style.textBrushColor);\n            cell.style.textBrush = new PdfSolidBrush(new PdfColor(textBrushColor.r, textBrushColor.g, textBrushColor.b));\n        }\n        if (!isNullOrUndefined(args.style.textPenColor)) {\n            var textPenColor = this.hexToRgb(args.style.textPenColor);\n            cell.style.textPen = new PdfPen(new PdfColor(textPenColor.r, textPenColor.g, textPenColor.b));\n        }\n        if (!isNullOrUndefined(args.style.fontFamily) || !isNullOrUndefined(args.style.fontSize) || !isNullOrUndefined(args.style.bold) ||\n            !isNullOrUndefined(args.style.italic) || !isNullOrUndefined(args.style.underline) || !isNullOrUndefined(args.style.strikeout)) {\n            cell.style.font = this.getFont(args);\n        }\n        if (!isNullOrUndefined(args.style.border)) {\n            var border = new PdfBorders();\n            var borderWidth = args.style.border.width;\n            // set border width\n            var width = (!isNullOrUndefined(borderWidth) && typeof borderWidth === 'number') ? (borderWidth * 0.75) : (undefined);\n            // set border color\n            var color = new PdfColor(196, 196, 196);\n            if (!isNullOrUndefined(args.style.border.color)) {\n                var borderColor = this.hexToRgb(args.style.border.color);\n                color = new PdfColor(borderColor.r, borderColor.g, borderColor.b);\n            }\n            var pen = new PdfPen(color, width);\n            // set border dashStyle 'Solid <default>, Dash, Dot, DashDot, DashDotDot'\n            if (!isNullOrUndefined(args.style.border.dashStyle)) {\n                pen.dashStyle = this.getDashStyle(args.style.border.dashStyle);\n            }\n            border.all = pen;\n            cell.style.borders = border;\n        }\n        if (!isNullOrUndefined(args.style.paragraphIndent)) {\n            cell.style.stringFormat = new PdfStringFormat();\n            cell.style.stringFormat.paragraphIndent = args.style.paragraphIndent;\n        }\n    };\n    /**\n     * set text alignment of each columns in exporting grid\n     * @private\n     */\n    PdfExport.prototype.getHorizontalAlignment = function (textAlign, format) {\n        if (format === undefined) {\n            format = new PdfStringFormat();\n        }\n        switch (textAlign) {\n            case 'Right':\n                format.alignment = PdfTextAlignment.Right;\n                break;\n            case 'Center':\n                format.alignment = PdfTextAlignment.Center;\n                break;\n            case 'Justify':\n                format.alignment = PdfTextAlignment.Justify;\n                break;\n            case 'Left':\n                format.alignment = PdfTextAlignment.Left;\n                break;\n        }\n        return format;\n    };\n    /**\n     * set vertical alignment of each columns in exporting grid\n     * @private\n     */\n    PdfExport.prototype.getVerticalAlignment = function (verticalAlign, format, textAlign) {\n        if (format === undefined) {\n            format = new PdfStringFormat();\n            format = this.getHorizontalAlignment(textAlign, format);\n        }\n        switch (verticalAlign) {\n            case 'Bottom':\n                format.lineAlignment = PdfVerticalAlignment.Bottom;\n                break;\n            case 'Middle':\n                format.lineAlignment = PdfVerticalAlignment.Middle;\n                break;\n            case 'Top':\n                format.lineAlignment = PdfVerticalAlignment.Top;\n                break;\n        }\n        return format;\n    };\n    PdfExport.prototype.getFontFamily = function (fontFamily) {\n        switch (fontFamily) {\n            case 'TimesRoman':\n                return 2;\n            case 'Courier':\n                return 1;\n            case 'Symbol':\n                return 3;\n            case 'ZapfDingbats':\n                return 4;\n            default:\n                return 0;\n        }\n    };\n    /* tslint:disable-next-line:no-any */\n    PdfExport.prototype.getFont = function (content) {\n        if (content.font) {\n            return content.font;\n        }\n        var fontSize = (!isNullOrUndefined(content.style.fontSize)) ? (content.style.fontSize * 0.75) : 9.75;\n        var fontFamily = (!isNullOrUndefined(content.style.fontFamily)) ?\n            (this.getFontFamily(content.style.fontFamily)) : PdfFontFamily.TimesRoman;\n        var fontStyle = PdfFontStyle.Regular;\n        if (!isNullOrUndefined(content.style.bold) && content.style.bold) {\n            fontStyle |= PdfFontStyle.Bold;\n        }\n        if (!isNullOrUndefined(content.style.italic) && content.style.italic) {\n            fontStyle |= PdfFontStyle.Italic;\n        }\n        if (!isNullOrUndefined(content.style.underline) && content.style.underline) {\n            fontStyle |= PdfFontStyle.Underline;\n        }\n        if (!isNullOrUndefined(content.style.strikeout) && content.style.strikeout) {\n            fontStyle |= PdfFontStyle.Strikeout;\n        }\n        return new PdfStandardFont(fontFamily, fontSize, fontStyle);\n    };\n    PdfExport.prototype.getPageNumberStyle = function (pageNumberType) {\n        switch (pageNumberType) {\n            case 'LowerLatin':\n                return 2;\n            case 'LowerRoman':\n                return 3;\n            case 'UpperLatin':\n                return 4;\n            case 'UpperRoman':\n                return 5;\n            default:\n                return 1;\n        }\n    };\n    PdfExport.prototype.setContentFormat = function (content, format) {\n        if (!isNullOrUndefined(content.size)) {\n            var width = content.size.width * 0.75;\n            var height = content.size.height * 0.75;\n            format = new PdfStringFormat(PdfTextAlignment.Left, PdfVerticalAlignment.Middle);\n            if (!isNullOrUndefined(content.style.hAlign)) {\n                switch (content.style.hAlign) {\n                    case 'Right':\n                        format.alignment = PdfTextAlignment.Right;\n                        break;\n                    case 'Center':\n                        format.alignment = PdfTextAlignment.Center;\n                        break;\n                    case 'Justify':\n                        format.alignment = PdfTextAlignment.Justify;\n                        break;\n                    default:\n                        format.alignment = PdfTextAlignment.Left;\n                }\n            }\n            if (!isNullOrUndefined(content.style.vAlign)) {\n                format = this.getVerticalAlignment(content.style.vAlign, format);\n            }\n            return { format: format, size: new SizeF(width, height) };\n        }\n        return null;\n    };\n    PdfExport.prototype.getPageSize = function (pageSize) {\n        switch (pageSize) {\n            case 'Letter':\n                return new SizeF(612, 792);\n            case 'Note':\n                return new SizeF(540, 720);\n            case 'Legal':\n                return new SizeF(612, 1008);\n            case 'A0':\n                return new SizeF(2380, 3368);\n            case 'A1':\n                return new SizeF(1684, 2380);\n            case 'A2':\n                return new SizeF(1190, 1684);\n            case 'A3':\n                return new SizeF(842, 1190);\n            case 'A5':\n                return new SizeF(421, 595);\n            case 'A6':\n                return new SizeF(297, 421);\n            case 'A7':\n                return new SizeF(210, 297);\n            case 'A8':\n                return new SizeF(148, 210);\n            case 'A9':\n                return new SizeF(105, 148);\n            // case 'A10':\n            //     return new SizeF(74, 105);\n            case 'B0':\n                return new SizeF(2836, 4008);\n            case 'B1':\n                return new SizeF(2004, 2836);\n            case 'B2':\n                return new SizeF(1418, 2004);\n            case 'B3':\n                return new SizeF(1002, 1418);\n            case 'B4':\n                return new SizeF(709, 1002);\n            case 'B5':\n                return new SizeF(501, 709);\n            case 'Archa':\n                return new SizeF(648, 864);\n            case 'Archb':\n                return new SizeF(864, 1296);\n            case 'Archc':\n                return new SizeF(1296, 1728);\n            case 'Archd':\n                return new SizeF(1728, 2592);\n            case 'Arche':\n                return new SizeF(2592, 3456);\n            case 'Flsa':\n                return new SizeF(612, 936);\n            case 'HalfLetter':\n                return new SizeF(396, 612);\n            case 'Letter11x17':\n                return new SizeF(792, 1224);\n            case 'Ledger':\n                return new SizeF(1224, 792);\n            default:\n                return new SizeF(595, 842);\n        }\n    };\n    PdfExport.prototype.getDashStyle = function (dashStyle) {\n        switch (dashStyle) {\n            case 'Dash':\n                return 1;\n            case 'Dot':\n                return 2;\n            case 'DashDot':\n                return 3;\n            case 'DashDotDot':\n                return 4;\n            default:\n                return 0;\n        }\n    };\n    PdfExport.prototype.getPenFromContent = function (content) {\n        var pen = new PdfPen(new PdfColor(0, 0, 0));\n        if (!isNullOrUndefined(content.style) && content.style !== null && !isNullOrUndefined(content.style.penColor)) {\n            var penColor = this.hexToRgb(content.style.penColor);\n            pen = new PdfPen(new PdfColor(penColor.r, penColor.g, penColor.b));\n        }\n        return pen;\n    };\n    PdfExport.prototype.getBrushFromContent = function (content) {\n        var brush = null;\n        if (!isNullOrUndefined(content.style.textBrushColor)) {\n            /* tslint:disable-next-line:max-line-length */\n            var brushColor = this.hexToRgb(content.style.textBrushColor);\n            brush = new PdfSolidBrush(new PdfColor(brushColor.r, brushColor.g, brushColor.b));\n        }\n        return brush;\n    };\n    PdfExport.prototype.hexToRgb = function (hex) {\n        if (hex === null || hex === '' || hex.length !== 7) {\n            throw new Error('please set valid hex value for color...');\n        }\n        hex = hex.substring(1);\n        var bigint = parseInt(hex, 16);\n        var r = (bigint >> 16) & 255;\n        var g = (bigint >> 8) & 255;\n        var b = bigint & 255;\n        return { r: r, g: g, b: b };\n    };\n    PdfExport.prototype.getFontStyle = function (theme) {\n        var fontStyle = PdfFontStyle.Regular;\n        if (!isNullOrUndefined(theme) && theme.bold) {\n            fontStyle |= PdfFontStyle.Bold;\n        }\n        if (!isNullOrUndefined(theme) && theme.italic) {\n            fontStyle |= PdfFontStyle.Italic;\n        }\n        if (!isNullOrUndefined(theme) && theme.underline) {\n            fontStyle |= PdfFontStyle.Underline;\n        }\n        if (!isNullOrUndefined(theme) && theme.strikeout) {\n            fontStyle |= PdfFontStyle.Strikeout;\n        }\n        return fontStyle;\n    };\n    PdfExport.prototype.getBorderStyle = function (border) {\n        var borders = new PdfBorders();\n        if (!isNullOrUndefined(border)) {\n            var borderWidth = border.width;\n            // set border width\n            var width = (!isNullOrUndefined(borderWidth) && typeof borderWidth === 'number') ? borderWidth * 0.75 : undefined;\n            // set border color\n            var color = new PdfColor(196, 196, 196);\n            if (!isNullOrUndefined(border.color)) {\n                var borderColor = this.hexToRgb(border.color);\n                color = new PdfColor(borderColor.r, borderColor.g, borderColor.b);\n            }\n            var pen = new PdfPen(color, width);\n            // set border dashStyle 'Solid <default>, Dash, Dot, DashDot, DashDotDot'\n            if (!isNullOrUndefined(border.dashStyle)) {\n                pen.dashStyle = this.getDashStyle(border.dashStyle);\n            }\n            borders.all = pen;\n        }\n        else {\n            borders.all = new PdfPen(new PdfColor(234, 234, 234));\n        }\n        return borders;\n    };\n    /**\n     * To destroy the pdf export\n     * @return{void}\n     * @hidden\n     */\n    PdfExport.prototype.destroy = function () {\n        //destroy for exporting\n    };\n    return PdfExport;\n}());\nexport { PdfExport };\n"]},"metadata":{},"sourceType":"module"}