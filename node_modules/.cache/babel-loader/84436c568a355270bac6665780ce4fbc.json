{"ast":null,"code":"import { isNullOrUndefined, closest, extend, updateBlazorTemplate } from '@syncfusion/ej2-base';\nimport { InlineEditRender } from './inline-edit-renderer';\nimport { BatchEditRender } from './batch-edit-renderer';\nimport { DialogEditRender } from './dialog-edit-renderer';\nimport { attributes, classList, isBlazor } from '@syncfusion/ej2-base';\nimport { CellType } from '../base/enum';\nimport { RowModelGenerator } from '../services/row-model-generator';\nimport { getComplexFieldID, getObject, appendChildren, parentsUntil } from '../base/util';\nimport * as events from '../base/constant';\n/**\n * Edit render module is used to render grid edit row.\n * @hidden\n */\n\nvar EditRender =\n/** @class */\nfunction () {\n  /**\n   * Constructor for render module\n   */\n  function EditRender(parent, serviceLocator) {\n    //Internal variables               \n    this.editType = {\n      'Inline': InlineEditRender,\n      'Normal': InlineEditRender,\n      'Batch': BatchEditRender,\n      'Dialog': DialogEditRender\n    };\n    this.parent = parent;\n    this.serviceLocator = serviceLocator;\n    this.renderer = new this.editType[this.parent.editSettings.mode](parent, serviceLocator);\n    this.focus = serviceLocator.getService('focus');\n  }\n\n  EditRender.prototype.addNew = function (args) {\n    this.renderer.addNew(this.getEditElements(args), args);\n    this.convertWidget(args);\n  };\n\n  EditRender.prototype.update = function (args) {\n    this.renderer.update(this.getEditElements(args), args);\n    this.parent.notify(events.beforeStartEdit, args);\n    this.convertWidget(args);\n  };\n\n  EditRender.prototype.convertWidget = function (args) {\n    var gObj = this.parent;\n    var isFocused;\n    var cell;\n    var value;\n    var fForm;\n    var frzCols = gObj.getFrozenColumns();\n    var form = gObj.editSettings.mode === 'Dialog' ? document.querySelector('#' + gObj.element.id + '_dialogEdit_wrapper').querySelector('.e-gridform') : gObj.element.querySelector('.e-gridform');\n\n    if (frzCols && gObj.editSettings.mode === 'Normal') {\n      var rowIndex = parseInt(args.row.getAttribute('aria-rowindex'), 10);\n\n      if (gObj.frozenRows && (args.requestType === 'add' && gObj.editSettings.newRowPosition === 'Top' || rowIndex < gObj.frozenRows)) {\n        fForm = gObj.element.querySelector('.e-movableheader').querySelector('.e-gridform');\n      } else {\n        fForm = gObj.element.querySelector('.e-movablecontent').querySelector('.e-gridform');\n      }\n    }\n\n    var cols = gObj.editSettings.mode !== 'Batch' ? gObj.getColumns() : [gObj.getColumnByField(args.columnName)];\n\n    for (var _i = 0, cols_1 = cols; _i < cols_1.length; _i++) {\n      var col = cols_1[_i];\n\n      if (this.parent.editSettings.template && !isNullOrUndefined(col.field)) {\n        var cellArgs = extend({}, args);\n        cellArgs.element = form.querySelector('[name=' + getComplexFieldID(col.field) + ']');\n\n        if (isNullOrUndefined(cellArgs.element) && frzCols) {\n          cellArgs.element = fForm.querySelector('[name=' + getComplexFieldID(col.field) + ']');\n        }\n\n        if (typeof col.edit.write === 'string') {\n          getObject(col.edit.write, window)(cellArgs);\n        } else {\n          col.edit.write(cellArgs);\n        }\n\n        continue;\n      }\n\n      if (this.parent.editModule.checkColumnIsGrouped(col) || col.commands) {\n        continue;\n      }\n\n      value = col.valueAccessor(col.field, args.rowData, col);\n\n      if (frzCols && cols.indexOf(col) >= frzCols && gObj.editSettings.mode === 'Normal') {\n        cell = fForm.querySelector('[e-mappinguid=' + col.uid + ']');\n      } else {\n        cell = form.querySelector('[e-mappinguid=' + col.uid + ']');\n      }\n\n      var temp = col.edit.write;\n\n      if (!isNullOrUndefined(cell)) {\n        if (typeof temp === 'string') {\n          temp = getObject(temp, window);\n          temp({\n            rowData: args.rowData,\n            element: cell,\n            column: col,\n            requestType: args.requestType,\n            row: args.row,\n            foreignKeyData: col.isForeignColumn() && getObject(col.field, args.foreignKeyData)\n          });\n        } else {\n          col.edit.write({\n            rowData: args.rowData,\n            element: cell,\n            column: col,\n            requestType: args.requestType,\n            row: args.row,\n            foreignKeyData: col.isForeignColumn() && getObject(col.field, args.foreignKeyData)\n          });\n        }\n\n        if (!isFocused && !cell.getAttribute('disabled')) {\n          this.focusElement(cell, args.type);\n          isFocused = true;\n        }\n      }\n    }\n\n    if (frzCols !== 0 && !this.parent.allowTextWrap && (args.requestType === 'add' || args.requestType === 'beginEdit') && this.parent.editSettings.mode !== 'Dialog' && !isNullOrUndefined(form) && !isNullOrUndefined(fForm)) {\n      var mTdElement = fForm.querySelector('tr').children[0];\n      var fTdElement = form.querySelector('tr').children[0];\n\n      if (fTdElement.offsetHeight > mTdElement.offsetHeight) {\n        mTdElement.style.height = fTdElement.offsetHeight + 'px';\n      } else {\n        fTdElement.style.height = mTdElement.offsetHeight + 'px';\n      }\n    }\n  };\n\n  EditRender.prototype.focusElement = function (elem, type) {\n    var chkBox = this.parent.element.querySelector('.e-edit-checkselect');\n\n    if (!isNullOrUndefined(chkBox)) {\n      chkBox.nextElementSibling.classList.add('e-focus');\n    }\n\n    if (this.parent.editSettings.mode === 'Batch') {\n      this.focus.onClick({\n        target: closest(elem, 'td')\n      }, true);\n    } else {\n      var isFocus = this.parent.enableVirtualization && this.parent.editSettings.mode === 'Normal' ? false : true;\n\n      if (isFocus || this.parent.enableVirtualization && this.parent.editSettings.newRowPosition === 'Bottom' && parentsUntil(elem, 'e-addedrow')) {\n        elem.focus();\n      } else {\n        // tslint:disable-next-line:no-any\n        elem.focus({\n          preventScroll: true\n        });\n      }\n    }\n\n    if (elem.classList.contains('e-defaultcell')) {\n      elem.setSelectionRange(elem.value.length, elem.value.length);\n    }\n  };\n\n  EditRender.prototype.getEditElements = function (args) {\n    var _this = this;\n\n    var gObj = this.parent;\n    var elements = {};\n    var cols = gObj.editSettings.mode !== 'Batch' ? gObj.getColumns() : [gObj.getColumnByField(args.columnName)];\n\n    if (this.parent.editSettings.template) {\n      return {};\n    }\n\n    var _loop_1 = function (i, len) {\n      var col = cols[i];\n\n      if (this_1.parent.editModule.checkColumnIsGrouped(col)) {\n        return \"continue\";\n      }\n\n      if (col.commands || col.commandsTemplate) {\n        var cells = void 0;\n        var cellRendererFact = this_1.serviceLocator.getService('cellRendererFactory');\n        var model = new RowModelGenerator(this_1.parent);\n        var cellRenderer = cellRendererFact.getCellRenderer(CellType.CommandColumn);\n        cells = model.generateRows(args.rowData)[0].cells;\n        var cell = cells.filter(function (cell) {\n          return cell.rowID;\n        });\n        var td = cellRenderer.render(cell[i], args.rowData, {\n          'index': args.row ? args.row.getAttribute('aria-rowindex') : 0\n        });\n        var div = td.firstElementChild;\n        div.setAttribute('textAlign', td.getAttribute('textAlign'));\n        elements[col.uid] = div;\n        return \"continue\";\n      }\n\n      var value = col.valueAccessor(col.field, args.rowData, col);\n      var tArgs = {\n        column: col,\n        value: value,\n        type: args.requestType,\n        data: args.rowData\n      };\n      var temp = col.edit.create;\n      var input;\n\n      if (col.editTemplate) {\n        input = this_1.parent.createElement('span', {\n          attrs: {\n            'e-mappinguid': col.uid\n          }\n        });\n        var tempID = this_1.parent.element.id + col.uid + 'editTemplate';\n        var tempData = extend({}, {}, args.rowData, true);\n        var template_1 = col.getEditTemplate()(tempData, this_1.parent, 'editTemplate', tempID);\n        /* tslint:disable-next-line:no-any */\n\n        this_1.parent.isReact && this_1.parent.editSettings.mode === 'Batch' ? setTimeout(function () {\n          appendChildren(input, template_1);\n        }) : appendChildren(input, template_1);\n\n        if (isBlazor()) {\n          var setRules = function (ruleColumn) {\n            var column = ruleColumn;\n\n            var func = function () {\n              _this.parent.editModule.formObj.rules[column.field] = column.validationRules;\n            };\n\n            return func;\n          };\n\n          updateBlazorTemplate(tempID, 'EditTemplate', col, true, setRules(col));\n        }\n      } else {\n        if (typeof temp === 'string') {\n          temp = getObject(temp, window);\n          input = temp(tArgs);\n        } else {\n          input = col.edit.create(tArgs);\n        }\n\n        if (typeof input === 'string') {\n          var div = this_1.parent.createElement('div');\n          div.innerHTML = input;\n          input = div.firstChild;\n        }\n\n        var isInput = input.tagName !== 'input' && input.querySelectorAll('input').length;\n        var complexFieldName = getComplexFieldID(col.field);\n        attributes(isInput ? input.querySelector('input') : input, {\n          name: complexFieldName,\n          'e-mappinguid': col.uid,\n          id: gObj.element.id + complexFieldName\n        });\n        classList(input, ['e-input', 'e-field'], []);\n\n        if (col.textAlign === 'Right') {\n          input.classList.add('e-ralign');\n        }\n\n        if ((col.isPrimaryKey || col.isIdentity) && args.requestType === 'beginEdit' || col.isIdentity && args.requestType === 'add') {\n          // already disabled in cell plugins\n          input.setAttribute('disabled', '');\n        }\n      }\n\n      elements[col.uid] = input;\n    };\n\n    var this_1 = this;\n\n    for (var i = 0, len = cols.length; i < len; i++) {\n      _loop_1(i, len);\n    }\n\n    return elements;\n  };\n\n  EditRender.prototype.destroy = function () {\n    this.renderer.removeEventListener();\n  };\n\n  return EditRender;\n}();\n\nexport { EditRender };","map":{"version":3,"sources":["/home/nikhil/Desktop/data_grid_editor-master/node_modules/@syncfusion/ej2-grids/src/grid/renderer/edit-renderer.js"],"names":["isNullOrUndefined","closest","extend","updateBlazorTemplate","InlineEditRender","BatchEditRender","DialogEditRender","attributes","classList","isBlazor","CellType","RowModelGenerator","getComplexFieldID","getObject","appendChildren","parentsUntil","events","EditRender","parent","serviceLocator","editType","renderer","editSettings","mode","focus","getService","prototype","addNew","args","getEditElements","convertWidget","update","notify","beforeStartEdit","gObj","isFocused","cell","value","fForm","frzCols","getFrozenColumns","form","document","querySelector","element","id","rowIndex","parseInt","row","getAttribute","frozenRows","requestType","newRowPosition","cols","getColumns","getColumnByField","columnName","_i","cols_1","length","col","template","field","cellArgs","edit","write","window","editModule","checkColumnIsGrouped","commands","valueAccessor","rowData","indexOf","uid","temp","column","foreignKeyData","isForeignColumn","focusElement","type","allowTextWrap","mTdElement","children","fTdElement","offsetHeight","style","height","elem","chkBox","nextElementSibling","add","onClick","target","isFocus","enableVirtualization","preventScroll","contains","setSelectionRange","_this","elements","_loop_1","i","len","this_1","commandsTemplate","cells","cellRendererFact","model","cellRenderer","getCellRenderer","CommandColumn","generateRows","filter","rowID","td","render","div","firstElementChild","setAttribute","tArgs","data","create","input","editTemplate","createElement","attrs","tempID","tempData","template_1","getEditTemplate","isReact","setTimeout","setRules","ruleColumn","func","formObj","rules","validationRules","innerHTML","firstChild","isInput","tagName","querySelectorAll","complexFieldName","name","textAlign","isPrimaryKey","isIdentity","destroy","removeEventListener"],"mappings":"AAAA,SAASA,iBAAT,EAA4BC,OAA5B,EAAqCC,MAArC,EAA6CC,oBAA7C,QAAyE,sBAAzE;AACA,SAASC,gBAAT,QAAiC,wBAAjC;AACA,SAASC,eAAT,QAAgC,uBAAhC;AACA,SAASC,gBAAT,QAAiC,wBAAjC;AACA,SAASC,UAAT,EAAqBC,SAArB,EAAgCC,QAAhC,QAAgD,sBAAhD;AACA,SAASC,QAAT,QAAyB,cAAzB;AACA,SAASC,iBAAT,QAAkC,iCAAlC;AACA,SAASC,iBAAT,EAA4BC,SAA5B,EAAuCC,cAAvC,EAAuDC,YAAvD,QAA2E,cAA3E;AACA,OAAO,KAAKC,MAAZ,MAAwB,kBAAxB;AACA;;;;;AAIA,IAAIC,UAAU;AAAG;AAAe,YAAY;AACxC;;;AAGA,WAASA,UAAT,CAAoBC,MAApB,EAA4BC,cAA5B,EAA4C;AACxC;AACA,SAAKC,QAAL,GAAgB;AACZ,gBAAUhB,gBADE;AAEZ,gBAAUA,gBAFE;AAEgB,eAASC,eAFzB;AAE0C,gBAAUC;AAFpD,KAAhB;AAIA,SAAKY,MAAL,GAAcA,MAAd;AACA,SAAKC,cAAL,GAAsBA,cAAtB;AACA,SAAKE,QAAL,GAAgB,IAAI,KAAKD,QAAL,CAAc,KAAKF,MAAL,CAAYI,YAAZ,CAAyBC,IAAvC,CAAJ,CAAiDL,MAAjD,EAAyDC,cAAzD,CAAhB;AACA,SAAKK,KAAL,GAAaL,cAAc,CAACM,UAAf,CAA0B,OAA1B,CAAb;AACH;;AACDR,EAAAA,UAAU,CAACS,SAAX,CAAqBC,MAArB,GAA8B,UAAUC,IAAV,EAAgB;AAC1C,SAAKP,QAAL,CAAcM,MAAd,CAAqB,KAAKE,eAAL,CAAqBD,IAArB,CAArB,EAAiDA,IAAjD;AACA,SAAKE,aAAL,CAAmBF,IAAnB;AACH,GAHD;;AAIAX,EAAAA,UAAU,CAACS,SAAX,CAAqBK,MAArB,GAA8B,UAAUH,IAAV,EAAgB;AAC1C,SAAKP,QAAL,CAAcU,MAAd,CAAqB,KAAKF,eAAL,CAAqBD,IAArB,CAArB,EAAiDA,IAAjD;AACA,SAAKV,MAAL,CAAYc,MAAZ,CAAmBhB,MAAM,CAACiB,eAA1B,EAA2CL,IAA3C;AACA,SAAKE,aAAL,CAAmBF,IAAnB;AACH,GAJD;;AAKAX,EAAAA,UAAU,CAACS,SAAX,CAAqBI,aAArB,GAAqC,UAAUF,IAAV,EAAgB;AACjD,QAAIM,IAAI,GAAG,KAAKhB,MAAhB;AACA,QAAIiB,SAAJ;AACA,QAAIC,IAAJ;AACA,QAAIC,KAAJ;AACA,QAAIC,KAAJ;AACA,QAAIC,OAAO,GAAGL,IAAI,CAACM,gBAAL,EAAd;AACA,QAAIC,IAAI,GAAGP,IAAI,CAACZ,YAAL,CAAkBC,IAAlB,KAA2B,QAA3B,GACPmB,QAAQ,CAACC,aAAT,CAAuB,MAAMT,IAAI,CAACU,OAAL,CAAaC,EAAnB,GAAwB,qBAA/C,EAAsEF,aAAtE,CAAoF,aAApF,CADO,GAEPT,IAAI,CAACU,OAAL,CAAaD,aAAb,CAA2B,aAA3B,CAFJ;;AAGA,QAAIJ,OAAO,IAAIL,IAAI,CAACZ,YAAL,CAAkBC,IAAlB,KAA2B,QAA1C,EAAoD;AAChD,UAAIuB,QAAQ,GAAGC,QAAQ,CAACnB,IAAI,CAACoB,GAAL,CAASC,YAAT,CAAsB,eAAtB,CAAD,EAAyC,EAAzC,CAAvB;;AACA,UAAIf,IAAI,CAACgB,UAAL,KAAqBtB,IAAI,CAACuB,WAAL,KAAqB,KAArB,IAA8BjB,IAAI,CAACZ,YAAL,CAAkB8B,cAAlB,KAAqC,KAApE,IACjBN,QAAQ,GAAGZ,IAAI,CAACgB,UADnB,CAAJ,EACoC;AAChCZ,QAAAA,KAAK,GAAGJ,IAAI,CAACU,OAAL,CAAaD,aAAb,CAA2B,kBAA3B,EAA+CA,aAA/C,CAA6D,aAA7D,CAAR;AACH,OAHD,MAIK;AACDL,QAAAA,KAAK,GAAGJ,IAAI,CAACU,OAAL,CAAaD,aAAb,CAA2B,mBAA3B,EAAgDA,aAAhD,CAA8D,aAA9D,CAAR;AACH;AACJ;;AACD,QAAIU,IAAI,GAAGnB,IAAI,CAACZ,YAAL,CAAkBC,IAAlB,KAA2B,OAA3B,GAAqCW,IAAI,CAACoB,UAAL,EAArC,GAAyD,CAACpB,IAAI,CAACqB,gBAAL,CAAsB3B,IAAI,CAAC4B,UAA3B,CAAD,CAApE;;AACA,SAAK,IAAIC,EAAE,GAAG,CAAT,EAAYC,MAAM,GAAGL,IAA1B,EAAgCI,EAAE,GAAGC,MAAM,CAACC,MAA5C,EAAoDF,EAAE,EAAtD,EAA0D;AACtD,UAAIG,GAAG,GAAGF,MAAM,CAACD,EAAD,CAAhB;;AACA,UAAI,KAAKvC,MAAL,CAAYI,YAAZ,CAAyBuC,QAAzB,IAAqC,CAAC7D,iBAAiB,CAAC4D,GAAG,CAACE,KAAL,CAA3D,EAAwE;AACpE,YAAIC,QAAQ,GAAG7D,MAAM,CAAC,EAAD,EAAK0B,IAAL,CAArB;AACAmC,QAAAA,QAAQ,CAACnB,OAAT,GAAmBH,IAAI,CAACE,aAAL,CAAmB,WAAW/B,iBAAiB,CAACgD,GAAG,CAACE,KAAL,CAA5B,GAA0C,GAA7D,CAAnB;;AACA,YAAI9D,iBAAiB,CAAC+D,QAAQ,CAACnB,OAAV,CAAjB,IAAuCL,OAA3C,EAAoD;AAChDwB,UAAAA,QAAQ,CAACnB,OAAT,GAAmBN,KAAK,CAACK,aAAN,CAAoB,WAAW/B,iBAAiB,CAACgD,GAAG,CAACE,KAAL,CAA5B,GAA0C,GAA9D,CAAnB;AACH;;AACD,YAAI,OAAOF,GAAG,CAACI,IAAJ,CAASC,KAAhB,KAA0B,QAA9B,EAAwC;AACpCpD,UAAAA,SAAS,CAAC+C,GAAG,CAACI,IAAJ,CAASC,KAAV,EAAiBC,MAAjB,CAAT,CAAkCH,QAAlC;AACH,SAFD,MAGK;AACDH,UAAAA,GAAG,CAACI,IAAJ,CAASC,KAAT,CAAeF,QAAf;AACH;;AACD;AACH;;AACD,UAAI,KAAK7C,MAAL,CAAYiD,UAAZ,CAAuBC,oBAAvB,CAA4CR,GAA5C,KAAoDA,GAAG,CAACS,QAA5D,EAAsE;AAClE;AACH;;AACDhC,MAAAA,KAAK,GAAIuB,GAAG,CAACU,aAAJ,CAAkBV,GAAG,CAACE,KAAtB,EAA6BlC,IAAI,CAAC2C,OAAlC,EAA2CX,GAA3C,CAAT;;AACA,UAAIrB,OAAO,IAAIc,IAAI,CAACmB,OAAL,CAAaZ,GAAb,KAAqBrB,OAAhC,IAA2CL,IAAI,CAACZ,YAAL,CAAkBC,IAAlB,KAA2B,QAA1E,EAAoF;AAChFa,QAAAA,IAAI,GAAGE,KAAK,CAACK,aAAN,CAAoB,mBAAmBiB,GAAG,CAACa,GAAvB,GAA6B,GAAjD,CAAP;AACH,OAFD,MAGK;AACDrC,QAAAA,IAAI,GAAGK,IAAI,CAACE,aAAL,CAAmB,mBAAmBiB,GAAG,CAACa,GAAvB,GAA6B,GAAhD,CAAP;AACH;;AACD,UAAIC,IAAI,GAAGd,GAAG,CAACI,IAAJ,CAASC,KAApB;;AACA,UAAI,CAACjE,iBAAiB,CAACoC,IAAD,CAAtB,EAA8B;AAC1B,YAAI,OAAOsC,IAAP,KAAgB,QAApB,EAA8B;AAC1BA,UAAAA,IAAI,GAAG7D,SAAS,CAAC6D,IAAD,EAAOR,MAAP,CAAhB;AACAQ,UAAAA,IAAI,CAAC;AACDH,YAAAA,OAAO,EAAE3C,IAAI,CAAC2C,OADb;AACsB3B,YAAAA,OAAO,EAAER,IAD/B;AACqCuC,YAAAA,MAAM,EAAEf,GAD7C;AACkDT,YAAAA,WAAW,EAAEvB,IAAI,CAACuB,WADpE;AACiFH,YAAAA,GAAG,EAAEpB,IAAI,CAACoB,GAD3F;AAED4B,YAAAA,cAAc,EAAEhB,GAAG,CAACiB,eAAJ,MAAyBhE,SAAS,CAAC+C,GAAG,CAACE,KAAL,EAAYlC,IAAI,CAACgD,cAAjB;AAFjD,WAAD,CAAJ;AAIH,SAND,MAOK;AACDhB,UAAAA,GAAG,CAACI,IAAJ,CAASC,KAAT,CAAe;AACXM,YAAAA,OAAO,EAAE3C,IAAI,CAAC2C,OADH;AACY3B,YAAAA,OAAO,EAAER,IADrB;AAC2BuC,YAAAA,MAAM,EAAEf,GADnC;AACwCT,YAAAA,WAAW,EAAEvB,IAAI,CAACuB,WAD1D;AACuEH,YAAAA,GAAG,EAAEpB,IAAI,CAACoB,GADjF;AAEX4B,YAAAA,cAAc,EAAEhB,GAAG,CAACiB,eAAJ,MAAyBhE,SAAS,CAAC+C,GAAG,CAACE,KAAL,EAAYlC,IAAI,CAACgD,cAAjB;AAFvC,WAAf;AAIH;;AACD,YAAI,CAACzC,SAAD,IAAc,CAACC,IAAI,CAACa,YAAL,CAAkB,UAAlB,CAAnB,EAAkD;AAC9C,eAAK6B,YAAL,CAAkB1C,IAAlB,EAAwBR,IAAI,CAACmD,IAA7B;AACA5C,UAAAA,SAAS,GAAG,IAAZ;AACH;AACJ;AACJ;;AACD,QAAII,OAAO,KAAK,CAAZ,IAAiB,CAAC,KAAKrB,MAAL,CAAY8D,aAA9B,KAAiDpD,IAAI,CAACuB,WAAL,KAAqB,KAAtB,IAAgCvB,IAAI,CAACuB,WAAL,KAAqB,WAArG,KACG,KAAKjC,MAAL,CAAYI,YAAZ,CAAyBC,IAAzB,KAAkC,QADrC,IACiD,CAACvB,iBAAiB,CAACyC,IAAD,CADnE,IAC6E,CAACzC,iBAAiB,CAACsC,KAAD,CADnG,EAC4G;AACxG,UAAI2C,UAAU,GAAI3C,KAAK,CAACK,aAAN,CAAoB,IAApB,EAA0BuC,QAA1B,CAAmC,CAAnC,CAAlB;AACA,UAAIC,UAAU,GAAI1C,IAAI,CAACE,aAAL,CAAmB,IAAnB,EAAyBuC,QAAzB,CAAkC,CAAlC,CAAlB;;AACA,UAAIC,UAAU,CAACC,YAAX,GAA0BH,UAAU,CAACG,YAAzC,EAAuD;AACnDH,QAAAA,UAAU,CAACI,KAAX,CAAiBC,MAAjB,GAA0BH,UAAU,CAACC,YAAX,GAA0B,IAApD;AACH,OAFD,MAGK;AACDD,QAAAA,UAAU,CAACE,KAAX,CAAiBC,MAAjB,GAA0BL,UAAU,CAACG,YAAX,GAA0B,IAApD;AACH;AACJ;AACJ,GA/ED;;AAgFAnE,EAAAA,UAAU,CAACS,SAAX,CAAqBoD,YAArB,GAAoC,UAAUS,IAAV,EAAgBR,IAAhB,EAAsB;AACtD,QAAIS,MAAM,GAAG,KAAKtE,MAAL,CAAY0B,OAAZ,CAAoBD,aAApB,CAAkC,qBAAlC,CAAb;;AACA,QAAI,CAAC3C,iBAAiB,CAACwF,MAAD,CAAtB,EAAgC;AAC5BA,MAAAA,MAAM,CAACC,kBAAP,CAA0BjF,SAA1B,CAAoCkF,GAApC,CAAwC,SAAxC;AACH;;AACD,QAAI,KAAKxE,MAAL,CAAYI,YAAZ,CAAyBC,IAAzB,KAAkC,OAAtC,EAA+C;AAC3C,WAAKC,KAAL,CAAWmE,OAAX,CAAmB;AAAEC,QAAAA,MAAM,EAAE3F,OAAO,CAACsF,IAAD,EAAO,IAAP;AAAjB,OAAnB,EAAoD,IAApD;AACH,KAFD,MAGK;AACD,UAAIM,OAAO,GAAG,KAAK3E,MAAL,CAAY4E,oBAAZ,IAAoC,KAAK5E,MAAL,CAAYI,YAAZ,CAAyBC,IAAzB,KAAkC,QAAtE,GAAiF,KAAjF,GAAyF,IAAvG;;AACA,UAAIsE,OAAO,IAAK,KAAK3E,MAAL,CAAY4E,oBAAZ,IAAoC,KAAK5E,MAAL,CAAYI,YAAZ,CAAyB8B,cAAzB,KAA4C,QAAhF,IACTrC,YAAY,CAACwE,IAAD,EAAO,YAAP,CADnB,EAC0C;AACtCA,QAAAA,IAAI,CAAC/D,KAAL;AACH,OAHD,MAIK;AACD;AACA+D,QAAAA,IAAI,CAAC/D,KAAL,CAAW;AAAEuE,UAAAA,aAAa,EAAE;AAAjB,SAAX;AACH;AACJ;;AACD,QAAIR,IAAI,CAAC/E,SAAL,CAAewF,QAAf,CAAwB,eAAxB,CAAJ,EAA8C;AAC1CT,MAAAA,IAAI,CAACU,iBAAL,CAAuBV,IAAI,CAAClD,KAAL,CAAWsB,MAAlC,EAA0C4B,IAAI,CAAClD,KAAL,CAAWsB,MAArD;AACH;AACJ,GAtBD;;AAuBA1C,EAAAA,UAAU,CAACS,SAAX,CAAqBG,eAArB,GAAuC,UAAUD,IAAV,EAAgB;AACnD,QAAIsE,KAAK,GAAG,IAAZ;;AACA,QAAIhE,IAAI,GAAG,KAAKhB,MAAhB;AACA,QAAIiF,QAAQ,GAAG,EAAf;AACA,QAAI9C,IAAI,GAAGnB,IAAI,CAACZ,YAAL,CAAkBC,IAAlB,KAA2B,OAA3B,GAAqCW,IAAI,CAACoB,UAAL,EAArC,GAAyD,CAACpB,IAAI,CAACqB,gBAAL,CAAsB3B,IAAI,CAAC4B,UAA3B,CAAD,CAApE;;AACA,QAAI,KAAKtC,MAAL,CAAYI,YAAZ,CAAyBuC,QAA7B,EAAuC;AACnC,aAAO,EAAP;AACH;;AACD,QAAIuC,OAAO,GAAG,UAAUC,CAAV,EAAaC,GAAb,EAAkB;AAC5B,UAAI1C,GAAG,GAAGP,IAAI,CAACgD,CAAD,CAAd;;AACA,UAAIE,MAAM,CAACrF,MAAP,CAAciD,UAAd,CAAyBC,oBAAzB,CAA8CR,GAA9C,CAAJ,EAAwD;AACpD,eAAO,UAAP;AACH;;AACD,UAAIA,GAAG,CAACS,QAAJ,IAAgBT,GAAG,CAAC4C,gBAAxB,EAA0C;AACtC,YAAIC,KAAK,GAAG,KAAK,CAAjB;AACA,YAAIC,gBAAgB,GAAGH,MAAM,CAACpF,cAAP,CAAsBM,UAAtB,CAAiC,qBAAjC,CAAvB;AACA,YAAIkF,KAAK,GAAG,IAAIhG,iBAAJ,CAAsB4F,MAAM,CAACrF,MAA7B,CAAZ;AACA,YAAI0F,YAAY,GAAGF,gBAAgB,CAACG,eAAjB,CAAiCnG,QAAQ,CAACoG,aAA1C,CAAnB;AACAL,QAAAA,KAAK,GAAGE,KAAK,CAACI,YAAN,CAAmBnF,IAAI,CAAC2C,OAAxB,EAAiC,CAAjC,EAAoCkC,KAA5C;AACA,YAAIrE,IAAI,GAAGqE,KAAK,CAACO,MAAN,CAAa,UAAU5E,IAAV,EAAgB;AAAE,iBAAOA,IAAI,CAAC6E,KAAZ;AAAoB,SAAnD,CAAX;AACA,YAAIC,EAAE,GAAGN,YAAY,CAACO,MAAb,CAAoB/E,IAAI,CAACiE,CAAD,CAAxB,EAA6BzE,IAAI,CAAC2C,OAAlC,EAA2C;AAAE,mBAAS3C,IAAI,CAACoB,GAAL,GAAWpB,IAAI,CAACoB,GAAL,CAASC,YAAT,CAAsB,eAAtB,CAAX,GAAoD;AAA/D,SAA3C,CAAT;AACA,YAAImE,GAAG,GAAGF,EAAE,CAACG,iBAAb;AACAD,QAAAA,GAAG,CAACE,YAAJ,CAAiB,WAAjB,EAA8BJ,EAAE,CAACjE,YAAH,CAAgB,WAAhB,CAA9B;AACAkD,QAAAA,QAAQ,CAACvC,GAAG,CAACa,GAAL,CAAR,GAAoB2C,GAApB;AACA,eAAO,UAAP;AACH;;AACD,UAAI/E,KAAK,GAAIuB,GAAG,CAACU,aAAJ,CAAkBV,GAAG,CAACE,KAAtB,EAA6BlC,IAAI,CAAC2C,OAAlC,EAA2CX,GAA3C,CAAb;AACA,UAAI2D,KAAK,GAAG;AAAE5C,QAAAA,MAAM,EAAEf,GAAV;AAAevB,QAAAA,KAAK,EAAEA,KAAtB;AAA6B0C,QAAAA,IAAI,EAAEnD,IAAI,CAACuB,WAAxC;AAAqDqE,QAAAA,IAAI,EAAE5F,IAAI,CAAC2C;AAAhE,OAAZ;AACA,UAAIG,IAAI,GAAGd,GAAG,CAACI,IAAJ,CAASyD,MAApB;AACA,UAAIC,KAAJ;;AACA,UAAI9D,GAAG,CAAC+D,YAAR,EAAsB;AAClBD,QAAAA,KAAK,GAAGnB,MAAM,CAACrF,MAAP,CAAc0G,aAAd,CAA4B,MAA5B,EAAoC;AAAEC,UAAAA,KAAK,EAAE;AAAE,4BAAgBjE,GAAG,CAACa;AAAtB;AAAT,SAApC,CAAR;AACA,YAAIqD,MAAM,GAAGvB,MAAM,CAACrF,MAAP,CAAc0B,OAAd,CAAsBC,EAAtB,GAA2Be,GAAG,CAACa,GAA/B,GAAqC,cAAlD;AACA,YAAIsD,QAAQ,GAAG7H,MAAM,CAAC,EAAD,EAAK,EAAL,EAAS0B,IAAI,CAAC2C,OAAd,EAAuB,IAAvB,CAArB;AACA,YAAIyD,UAAU,GAAGpE,GAAG,CAACqE,eAAJ,GAAsBF,QAAtB,EAAgCxB,MAAM,CAACrF,MAAvC,EAA+C,cAA/C,EAA+D4G,MAA/D,CAAjB;AACA;;AACAvB,QAAAA,MAAM,CAACrF,MAAP,CAAcgH,OAAd,IAAyB3B,MAAM,CAACrF,MAAP,CAAcI,YAAd,CAA2BC,IAA3B,KAAoC,OAA7D,GACI4G,UAAU,CAAC,YAAY;AAAErH,UAAAA,cAAc,CAAC4G,KAAD,EAAQM,UAAR,CAAd;AAAoC,SAAnD,CADd,GACqElH,cAAc,CAAC4G,KAAD,EAAQM,UAAR,CADnF;;AAEA,YAAIvH,QAAQ,EAAZ,EAAgB;AACZ,cAAI2H,QAAQ,GAAG,UAAUC,UAAV,EAAsB;AACjC,gBAAI1D,MAAM,GAAG0D,UAAb;;AACA,gBAAIC,IAAI,GAAG,YAAY;AACnBpC,cAAAA,KAAK,CAAChF,MAAN,CAAaiD,UAAb,CAAwBoE,OAAxB,CAAgCC,KAAhC,CAAsC7D,MAAM,CAACb,KAA7C,IAAsDa,MAAM,CAAC8D,eAA7D;AACH,aAFD;;AAGA,mBAAOH,IAAP;AACH,WAND;;AAOAnI,UAAAA,oBAAoB,CAAC2H,MAAD,EAAS,cAAT,EAAyBlE,GAAzB,EAA8B,IAA9B,EAAoCwE,QAAQ,CAACxE,GAAD,CAA5C,CAApB;AACH;AACJ,OAlBD,MAmBK;AACD,YAAI,OAAOc,IAAP,KAAgB,QAApB,EAA8B;AAC1BA,UAAAA,IAAI,GAAG7D,SAAS,CAAC6D,IAAD,EAAOR,MAAP,CAAhB;AACAwD,UAAAA,KAAK,GAAGhD,IAAI,CAAC6C,KAAD,CAAZ;AACH,SAHD,MAIK;AACDG,UAAAA,KAAK,GAAG9D,GAAG,CAACI,IAAJ,CAASyD,MAAT,CAAgBF,KAAhB,CAAR;AACH;;AACD,YAAI,OAAOG,KAAP,KAAiB,QAArB,EAA+B;AAC3B,cAAIN,GAAG,GAAGb,MAAM,CAACrF,MAAP,CAAc0G,aAAd,CAA4B,KAA5B,CAAV;AACAR,UAAAA,GAAG,CAACsB,SAAJ,GAAgBhB,KAAhB;AACAA,UAAAA,KAAK,GAAGN,GAAG,CAACuB,UAAZ;AACH;;AACD,YAAIC,OAAO,GAAGlB,KAAK,CAACmB,OAAN,KAAkB,OAAlB,IAA6BnB,KAAK,CAACoB,gBAAN,CAAuB,OAAvB,EAAgCnF,MAA3E;AACA,YAAIoF,gBAAgB,GAAGnI,iBAAiB,CAACgD,GAAG,CAACE,KAAL,CAAxC;AACAvD,QAAAA,UAAU,CAACqI,OAAO,GAAGlB,KAAK,CAAC/E,aAAN,CAAoB,OAApB,CAAH,GAAkC+E,KAA1C,EAAiD;AACvDsB,UAAAA,IAAI,EAAED,gBADiD;AAC/B,0BAAgBnF,GAAG,CAACa,GADW;AAEvD5B,UAAAA,EAAE,EAAEX,IAAI,CAACU,OAAL,CAAaC,EAAb,GAAkBkG;AAFiC,SAAjD,CAAV;AAIAvI,QAAAA,SAAS,CAACkH,KAAD,EAAQ,CAAC,SAAD,EAAY,SAAZ,CAAR,EAAgC,EAAhC,CAAT;;AACA,YAAI9D,GAAG,CAACqF,SAAJ,KAAkB,OAAtB,EAA+B;AAC3BvB,UAAAA,KAAK,CAAClH,SAAN,CAAgBkF,GAAhB,CAAoB,UAApB;AACH;;AACD,YAAI,CAAC9B,GAAG,CAACsF,YAAJ,IAAoBtF,GAAG,CAACuF,UAAzB,KAAwCvH,IAAI,CAACuB,WAAL,KAAqB,WAA7D,IACCS,GAAG,CAACuF,UAAJ,IAAkBvH,IAAI,CAACuB,WAAL,KAAqB,KAD5C,EACoD;AAAE;AAClDuE,UAAAA,KAAK,CAACJ,YAAN,CAAmB,UAAnB,EAA+B,EAA/B;AACH;AACJ;;AACDnB,MAAAA,QAAQ,CAACvC,GAAG,CAACa,GAAL,CAAR,GAAoBiD,KAApB;AACH,KAtED;;AAuEA,QAAInB,MAAM,GAAG,IAAb;;AACA,SAAK,IAAIF,CAAC,GAAG,CAAR,EAAWC,GAAG,GAAGjD,IAAI,CAACM,MAA3B,EAAmC0C,CAAC,GAAGC,GAAvC,EAA4CD,CAAC,EAA7C,EAAiD;AAC7CD,MAAAA,OAAO,CAACC,CAAD,EAAIC,GAAJ,CAAP;AACH;;AACD,WAAOH,QAAP;AACH,GApFD;;AAqFAlF,EAAAA,UAAU,CAACS,SAAX,CAAqB0H,OAArB,GAA+B,YAAY;AACvC,SAAK/H,QAAL,CAAcgI,mBAAd;AACH,GAFD;;AAGA,SAAOpI,UAAP;AACH,CAxN+B,EAAhC;;AAyNA,SAASA,UAAT","sourcesContent":["import { isNullOrUndefined, closest, extend, updateBlazorTemplate } from '@syncfusion/ej2-base';\nimport { InlineEditRender } from './inline-edit-renderer';\nimport { BatchEditRender } from './batch-edit-renderer';\nimport { DialogEditRender } from './dialog-edit-renderer';\nimport { attributes, classList, isBlazor } from '@syncfusion/ej2-base';\nimport { CellType } from '../base/enum';\nimport { RowModelGenerator } from '../services/row-model-generator';\nimport { getComplexFieldID, getObject, appendChildren, parentsUntil } from '../base/util';\nimport * as events from '../base/constant';\n/**\n * Edit render module is used to render grid edit row.\n * @hidden\n */\nvar EditRender = /** @class */ (function () {\n    /**\n     * Constructor for render module\n     */\n    function EditRender(parent, serviceLocator) {\n        //Internal variables               \n        this.editType = {\n            'Inline': InlineEditRender,\n            'Normal': InlineEditRender, 'Batch': BatchEditRender, 'Dialog': DialogEditRender\n        };\n        this.parent = parent;\n        this.serviceLocator = serviceLocator;\n        this.renderer = new this.editType[this.parent.editSettings.mode](parent, serviceLocator);\n        this.focus = serviceLocator.getService('focus');\n    }\n    EditRender.prototype.addNew = function (args) {\n        this.renderer.addNew(this.getEditElements(args), args);\n        this.convertWidget(args);\n    };\n    EditRender.prototype.update = function (args) {\n        this.renderer.update(this.getEditElements(args), args);\n        this.parent.notify(events.beforeStartEdit, args);\n        this.convertWidget(args);\n    };\n    EditRender.prototype.convertWidget = function (args) {\n        var gObj = this.parent;\n        var isFocused;\n        var cell;\n        var value;\n        var fForm;\n        var frzCols = gObj.getFrozenColumns();\n        var form = gObj.editSettings.mode === 'Dialog' ?\n            document.querySelector('#' + gObj.element.id + '_dialogEdit_wrapper').querySelector('.e-gridform') :\n            gObj.element.querySelector('.e-gridform');\n        if (frzCols && gObj.editSettings.mode === 'Normal') {\n            var rowIndex = parseInt(args.row.getAttribute('aria-rowindex'), 10);\n            if (gObj.frozenRows && ((args.requestType === 'add' && gObj.editSettings.newRowPosition === 'Top')\n                || rowIndex < gObj.frozenRows)) {\n                fForm = gObj.element.querySelector('.e-movableheader').querySelector('.e-gridform');\n            }\n            else {\n                fForm = gObj.element.querySelector('.e-movablecontent').querySelector('.e-gridform');\n            }\n        }\n        var cols = gObj.editSettings.mode !== 'Batch' ? gObj.getColumns() : [gObj.getColumnByField(args.columnName)];\n        for (var _i = 0, cols_1 = cols; _i < cols_1.length; _i++) {\n            var col = cols_1[_i];\n            if (this.parent.editSettings.template && !isNullOrUndefined(col.field)) {\n                var cellArgs = extend({}, args);\n                cellArgs.element = form.querySelector('[name=' + getComplexFieldID(col.field) + ']');\n                if (isNullOrUndefined(cellArgs.element) && frzCols) {\n                    cellArgs.element = fForm.querySelector('[name=' + getComplexFieldID(col.field) + ']');\n                }\n                if (typeof col.edit.write === 'string') {\n                    getObject(col.edit.write, window)(cellArgs);\n                }\n                else {\n                    col.edit.write(cellArgs);\n                }\n                continue;\n            }\n            if (this.parent.editModule.checkColumnIsGrouped(col) || col.commands) {\n                continue;\n            }\n            value = (col.valueAccessor(col.field, args.rowData, col));\n            if (frzCols && cols.indexOf(col) >= frzCols && gObj.editSettings.mode === 'Normal') {\n                cell = fForm.querySelector('[e-mappinguid=' + col.uid + ']');\n            }\n            else {\n                cell = form.querySelector('[e-mappinguid=' + col.uid + ']');\n            }\n            var temp = col.edit.write;\n            if (!isNullOrUndefined(cell)) {\n                if (typeof temp === 'string') {\n                    temp = getObject(temp, window);\n                    temp({\n                        rowData: args.rowData, element: cell, column: col, requestType: args.requestType, row: args.row,\n                        foreignKeyData: col.isForeignColumn() && getObject(col.field, args.foreignKeyData)\n                    });\n                }\n                else {\n                    col.edit.write({\n                        rowData: args.rowData, element: cell, column: col, requestType: args.requestType, row: args.row,\n                        foreignKeyData: col.isForeignColumn() && getObject(col.field, args.foreignKeyData)\n                    });\n                }\n                if (!isFocused && !cell.getAttribute('disabled')) {\n                    this.focusElement(cell, args.type);\n                    isFocused = true;\n                }\n            }\n        }\n        if (frzCols !== 0 && !this.parent.allowTextWrap && ((args.requestType === 'add') || args.requestType === 'beginEdit')\n            && this.parent.editSettings.mode !== 'Dialog' && !isNullOrUndefined(form) && !isNullOrUndefined(fForm)) {\n            var mTdElement = (fForm.querySelector('tr').children[0]);\n            var fTdElement = (form.querySelector('tr').children[0]);\n            if (fTdElement.offsetHeight > mTdElement.offsetHeight) {\n                mTdElement.style.height = fTdElement.offsetHeight + 'px';\n            }\n            else {\n                fTdElement.style.height = mTdElement.offsetHeight + 'px';\n            }\n        }\n    };\n    EditRender.prototype.focusElement = function (elem, type) {\n        var chkBox = this.parent.element.querySelector('.e-edit-checkselect');\n        if (!isNullOrUndefined(chkBox)) {\n            chkBox.nextElementSibling.classList.add('e-focus');\n        }\n        if (this.parent.editSettings.mode === 'Batch') {\n            this.focus.onClick({ target: closest(elem, 'td') }, true);\n        }\n        else {\n            var isFocus = this.parent.enableVirtualization && this.parent.editSettings.mode === 'Normal' ? false : true;\n            if (isFocus || (this.parent.enableVirtualization && this.parent.editSettings.newRowPosition === 'Bottom'\n                && parentsUntil(elem, 'e-addedrow'))) {\n                elem.focus();\n            }\n            else {\n                // tslint:disable-next-line:no-any\n                elem.focus({ preventScroll: true });\n            }\n        }\n        if (elem.classList.contains('e-defaultcell')) {\n            elem.setSelectionRange(elem.value.length, elem.value.length);\n        }\n    };\n    EditRender.prototype.getEditElements = function (args) {\n        var _this = this;\n        var gObj = this.parent;\n        var elements = {};\n        var cols = gObj.editSettings.mode !== 'Batch' ? gObj.getColumns() : [gObj.getColumnByField(args.columnName)];\n        if (this.parent.editSettings.template) {\n            return {};\n        }\n        var _loop_1 = function (i, len) {\n            var col = cols[i];\n            if (this_1.parent.editModule.checkColumnIsGrouped(col)) {\n                return \"continue\";\n            }\n            if (col.commands || col.commandsTemplate) {\n                var cells = void 0;\n                var cellRendererFact = this_1.serviceLocator.getService('cellRendererFactory');\n                var model = new RowModelGenerator(this_1.parent);\n                var cellRenderer = cellRendererFact.getCellRenderer(CellType.CommandColumn);\n                cells = model.generateRows(args.rowData)[0].cells;\n                var cell = cells.filter(function (cell) { return cell.rowID; });\n                var td = cellRenderer.render(cell[i], args.rowData, { 'index': args.row ? args.row.getAttribute('aria-rowindex') : 0 });\n                var div = td.firstElementChild;\n                div.setAttribute('textAlign', td.getAttribute('textAlign'));\n                elements[col.uid] = div;\n                return \"continue\";\n            }\n            var value = (col.valueAccessor(col.field, args.rowData, col));\n            var tArgs = { column: col, value: value, type: args.requestType, data: args.rowData };\n            var temp = col.edit.create;\n            var input;\n            if (col.editTemplate) {\n                input = this_1.parent.createElement('span', { attrs: { 'e-mappinguid': col.uid } });\n                var tempID = this_1.parent.element.id + col.uid + 'editTemplate';\n                var tempData = extend({}, {}, args.rowData, true);\n                var template_1 = col.getEditTemplate()(tempData, this_1.parent, 'editTemplate', tempID);\n                /* tslint:disable-next-line:no-any */\n                this_1.parent.isReact && this_1.parent.editSettings.mode === 'Batch' ?\n                    setTimeout(function () { appendChildren(input, template_1); }) : appendChildren(input, template_1);\n                if (isBlazor()) {\n                    var setRules = function (ruleColumn) {\n                        var column = ruleColumn;\n                        var func = function () {\n                            _this.parent.editModule.formObj.rules[column.field] = column.validationRules;\n                        };\n                        return func;\n                    };\n                    updateBlazorTemplate(tempID, 'EditTemplate', col, true, setRules(col));\n                }\n            }\n            else {\n                if (typeof temp === 'string') {\n                    temp = getObject(temp, window);\n                    input = temp(tArgs);\n                }\n                else {\n                    input = col.edit.create(tArgs);\n                }\n                if (typeof input === 'string') {\n                    var div = this_1.parent.createElement('div');\n                    div.innerHTML = input;\n                    input = div.firstChild;\n                }\n                var isInput = input.tagName !== 'input' && input.querySelectorAll('input').length;\n                var complexFieldName = getComplexFieldID(col.field);\n                attributes(isInput ? input.querySelector('input') : input, {\n                    name: complexFieldName, 'e-mappinguid': col.uid,\n                    id: gObj.element.id + complexFieldName\n                });\n                classList(input, ['e-input', 'e-field'], []);\n                if (col.textAlign === 'Right') {\n                    input.classList.add('e-ralign');\n                }\n                if ((col.isPrimaryKey || col.isIdentity) && args.requestType === 'beginEdit' ||\n                    (col.isIdentity && args.requestType === 'add')) { // already disabled in cell plugins\n                    input.setAttribute('disabled', '');\n                }\n            }\n            elements[col.uid] = input;\n        };\n        var this_1 = this;\n        for (var i = 0, len = cols.length; i < len; i++) {\n            _loop_1(i, len);\n        }\n        return elements;\n    };\n    EditRender.prototype.destroy = function () {\n        this.renderer.removeEventListener();\n    };\n    return EditRender;\n}());\nexport { EditRender };\n"]},"metadata":{},"sourceType":"module"}