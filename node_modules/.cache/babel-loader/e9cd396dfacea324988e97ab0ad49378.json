{"ast":null,"code":"import { isNullOrUndefined, extend } from '@syncfusion/ej2-base';\nimport { setStyleAttribute, closest as getClosest, remove, isBlazor } from '@syncfusion/ej2-base';\nimport { classList } from '@syncfusion/ej2-base';\nimport { CellType } from '../base/enum';\nimport { RowRenderer } from './row-renderer';\nimport { Cell } from '../models/cell';\nimport { Row } from '../models/row';\nimport * as events from '../base/constant';\nimport { Draggable, Droppable } from '@syncfusion/ej2-base';\nimport { parentsUntil, wrap, measureColumnDepth, appendChildren } from '../base/util';\n/**\n * Content module is used to render grid content\n * @hidden\n */\n\nvar HeaderRender =\n/** @class */\nfunction () {\n  /**\n   * Constructor for header renderer module\n   */\n  function HeaderRender(parent, serviceLocator) {\n    var _this = this;\n\n    this.frzIdx = 0;\n    this.notfrzIdx = 0;\n    this.isFirstCol = false;\n\n    this.helper = function (e) {\n      var gObj = _this.parent;\n      var target = _this.draggable.currentStateTarget;\n      var parentEle = parentsUntil(target, 'e-headercell');\n\n      if (!(gObj.allowReordering || gObj.allowGrouping) || !isNullOrUndefined(parentEle) && parentEle.querySelectorAll('.e-checkselectall').length > 0) {\n        return false;\n      }\n\n      var visualElement = _this.parent.createElement('div', {\n        className: 'e-cloneproperties e-dragclone e-headerclone'\n      });\n\n      var element = target.classList.contains('e-headercell') ? target : parentEle;\n\n      if (!element || !gObj.allowReordering && element.classList.contains('e-stackedheadercell')) {\n        return false;\n      }\n\n      var height = element.offsetHeight;\n      var headercelldiv = element.querySelector('.e-headercelldiv') || element.querySelector('.e-stackedheadercelldiv');\n      var col;\n\n      if (headercelldiv) {\n        if (element.querySelector('.e-stackedheadercelldiv')) {\n          col = gObj.getStackedHeaderColumnByHeaderText(headercelldiv.innerText.trim(), gObj.columns);\n        } else {\n          col = gObj.getColumnByUid(headercelldiv.getAttribute('e-mappinguid'));\n        }\n\n        _this.column = col;\n\n        if (_this.column.lockColumn) {\n          return false;\n        }\n\n        visualElement.setAttribute('e-mappinguid', _this.column.uid);\n      }\n\n      if (col && !isNullOrUndefined(col.headerTemplate)) {\n        if (!isNullOrUndefined(col.headerTemplate)) {\n          var result = void 0;\n          var colIndex = gObj.getColumnIndexByField(col.field);\n          result = col.getHeaderTemplate()(extend({\n            'index': colIndex\n          }, col), gObj, 'headerTemplate');\n          appendChildren(visualElement, result);\n        } else {\n          visualElement.innerHTML = col.headerTemplate;\n        }\n      } else {\n        visualElement.innerHTML = headercelldiv ? col.headerText : element.firstElementChild.innerHTML;\n      }\n\n      visualElement.style.width = element.offsetWidth + 'px';\n      visualElement.style.height = element.offsetHeight + 'px';\n      visualElement.style.lineHeight = (height - 6).toString() + 'px';\n      gObj.element.appendChild(visualElement);\n      return visualElement;\n    };\n\n    this.dragStart = function (e) {\n      var gObj = _this.parent;\n      gObj.element.querySelector('.e-gridpopup').style.display = 'none';\n      gObj.notify(events.columnDragStart, {\n        target: _this.draggable.currentStateTarget,\n        column: _this.column,\n        event: e.event\n      });\n\n      if (isBlazor()) {\n        e.bindEvents(e.dragElement);\n      }\n    };\n\n    this.drag = function (e) {\n      var gObj = _this.parent;\n      var target = e.target;\n\n      if (target) {\n        var closest = getClosest(target, '.e-grid');\n\n        var cloneElement = _this.parent.element.querySelector('.e-cloneproperties');\n\n        if (!closest || closest.getAttribute('id') !== gObj.element.getAttribute('id')) {\n          classList(cloneElement, ['e-notallowedcur'], ['e-defaultcur']);\n\n          if (gObj.allowReordering) {\n            gObj.element.querySelector('.e-reorderuparrow').style.display = 'none';\n            gObj.element.querySelector('.e-reorderdownarrow').style.display = 'none';\n          }\n\n          if (!gObj.groupSettings.allowReordering) {\n            return;\n          }\n        }\n\n        gObj.notify(events.columnDrag, {\n          target: e.target,\n          column: _this.column,\n          event: e.event\n        });\n      }\n    };\n\n    this.dragStop = function (e) {\n      var gObj = _this.parent;\n      var cancel;\n      gObj.element.querySelector('.e-gridpopup').style.display = 'none';\n\n      if (!parentsUntil(e.target, 'e-headercell') && !parentsUntil(e.target, 'e-groupdroparea') || !gObj.allowReordering && parentsUntil(e.target, 'e-headercell') || !e.helper.getAttribute('e-mappinguid') && parentsUntil(e.target, 'e-groupdroparea')) {\n        remove(e.helper);\n        cancel = true;\n      }\n\n      gObj.notify(events.columnDragStop, {\n        target: e.target,\n        event: e.event,\n        column: _this.column,\n        cancel: cancel\n      });\n    };\n\n    this.drop = function (e) {\n      var gObj = _this.parent;\n      var uid = e.droppedElement.getAttribute('e-mappinguid');\n      var closest = getClosest(e.target, '.e-grid');\n      remove(e.droppedElement);\n\n      if (closest && closest.getAttribute('id') !== gObj.element.getAttribute('id') || !(gObj.allowReordering || gObj.allowGrouping)) {\n        return;\n      }\n\n      gObj.notify(events.headerDrop, {\n        target: e.target,\n        uid: uid,\n        droppedElement: e.droppedElement\n      });\n    };\n\n    this.parent = parent;\n    this.serviceLocator = serviceLocator;\n    this.ariaService = this.serviceLocator.getService('ariaService');\n    this.widthService = this.serviceLocator.getService('widthService');\n\n    if (this.parent.isDestroyed) {\n      return;\n    }\n\n    if (!this.parent.enableColumnVirtualization) {\n      this.parent.on(events.columnVisibilityChanged, this.setVisible, this);\n    }\n\n    this.parent.on(events.columnPositionChanged, this.colPosRefresh, this);\n  }\n  /**\n   * The function is used to render grid header div\n   */\n\n\n  HeaderRender.prototype.renderPanel = function () {\n    var div = this.parent.element.querySelector('.e-gridheader');\n    var isRendered = div != null;\n    div = isRendered ? div : this.parent.createElement('div', {\n      className: 'e-gridheader'\n    });\n    var innerDiv = isRendered ? div.querySelector('.e-headercontent') : this.parent.createElement('div', {\n      className: 'e-headercontent'\n    });\n    this.toggleStackClass(div);\n    div.appendChild(innerDiv);\n    this.setPanel(div);\n\n    if (!isRendered) {\n      this.parent.element.appendChild(div);\n    }\n  };\n  /**\n   * The function is used to render grid header table\n   */\n\n\n  HeaderRender.prototype.renderTable = function () {\n    var headerDiv = this.getPanel();\n    headerDiv.appendChild(this.createHeaderTable());\n    this.setTable(headerDiv.querySelector('.e-table'));\n\n    if (!this.parent.getFrozenColumns()) {\n      this.initializeHeaderDrag();\n      this.initializeHeaderDrop();\n    }\n\n    this.parent.notify(events.headerRefreshed, {\n      rows: this.rows,\n      args: {\n        isFrozen: this.parent.getFrozenColumns() !== 0\n      }\n    });\n  };\n  /**\n   * Get the header content div element of grid\n   * @return {Element}\n   */\n\n\n  HeaderRender.prototype.getPanel = function () {\n    return this.headerPanel;\n  };\n  /**\n   * Set the header content div element of grid\n   * @param  {Element} panel\n   */\n\n\n  HeaderRender.prototype.setPanel = function (panel) {\n    this.headerPanel = panel;\n  };\n  /**\n   * Get the header table element of grid\n   * @return {Element}\n   */\n\n\n  HeaderRender.prototype.getTable = function () {\n    return this.headerTable;\n  };\n  /**\n   * Set the header table element of grid\n   * @param  {Element} table\n   */\n\n\n  HeaderRender.prototype.setTable = function (table) {\n    this.headerTable = table;\n  };\n  /**\n   * Get the header colgroup element\n   * @returns {Element}\n   */\n\n\n  HeaderRender.prototype.getColGroup = function () {\n    return this.colgroup;\n  };\n  /**\n   * Set the header colgroup element\n   * @param {Element} colgroup\n   * @returns {Element}\n   */\n\n\n  HeaderRender.prototype.setColGroup = function (colGroup) {\n    return this.colgroup = colGroup;\n  };\n  /**\n   * Get the header row element collection.\n   * @return {Element[]}\n   */\n\n\n  HeaderRender.prototype.getRows = function () {\n    var table = this.getTable();\n    return table.tHead.rows;\n  };\n  /**\n   * The function is used to create header table elements\n   * @return {Element}\n   * @hidden\n   */\n\n\n  HeaderRender.prototype.createHeaderTable = function () {\n    var skipDom = isBlazor() && this.parent.frozenRows !== 0;\n    var table = this.createTable();\n    var innerDiv = this.getPanel().querySelector('.e-headercontent');\n\n    if (!skipDom) {\n      innerDiv.appendChild(table);\n    }\n\n    return innerDiv;\n  };\n  /**\n   * @hidden\n   */\n\n\n  HeaderRender.prototype.createTable = function (tableEle) {\n    if (tableEle === void 0) {\n      tableEle = null;\n    }\n\n    var skipDom = isBlazor() && this.parent.frozenRows !== 0;\n    var gObj = this.parent;\n\n    if (!(isBlazor() && !gObj.isJsComponent) && this.getTable() && !gObj.getFrozenColumns()) {\n      remove(this.getTable());\n    }\n\n    var columns = gObj.getColumns();\n    var innerDiv = this.getPanel().querySelector('.e-headercontent');\n    var table = skipDom ? tableEle || innerDiv.querySelector('.e-table') : this.parent.createElement('table', {\n      className: 'e-table',\n      attrs: {\n        cellspacing: '0.25px',\n        role: 'grid'\n      }\n    });\n    var findHeaderRow = this.createHeaderContent();\n    var thead = findHeaderRow.thead;\n    var tbody = this.parent.createElement('tbody', {\n      className: this.parent.frozenRows ? '' : 'e-hide'\n    });\n    this.caption = this.parent.createElement('caption', {\n      innerHTML: this.parent.element.id + '_header_table',\n      className: 'e-hide'\n    });\n    var colGroup = this.parent.createElement('colgroup');\n    var rowBody = this.parent.createElement('tr');\n    var bodyCell;\n    var rows = this.rows = findHeaderRow.rows;\n    var rowRenderer = new RowRenderer(this.serviceLocator, CellType.Header, this.parent);\n\n    for (var i = 0, len = rows.length; i < len; i++) {\n      for (var j = 0, len_1 = rows[i].cells.length; j < len_1; j++) {\n        var cell = rows[i].cells[j];\n        bodyCell = this.parent.createElement('td');\n        rowBody.appendChild(bodyCell);\n      }\n    }\n\n    if (gObj.allowFiltering || gObj.allowSorting || gObj.allowGrouping) {\n      table.classList.add('e-sortfilter');\n    }\n\n    this.updateColGroup(colGroup);\n\n    if (!skipDom) {\n      tbody.appendChild(rowBody);\n    }\n\n    table.appendChild(this.setColGroup(colGroup));\n    table.appendChild(thead);\n\n    if (!skipDom) {\n      table.appendChild(tbody);\n    }\n\n    table.appendChild(this.caption);\n    this.ariaService.setOptions(table, {\n      colcount: gObj.getColumns().length.toString()\n    });\n    return table;\n  };\n\n  HeaderRender.prototype.createHeaderContent = function () {\n    var gObj = this.parent;\n    var columns = gObj.getColumns();\n    var thead = this.parent.createElement('thead');\n    var colHeader = this.parent.createElement('tr', {\n      className: 'e-columnheader'\n    });\n    var rowRenderer = new RowRenderer(this.serviceLocator, CellType.Header, gObj);\n    rowRenderer.element = colHeader;\n    var rows = [];\n    var headerRow;\n    this.colDepth = measureColumnDepth(gObj.columns);\n\n    for (var i = 0, len = this.colDepth; i < len; i++) {\n      rows[i] = this.generateRow(i);\n      rows[i].cells = [];\n    }\n\n    rows = this.ensureColumns(rows);\n    rows = this.getHeaderCells(rows);\n\n    for (var i = 0, len = this.colDepth; i < len; i++) {\n      headerRow = rowRenderer.render(rows[i], columns);\n\n      if (this.parent.rowHeight && headerRow.querySelector('.e-headercell')) {\n        headerRow.style.height = this.parent.rowHeight + 'px';\n      }\n\n      thead.appendChild(headerRow);\n    }\n\n    var findHeaderRow = {\n      thead: thead,\n      rows: rows\n    };\n    return findHeaderRow;\n  };\n\n  HeaderRender.prototype.updateColGroup = function (colGroup) {\n    var cols = this.parent.getColumns();\n    var col;\n    var indexes = this.parent.getColumnIndexesInView();\n\n    if (this.parent.enableColumnVirtualization && this.parent.getFrozenColumns() && this.parent.contentModule.isXaxis()) {\n      cols = extend([], this.parent.getColumns());\n      cols.splice(0, this.parent.getFrozenColumns());\n    }\n\n    colGroup.id = this.parent.element.id + 'colGroup';\n\n    if (this.parent.allowGrouping) {\n      for (var i = 0, len = this.parent.groupSettings.columns.length; i < len; i++) {\n        if (this.parent.enableColumnVirtualization && indexes.indexOf(i) === -1) {\n          continue;\n        }\n\n        col = this.parent.createElement('col', {\n          className: 'e-group-intent'\n        });\n        colGroup.appendChild(col);\n      }\n    }\n\n    if (this.parent.detailTemplate || this.parent.childGrid) {\n      col = this.parent.createElement('col', {\n        className: 'e-detail-intent'\n      });\n      colGroup.appendChild(col);\n    }\n\n    if (this.parent.isRowDragable()) {\n      col = this.parent.createElement('col', {\n        className: 'e-drag-intent'\n      });\n      colGroup.appendChild(col);\n    }\n\n    for (var i = 0, len = cols.length; i < len; i++) {\n      col = this.parent.createElement('col');\n\n      if (cols[i].visible === false) {\n        setStyleAttribute(col, {\n          'display': 'none'\n        });\n      }\n\n      colGroup.appendChild(col);\n    }\n\n    return colGroup;\n  };\n\n  HeaderRender.prototype.ensureColumns = function (rows) {\n    //TODO: generate dummy column for group, detail, stacked row here; ensureColumns here\n    var gObj = this.parent;\n    var indexes = this.parent.getColumnIndexesInView();\n\n    for (var i = 0, len = rows.length; i < len; i++) {\n      if (gObj.allowGrouping) {\n        for (var c = 0, len_2 = gObj.groupSettings.columns.length; c < len_2; c++) {\n          if (this.parent.enableColumnVirtualization && indexes.indexOf(c) === -1) {\n            continue;\n          }\n\n          rows[i].cells.push(this.generateCell({}, CellType.HeaderIndent));\n        }\n      }\n\n      if (gObj.detailTemplate || gObj.childGrid) {\n        var args = {};\n        this.parent.notify(events.detailIndentCellInfo, args);\n        rows[i].cells.push(this.generateCell(args, CellType.DetailHeader));\n      }\n\n      if (gObj.isRowDragable()) {\n        rows[i].cells.push(this.generateCell({}, CellType.RowDragHIcon));\n      }\n    }\n\n    return rows;\n  };\n\n  HeaderRender.prototype.getHeaderCells = function (rows) {\n    var column;\n    var thead = this.parent.getHeaderTable() && this.parent.getHeaderTable().querySelector('thead');\n    var cols = this.parent.enableColumnVirtualization ? this.parent.getColumns(this.parent.enablePersistence) : this.parent.columns;\n    this.frzIdx = 0;\n    this.notfrzIdx = 0;\n\n    if (this.parent.lockcolPositionCount) {\n      for (var i = 0; i < cols.length; i++) {\n        this.lockColsRendered = false;\n        rows = this.appendCells(cols[i], rows, 0, i === 0, false, i === cols.length - 1, thead);\n      }\n    }\n\n    for (var i = 0, len = cols.length; i < len; i++) {\n      this.notfrzIdx = 0;\n      this.lockColsRendered = true;\n      rows = this.appendCells(cols[i], rows, 0, i === 0, false, i === len - 1, thead);\n    }\n\n    return rows;\n  };\n\n  HeaderRender.prototype.appendCells = function (cols, rows, index, isFirstObj, isFirstCol, isLastCol, isMovable) {\n    var lastCol = isLastCol ? 'e-lastcell' : '';\n    var frzCols = this.parent.getFrozenColumns();\n    var left;\n\n    if (this.parent.enableColumnVirtualization && frzCols) {\n      left = this.parent.getContent().querySelector('.e-movablecontent').scrollLeft;\n    }\n\n    if (!cols.columns) {\n      if (left && left > 0 && this.parent.contentModule.isXaxis() && this.parent.inViewIndexes[0] !== 0 && this.frzIdx > this.parent.getFrozenColumns()) {\n        rows[index].cells.push(this.generateCell(cols, CellType.Header, this.colDepth - index, (isFirstObj ? '' : isFirstCol ? 'e-firstcell' : '') + lastCol, index, this.parent.getColumnIndexByUid(cols.uid)));\n      } else {\n        if (!frzCols && (!this.parent.lockcolPositionCount || cols.lockColumn && !this.lockColsRendered || !cols.lockColumn && this.lockColsRendered) || frzCols && (!isMovable && (this.frzIdx + this.notfrzIdx < this.parent.frozenColumns || cols.isFrozen) && (!this.parent.lockcolPositionCount || cols.lockColumn && !this.lockColsRendered || !cols.lockColumn && this.lockColsRendered) || isMovable && this.frzIdx + this.notfrzIdx >= this.parent.frozenColumns && !cols.isFrozen && (!this.parent.lockcolPositionCount || cols.lockColumn && !this.lockColsRendered || !cols.lockColumn && this.lockColsRendered))) {\n          rows[index].cells.push(this.generateCell(cols, CellType.Header, this.colDepth - index, (isFirstObj ? '' : isFirstCol ? 'e-firstcell' : '') + lastCol, index, this.parent.getColumnIndexByUid(cols.uid)));\n        }\n      }\n\n      if (this.parent.lockcolPositionCount) {\n        if (this.frzIdx + this.notfrzIdx < this.parent.frozenColumns && (cols.lockColumn && !this.lockColsRendered || !cols.lockColumn && this.lockColsRendered)) {\n          this.frzIdx++;\n        } else {\n          this.notfrzIdx++;\n        }\n      } else {\n        this.frzIdx++;\n      }\n    } else {\n      this.isFirstCol = false;\n      var colSpan = this.getCellCnt(cols, 0);\n\n      if (colSpan) {\n        var frzObj = this.refreshFrozenHdr(cols.columns, {\n          isPartial: false,\n          isComp: true,\n          cnt: 0\n        });\n        var stackedLockColsCount = this.getStackedLockColsCount(cols, 0);\n\n        if (!frzCols && (!this.parent.lockcolPositionCount || !this.lockColsRendered && stackedLockColsCount || this.lockColsRendered && colSpan - stackedLockColsCount) || frzCols && (!isMovable && this.checkFrozenStackHeader(cols.columns, isMovable) && (this.parent.frozenColumns - this.frzIdx > 0 || frzObj.isPartial) || isMovable && (colSpan + this.frzIdx > this.parent.frozenColumns && !frzObj.isComp || this.checkFrozenStackHeader(cols.columns, isMovable)))) {\n          rows[index].cells.push(new Cell({\n            cellType: CellType.StackedHeader,\n            column: cols,\n            colSpan: this.getColSpan(colSpan, isMovable, frzObj.cnt, stackedLockColsCount)\n          }));\n        }\n      }\n\n      if (this.parent.lockcolPositionCount && !this.lockColsRendered) {\n        for (var i = 0; i < cols.columns.length; i++) {\n          rows = this.appendCells(cols.columns[i], rows, index + 1, isFirstObj, i === 0, i === cols.columns.length - 1 && isLastCol, isMovable);\n        }\n      }\n\n      if (this.lockColsRendered) {\n        for (var i = 0, len = cols.columns.length; i < len; i++) {\n          var isFirstCol_1 = this.isFirstCol = cols.columns[i].visible && !this.isFirstCol;\n          var isLastCol_1 = i === len - 1 && !isFirstCol_1;\n          rows = this.appendCells(cols.columns[i], rows, index + 1, isFirstObj, isFirstCol_1, isLastCol_1 && isLastCol_1, isMovable);\n        }\n      }\n    }\n\n    return rows;\n  };\n\n  HeaderRender.prototype.checkFrozenStackHeader = function (cols, isMovable) {\n    var isTrue = false;\n\n    for (var i = 0; i < cols.length; i++) {\n      var col = cols[i];\n      var colIndex = this.parent.getNormalizedColumnIndex(col.uid);\n\n      if (!col.columns) {\n        if (isMovable && colIndex >= this.parent.getFrozenColumns() && col.visible) {\n          isTrue = true;\n          break;\n        }\n\n        if (!isMovable && colIndex < this.parent.getFrozenColumns() && col.visible) {\n          isTrue = true;\n          break;\n        }\n      }\n    }\n\n    return isTrue;\n  };\n\n  HeaderRender.prototype.getStackedLockColsCount = function (col, lockColsCount) {\n    if (col.columns) {\n      for (var i = 0; i < col.columns.length; i++) {\n        lockColsCount = this.getStackedLockColsCount(col.columns[i], lockColsCount);\n      }\n    } else if (col.lockColumn) {\n      lockColsCount++;\n    }\n\n    return lockColsCount;\n  };\n\n  HeaderRender.prototype.refreshFrozenHdr = function (cols, frzObj) {\n    for (var i = 0; i < cols.length; i++) {\n      if (cols[i].columns) {\n        frzObj = this.refreshFrozenHdr(cols[i].columns, frzObj);\n      } else {\n        if (cols[i].isFrozen) {\n          frzObj.isPartial = true;\n          frzObj.cnt++;\n        }\n\n        frzObj.isComp = frzObj.isComp && (cols[i].isFrozen || this.parent.getColumnIndexByField(cols[i].field) < this.parent.frozenColumns);\n      }\n    }\n\n    return frzObj;\n  };\n\n  HeaderRender.prototype.getColSpan = function (colSpan, isMovable, frozenCnt, stackedLockColsCount) {\n    var frzCol = this.parent.frozenColumns;\n\n    if (this.parent.getFrozenColumns() && this.frzIdx + colSpan > frzCol) {\n      if (isMovable) {\n        colSpan = colSpan - (frzCol > this.frzIdx ? frzCol - this.frzIdx : 0) - frozenCnt;\n      } else {\n        colSpan = colSpan - (colSpan - (frzCol > this.frzIdx ? frzCol + frozenCnt - this.frzIdx : frozenCnt));\n      }\n    } else if (this.parent.lockcolPositionCount) {\n      colSpan = !this.lockColsRendered ? stackedLockColsCount : colSpan - stackedLockColsCount;\n    }\n\n    return colSpan;\n  };\n\n  HeaderRender.prototype.generateRow = function (index) {\n    return new Row({});\n  };\n\n  HeaderRender.prototype.generateCell = function (column, cellType, rowSpan, className, rowIndex, colIndex) {\n    var opt = {\n      'visible': column.visible,\n      'isDataCell': false,\n      'isTemplate': !isNullOrUndefined(column.headerTemplate),\n      'rowID': '',\n      'column': column,\n      'cellType': cellType,\n      'rowSpan': rowSpan,\n      'className': className,\n      'index': rowIndex,\n      'colIndex': colIndex\n    };\n\n    if (!opt.rowSpan || opt.rowSpan < 2) {\n      delete opt.rowSpan;\n    }\n\n    return new Cell(opt);\n  };\n  /**\n   * Function to hide header table column based on visible property\n   * @param  {Column[]} columns?\n   */\n\n\n  HeaderRender.prototype.setVisible = function (columns) {\n    var gObj = this.parent;\n    var rows = [].slice.call(this.getRows()); //NodeList -> Array        \n\n    var displayVal;\n    var idx;\n    var className;\n    var element;\n    var frzCols = gObj.getFrozenColumns();\n\n    for (var c = 0, clen = columns.length; c < clen; c++) {\n      var column = columns[c];\n      idx = gObj.getNormalizedColumnIndex(column.uid);\n      displayVal = column.visible ? '' : 'none';\n\n      if (frzCols) {\n        if (idx < frzCols) {\n          if (isBlazor() && gObj.isServerRendered) {\n            setStyleAttribute(this.getTable().querySelector('colgroup').children[idx], {\n              'display': displayVal\n            });\n            setStyleAttribute(this.getTable().querySelectorAll('th')[idx], {\n              'display': displayVal\n            });\n          } else {\n            setStyleAttribute(this.getColGroup().children[idx], {\n              'display': displayVal\n            });\n          }\n        } else {\n          var mTblColGrp = gObj.getHeaderContent().querySelector('.e-movableheader').querySelector('colgroup');\n          var mTbl = gObj.getHeaderContent().querySelector('.e-movableheader').querySelector('table');\n          setStyleAttribute(mTblColGrp.children[idx - frzCols], {\n            'display': displayVal\n          });\n\n          if (isBlazor() && gObj.isServerRendered) {\n            setStyleAttribute(mTbl.querySelectorAll('th')[idx - frzCols], {\n              'display': displayVal\n            });\n          }\n        }\n      } else {\n        setStyleAttribute(this.getColGroup().children[idx], {\n          'display': displayVal\n        });\n      }\n    }\n\n    this.refreshUI();\n  };\n\n  HeaderRender.prototype.colPosRefresh = function () {\n    if (isBlazor() && this.parent.isServerRendered && this.parent.frozenRows && this.parent.getFrozenColumns()) {\n      this.freezeReorder = true;\n    }\n\n    this.refreshUI();\n  };\n  /**\n   * Refresh the header of the Grid.\n   * @returns {void}\n   */\n\n\n  HeaderRender.prototype.refreshUI = function () {\n    var frzCols = this.parent.getFrozenColumns();\n    var isVFTable = this.parent.enableColumnVirtualization && frzCols !== 0;\n    var setFrozenTable = isBlazor() && this.parent.isServerRendered && this.parent.frozenRows !== 0 && frzCols !== 0;\n    var headerDiv = this.getPanel();\n    this.toggleStackClass(headerDiv);\n    var table = this.freezeReorder ? this.headerPanel.querySelector('.e-movableheader').querySelector('.e-table') : this.getTable();\n\n    if (isVFTable) {\n      table = this.parent.contentModule.getVirtualFreezeHeader();\n    }\n\n    if (setFrozenTable && !isVFTable) {\n      table = this.freezeReorder ? this.headerPanel.querySelector('.e-movableheader').querySelector('.e-table') : this.headerPanel.querySelector('.e-frozenheader').querySelector('.e-table');\n    }\n\n    if (table) {\n      if (isBlazor() && this.parent.isServerRendered) {\n        table.removeChild(table.querySelector('colgroup'));\n        table.removeChild(table.querySelector('thead'));\n      } else {\n        remove(table);\n        table.removeChild(table.firstChild);\n        table.removeChild(table.childNodes[0]);\n      }\n\n      var colGroup = this.parent.createElement('colgroup');\n      var findHeaderRow = this.createHeaderContent();\n      this.rows = findHeaderRow.rows;\n      table.insertBefore(findHeaderRow.thead, table.firstChild);\n      this.updateColGroup(colGroup);\n      table.insertBefore(this.setColGroup(colGroup), table.firstChild);\n\n      if (!isVFTable && !setFrozenTable) {\n        this.setTable(table);\n      }\n\n      if (!(isBlazor() && this.parent.isServerRendered)) {\n        this.appendContent(table);\n      }\n\n      this.parent.notify(events.colGroupRefresh, {});\n      this.widthService.setWidthToColumns();\n      this.parent.updateDefaultCursor();\n\n      if (!frzCols || this.parent.enableColumnVirtualization && frzCols) {\n        this.initializeHeaderDrag();\n      }\n\n      var rows = [].slice.call(headerDiv.querySelectorAll('tr.e-columnheader'));\n\n      for (var _i = 0, rows_1 = rows; _i < rows_1.length; _i++) {\n        var row = rows_1[_i];\n        var gCells = [].slice.call(row.querySelectorAll('.e-grouptopleftcell'));\n\n        if (gCells.length) {\n          gCells[gCells.length - 1].classList.add('e-lastgrouptopleftcell');\n        }\n      }\n\n      if (!frzCols) {\n        this.parent.notify(events.headerRefreshed, {\n          rows: this.rows,\n          args: {\n            isFrozen: this.parent.getFrozenColumns() !== 0\n          }\n        });\n      }\n\n      if (this.parent.enableColumnVirtualization && parentsUntil(table, 'e-movableheader')) {\n        this.parent.notify(events.headerRefreshed, {\n          rows: this.rows,\n          args: {\n            isFrozen: false,\n            isXaxis: true\n          }\n        });\n      }\n\n      if (this.parent.allowTextWrap && this.parent.textWrapSettings.wrapMode === 'Header') {\n        wrap(rows, true);\n      }\n    }\n  };\n\n  HeaderRender.prototype.toggleStackClass = function (div) {\n    var column = this.parent.columns;\n    var stackedHdr = column.some(function (column) {\n      return !isNullOrUndefined(column.columns);\n    });\n\n    if (stackedHdr) {\n      div.classList.add('e-stackedheader');\n    } else {\n      div.classList.remove('e-stackedheader');\n    }\n  };\n\n  HeaderRender.prototype.appendContent = function (table) {\n    this.getPanel().querySelector('.e-headercontent').appendChild(table);\n  };\n\n  HeaderRender.prototype.getCellCnt = function (col, cnt) {\n    if (col.columns) {\n      for (var i = 0, len = col.columns.length; i < len; i++) {\n        cnt = this.getCellCnt(col.columns[i], cnt);\n      }\n    } else {\n      if (col.visible) {\n        cnt++;\n      }\n    }\n\n    return cnt;\n  };\n\n  HeaderRender.prototype.initializeHeaderDrag = function () {\n    var gObj = this.parent;\n\n    if (!(this.parent.allowReordering || this.parent.allowGrouping && this.parent.groupSettings.showDropArea)) {\n      return;\n    }\n\n    this.draggable = new Draggable(gObj.getHeaderContent(), {\n      dragTarget: '.e-headercell',\n      distance: 5,\n      helper: this.helper,\n      dragStart: this.dragStart,\n      drag: this.drag,\n      dragStop: this.dragStop,\n      abort: '.e-rhandler'\n    });\n  };\n\n  HeaderRender.prototype.initializeHeaderDrop = function () {\n    var gObj = this.parent;\n    var drop = new Droppable(gObj.getHeaderContent(), {\n      accept: '.e-dragclone',\n      drop: this.drop\n    });\n  };\n\n  return HeaderRender;\n}();\n\nexport { HeaderRender };","map":{"version":3,"sources":["/home/nikhil/Desktop/data_grid_editor-master/node_modules/@syncfusion/ej2-grids/src/grid/renderer/header-renderer.js"],"names":["isNullOrUndefined","extend","setStyleAttribute","closest","getClosest","remove","isBlazor","classList","CellType","RowRenderer","Cell","Row","events","Draggable","Droppable","parentsUntil","wrap","measureColumnDepth","appendChildren","HeaderRender","parent","serviceLocator","_this","frzIdx","notfrzIdx","isFirstCol","helper","e","gObj","target","draggable","currentStateTarget","parentEle","allowReordering","allowGrouping","querySelectorAll","length","visualElement","createElement","className","element","contains","height","offsetHeight","headercelldiv","querySelector","col","getStackedHeaderColumnByHeaderText","innerText","trim","columns","getColumnByUid","getAttribute","column","lockColumn","setAttribute","uid","headerTemplate","result","colIndex","getColumnIndexByField","field","getHeaderTemplate","innerHTML","headerText","firstElementChild","style","width","offsetWidth","lineHeight","toString","appendChild","dragStart","display","notify","columnDragStart","event","bindEvents","dragElement","drag","cloneElement","groupSettings","columnDrag","dragStop","cancel","columnDragStop","drop","droppedElement","headerDrop","ariaService","getService","widthService","isDestroyed","enableColumnVirtualization","on","columnVisibilityChanged","setVisible","columnPositionChanged","colPosRefresh","prototype","renderPanel","div","isRendered","innerDiv","toggleStackClass","setPanel","renderTable","headerDiv","getPanel","createHeaderTable","setTable","getFrozenColumns","initializeHeaderDrag","initializeHeaderDrop","headerRefreshed","rows","args","isFrozen","headerPanel","panel","getTable","headerTable","table","getColGroup","colgroup","setColGroup","colGroup","getRows","tHead","skipDom","frozenRows","createTable","tableEle","isJsComponent","getColumns","attrs","cellspacing","role","findHeaderRow","createHeaderContent","thead","tbody","caption","id","rowBody","bodyCell","rowRenderer","Header","i","len","j","len_1","cells","cell","allowFiltering","allowSorting","add","updateColGroup","setOptions","colcount","colHeader","headerRow","colDepth","generateRow","ensureColumns","getHeaderCells","render","rowHeight","cols","indexes","getColumnIndexesInView","contentModule","isXaxis","splice","indexOf","detailTemplate","childGrid","isRowDragable","visible","c","len_2","push","generateCell","HeaderIndent","detailIndentCellInfo","DetailHeader","RowDragHIcon","getHeaderTable","enablePersistence","lockcolPositionCount","lockColsRendered","appendCells","index","isFirstObj","isLastCol","isMovable","lastCol","frzCols","left","getContent","scrollLeft","inViewIndexes","getColumnIndexByUid","frozenColumns","colSpan","getCellCnt","frzObj","refreshFrozenHdr","isPartial","isComp","cnt","stackedLockColsCount","getStackedLockColsCount","checkFrozenStackHeader","cellType","StackedHeader","getColSpan","isFirstCol_1","isLastCol_1","isTrue","getNormalizedColumnIndex","lockColsCount","frozenCnt","frzCol","rowSpan","rowIndex","opt","slice","call","displayVal","idx","clen","isServerRendered","children","mTblColGrp","getHeaderContent","mTbl","refreshUI","freezeReorder","isVFTable","setFrozenTable","getVirtualFreezeHeader","removeChild","firstChild","childNodes","insertBefore","appendContent","colGroupRefresh","setWidthToColumns","updateDefaultCursor","_i","rows_1","row","gCells","allowTextWrap","textWrapSettings","wrapMode","stackedHdr","some","showDropArea","dragTarget","distance","abort","accept"],"mappings":"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","sourcesContent":["import { isNullOrUndefined, extend } from '@syncfusion/ej2-base';\nimport { setStyleAttribute, closest as getClosest, remove, isBlazor } from '@syncfusion/ej2-base';\nimport { classList } from '@syncfusion/ej2-base';\nimport { CellType } from '../base/enum';\nimport { RowRenderer } from './row-renderer';\nimport { Cell } from '../models/cell';\nimport { Row } from '../models/row';\nimport * as events from '../base/constant';\nimport { Draggable, Droppable } from '@syncfusion/ej2-base';\nimport { parentsUntil, wrap, measureColumnDepth, appendChildren } from '../base/util';\n/**\n * Content module is used to render grid content\n * @hidden\n */\nvar HeaderRender = /** @class */ (function () {\n    /**\n     * Constructor for header renderer module\n     */\n    function HeaderRender(parent, serviceLocator) {\n        var _this = this;\n        this.frzIdx = 0;\n        this.notfrzIdx = 0;\n        this.isFirstCol = false;\n        this.helper = function (e) {\n            var gObj = _this.parent;\n            var target = _this.draggable.currentStateTarget;\n            var parentEle = parentsUntil(target, 'e-headercell');\n            if (!(gObj.allowReordering || gObj.allowGrouping) || (!isNullOrUndefined(parentEle)\n                && parentEle.querySelectorAll('.e-checkselectall').length > 0)) {\n                return false;\n            }\n            var visualElement = _this.parent.createElement('div', { className: 'e-cloneproperties e-dragclone e-headerclone' });\n            var element = target.classList.contains('e-headercell') ? target : parentEle;\n            if (!element || (!gObj.allowReordering && element.classList.contains('e-stackedheadercell'))) {\n                return false;\n            }\n            var height = element.offsetHeight;\n            var headercelldiv = element.querySelector('.e-headercelldiv') || element.querySelector('.e-stackedheadercelldiv');\n            var col;\n            if (headercelldiv) {\n                if (element.querySelector('.e-stackedheadercelldiv')) {\n                    col = gObj.getStackedHeaderColumnByHeaderText(headercelldiv.innerText.trim(), gObj.columns);\n                }\n                else {\n                    col = gObj.getColumnByUid(headercelldiv.getAttribute('e-mappinguid'));\n                }\n                _this.column = col;\n                if (_this.column.lockColumn) {\n                    return false;\n                }\n                visualElement.setAttribute('e-mappinguid', _this.column.uid);\n            }\n            if (col && !isNullOrUndefined(col.headerTemplate)) {\n                if (!isNullOrUndefined(col.headerTemplate)) {\n                    var result = void 0;\n                    var colIndex = gObj.getColumnIndexByField(col.field);\n                    result = col.getHeaderTemplate()(extend({ 'index': colIndex }, col), gObj, 'headerTemplate');\n                    appendChildren(visualElement, result);\n                }\n                else {\n                    visualElement.innerHTML = col.headerTemplate;\n                }\n            }\n            else {\n                visualElement.innerHTML = headercelldiv ?\n                    col.headerText : element.firstElementChild.innerHTML;\n            }\n            visualElement.style.width = element.offsetWidth + 'px';\n            visualElement.style.height = element.offsetHeight + 'px';\n            visualElement.style.lineHeight = (height - 6).toString() + 'px';\n            gObj.element.appendChild(visualElement);\n            return visualElement;\n        };\n        this.dragStart = function (e) {\n            var gObj = _this.parent;\n            gObj.element.querySelector('.e-gridpopup').style.display = 'none';\n            gObj.notify(events.columnDragStart, { target: _this.draggable.currentStateTarget, column: _this.column, event: e.event });\n            if (isBlazor()) {\n                e.bindEvents(e.dragElement);\n            }\n        };\n        this.drag = function (e) {\n            var gObj = _this.parent;\n            var target = e.target;\n            if (target) {\n                var closest = getClosest(target, '.e-grid');\n                var cloneElement = _this.parent.element.querySelector('.e-cloneproperties');\n                if (!closest || closest.getAttribute('id') !== gObj.element.getAttribute('id')) {\n                    classList(cloneElement, ['e-notallowedcur'], ['e-defaultcur']);\n                    if (gObj.allowReordering) {\n                        gObj.element.querySelector('.e-reorderuparrow').style.display = 'none';\n                        gObj.element.querySelector('.e-reorderdownarrow').style.display = 'none';\n                    }\n                    if (!gObj.groupSettings.allowReordering) {\n                        return;\n                    }\n                }\n                gObj.notify(events.columnDrag, { target: e.target, column: _this.column, event: e.event });\n            }\n        };\n        this.dragStop = function (e) {\n            var gObj = _this.parent;\n            var cancel;\n            gObj.element.querySelector('.e-gridpopup').style.display = 'none';\n            if ((!parentsUntil(e.target, 'e-headercell') && !parentsUntil(e.target, 'e-groupdroparea')) ||\n                (!gObj.allowReordering && parentsUntil(e.target, 'e-headercell')) ||\n                (!e.helper.getAttribute('e-mappinguid') && parentsUntil(e.target, 'e-groupdroparea'))) {\n                remove(e.helper);\n                cancel = true;\n            }\n            gObj.notify(events.columnDragStop, { target: e.target, event: e.event, column: _this.column, cancel: cancel });\n        };\n        this.drop = function (e) {\n            var gObj = _this.parent;\n            var uid = e.droppedElement.getAttribute('e-mappinguid');\n            var closest = getClosest(e.target, '.e-grid');\n            remove(e.droppedElement);\n            if (closest && closest.getAttribute('id') !== gObj.element.getAttribute('id') ||\n                !(gObj.allowReordering || gObj.allowGrouping)) {\n                return;\n            }\n            gObj.notify(events.headerDrop, { target: e.target, uid: uid, droppedElement: e.droppedElement });\n        };\n        this.parent = parent;\n        this.serviceLocator = serviceLocator;\n        this.ariaService = this.serviceLocator.getService('ariaService');\n        this.widthService = this.serviceLocator.getService('widthService');\n        if (this.parent.isDestroyed) {\n            return;\n        }\n        if (!this.parent.enableColumnVirtualization) {\n            this.parent.on(events.columnVisibilityChanged, this.setVisible, this);\n        }\n        this.parent.on(events.columnPositionChanged, this.colPosRefresh, this);\n    }\n    /**\n     * The function is used to render grid header div\n     */\n    HeaderRender.prototype.renderPanel = function () {\n        var div = this.parent.element.querySelector('.e-gridheader');\n        var isRendered = (div != null);\n        div = isRendered ? div : this.parent.createElement('div', { className: 'e-gridheader' });\n        var innerDiv = isRendered ? div.querySelector('.e-headercontent') :\n            this.parent.createElement('div', { className: 'e-headercontent' });\n        this.toggleStackClass(div);\n        div.appendChild(innerDiv);\n        this.setPanel(div);\n        if (!isRendered) {\n            this.parent.element.appendChild(div);\n        }\n    };\n    /**\n     * The function is used to render grid header table\n     */\n    HeaderRender.prototype.renderTable = function () {\n        var headerDiv = this.getPanel();\n        headerDiv.appendChild(this.createHeaderTable());\n        this.setTable(headerDiv.querySelector('.e-table'));\n        if (!this.parent.getFrozenColumns()) {\n            this.initializeHeaderDrag();\n            this.initializeHeaderDrop();\n        }\n        this.parent.notify(events.headerRefreshed, { rows: this.rows, args: { isFrozen: this.parent.getFrozenColumns() !== 0 } });\n    };\n    /**\n     * Get the header content div element of grid\n     * @return {Element}\n     */\n    HeaderRender.prototype.getPanel = function () {\n        return this.headerPanel;\n    };\n    /**\n     * Set the header content div element of grid\n     * @param  {Element} panel\n     */\n    HeaderRender.prototype.setPanel = function (panel) {\n        this.headerPanel = panel;\n    };\n    /**\n     * Get the header table element of grid\n     * @return {Element}\n     */\n    HeaderRender.prototype.getTable = function () {\n        return this.headerTable;\n    };\n    /**\n     * Set the header table element of grid\n     * @param  {Element} table\n     */\n    HeaderRender.prototype.setTable = function (table) {\n        this.headerTable = table;\n    };\n    /**\n     * Get the header colgroup element\n     * @returns {Element}\n     */\n    HeaderRender.prototype.getColGroup = function () {\n        return this.colgroup;\n    };\n    /**\n     * Set the header colgroup element\n     * @param {Element} colgroup\n     * @returns {Element}\n     */\n    HeaderRender.prototype.setColGroup = function (colGroup) {\n        return this.colgroup = colGroup;\n    };\n    /**\n     * Get the header row element collection.\n     * @return {Element[]}\n     */\n    HeaderRender.prototype.getRows = function () {\n        var table = this.getTable();\n        return table.tHead.rows;\n    };\n    /**\n     * The function is used to create header table elements\n     * @return {Element}\n     * @hidden\n     */\n    HeaderRender.prototype.createHeaderTable = function () {\n        var skipDom = isBlazor() && this.parent.frozenRows !== 0;\n        var table = this.createTable();\n        var innerDiv = this.getPanel().querySelector('.e-headercontent');\n        if (!skipDom) {\n            innerDiv.appendChild(table);\n        }\n        return innerDiv;\n    };\n    /**\n     * @hidden\n     */\n    HeaderRender.prototype.createTable = function (tableEle) {\n        if (tableEle === void 0) { tableEle = null; }\n        var skipDom = isBlazor() && this.parent.frozenRows !== 0;\n        var gObj = this.parent;\n        if (!(isBlazor() && !gObj.isJsComponent) && this.getTable() && (!gObj.getFrozenColumns())) {\n            remove(this.getTable());\n        }\n        var columns = gObj.getColumns();\n        var innerDiv = this.getPanel().querySelector('.e-headercontent');\n        var table = skipDom ? tableEle || innerDiv.querySelector('.e-table') :\n            this.parent.createElement('table', { className: 'e-table', attrs: { cellspacing: '0.25px', role: 'grid' } });\n        var findHeaderRow = this.createHeaderContent();\n        var thead = findHeaderRow.thead;\n        var tbody = this.parent.createElement('tbody', { className: this.parent.frozenRows ? '' : 'e-hide' });\n        this.caption = this.parent.createElement('caption', { innerHTML: this.parent.element.id + '_header_table', className: 'e-hide' });\n        var colGroup = this.parent.createElement('colgroup');\n        var rowBody = this.parent.createElement('tr');\n        var bodyCell;\n        var rows = this.rows = findHeaderRow.rows;\n        var rowRenderer = new RowRenderer(this.serviceLocator, CellType.Header, this.parent);\n        for (var i = 0, len = rows.length; i < len; i++) {\n            for (var j = 0, len_1 = rows[i].cells.length; j < len_1; j++) {\n                var cell = rows[i].cells[j];\n                bodyCell = this.parent.createElement('td');\n                rowBody.appendChild(bodyCell);\n            }\n        }\n        if (gObj.allowFiltering || gObj.allowSorting || gObj.allowGrouping) {\n            table.classList.add('e-sortfilter');\n        }\n        this.updateColGroup(colGroup);\n        if (!skipDom) {\n            tbody.appendChild(rowBody);\n        }\n        table.appendChild(this.setColGroup(colGroup));\n        table.appendChild(thead);\n        if (!skipDom) {\n            table.appendChild(tbody);\n        }\n        table.appendChild(this.caption);\n        this.ariaService.setOptions(table, { colcount: gObj.getColumns().length.toString() });\n        return table;\n    };\n    HeaderRender.prototype.createHeaderContent = function () {\n        var gObj = this.parent;\n        var columns = gObj.getColumns();\n        var thead = this.parent.createElement('thead');\n        var colHeader = this.parent.createElement('tr', { className: 'e-columnheader' });\n        var rowRenderer = new RowRenderer(this.serviceLocator, CellType.Header, gObj);\n        rowRenderer.element = colHeader;\n        var rows = [];\n        var headerRow;\n        this.colDepth = measureColumnDepth(gObj.columns);\n        for (var i = 0, len = this.colDepth; i < len; i++) {\n            rows[i] = this.generateRow(i);\n            rows[i].cells = [];\n        }\n        rows = this.ensureColumns(rows);\n        rows = this.getHeaderCells(rows);\n        for (var i = 0, len = this.colDepth; i < len; i++) {\n            headerRow = rowRenderer.render(rows[i], columns);\n            if (this.parent.rowHeight && headerRow.querySelector('.e-headercell')) {\n                headerRow.style.height = this.parent.rowHeight + 'px';\n            }\n            thead.appendChild(headerRow);\n        }\n        var findHeaderRow = {\n            thead: thead,\n            rows: rows\n        };\n        return findHeaderRow;\n    };\n    HeaderRender.prototype.updateColGroup = function (colGroup) {\n        var cols = this.parent.getColumns();\n        var col;\n        var indexes = this.parent.getColumnIndexesInView();\n        if (this.parent.enableColumnVirtualization && this.parent.getFrozenColumns()\n            && this.parent.contentModule.isXaxis()) {\n            cols = extend([], this.parent.getColumns());\n            cols.splice(0, this.parent.getFrozenColumns());\n        }\n        colGroup.id = this.parent.element.id + 'colGroup';\n        if (this.parent.allowGrouping) {\n            for (var i = 0, len = this.parent.groupSettings.columns.length; i < len; i++) {\n                if (this.parent.enableColumnVirtualization && indexes.indexOf(i) === -1) {\n                    continue;\n                }\n                col = this.parent.createElement('col', { className: 'e-group-intent' });\n                colGroup.appendChild(col);\n            }\n        }\n        if (this.parent.detailTemplate || this.parent.childGrid) {\n            col = this.parent.createElement('col', { className: 'e-detail-intent' });\n            colGroup.appendChild(col);\n        }\n        if (this.parent.isRowDragable()) {\n            col = this.parent.createElement('col', { className: 'e-drag-intent' });\n            colGroup.appendChild(col);\n        }\n        for (var i = 0, len = cols.length; i < len; i++) {\n            col = this.parent.createElement('col');\n            if (cols[i].visible === false) {\n                setStyleAttribute(col, { 'display': 'none' });\n            }\n            colGroup.appendChild(col);\n        }\n        return colGroup;\n    };\n    HeaderRender.prototype.ensureColumns = function (rows) {\n        //TODO: generate dummy column for group, detail, stacked row here; ensureColumns here\n        var gObj = this.parent;\n        var indexes = this.parent.getColumnIndexesInView();\n        for (var i = 0, len = rows.length; i < len; i++) {\n            if (gObj.allowGrouping) {\n                for (var c = 0, len_2 = gObj.groupSettings.columns.length; c < len_2; c++) {\n                    if (this.parent.enableColumnVirtualization && indexes.indexOf(c) === -1) {\n                        continue;\n                    }\n                    rows[i].cells.push(this.generateCell({}, CellType.HeaderIndent));\n                }\n            }\n            if (gObj.detailTemplate || gObj.childGrid) {\n                var args = {};\n                this.parent.notify(events.detailIndentCellInfo, args);\n                rows[i].cells.push(this.generateCell(args, CellType.DetailHeader));\n            }\n            if (gObj.isRowDragable()) {\n                rows[i].cells.push(this.generateCell({}, CellType.RowDragHIcon));\n            }\n        }\n        return rows;\n    };\n    HeaderRender.prototype.getHeaderCells = function (rows) {\n        var column;\n        var thead = this.parent.getHeaderTable() && this.parent.getHeaderTable().querySelector('thead');\n        var cols = this.parent.enableColumnVirtualization ?\n            this.parent.getColumns(this.parent.enablePersistence) : this.parent.columns;\n        this.frzIdx = 0;\n        this.notfrzIdx = 0;\n        if (this.parent.lockcolPositionCount) {\n            for (var i = 0; i < cols.length; i++) {\n                this.lockColsRendered = false;\n                rows = this.appendCells(cols[i], rows, 0, i === 0, false, i === (cols.length - 1), thead);\n            }\n        }\n        for (var i = 0, len = cols.length; i < len; i++) {\n            this.notfrzIdx = 0;\n            this.lockColsRendered = true;\n            rows = this.appendCells(cols[i], rows, 0, i === 0, false, i === (len - 1), thead);\n        }\n        return rows;\n    };\n    HeaderRender.prototype.appendCells = function (cols, rows, index, isFirstObj, isFirstCol, isLastCol, isMovable) {\n        var lastCol = isLastCol ? 'e-lastcell' : '';\n        var frzCols = this.parent.getFrozenColumns();\n        var left;\n        if (this.parent.enableColumnVirtualization && frzCols) {\n            left = this.parent.getContent().querySelector('.e-movablecontent').scrollLeft;\n        }\n        if (!cols.columns) {\n            if (left && left > 0 && this.parent.contentModule.isXaxis()\n                && this.parent.inViewIndexes[0] !== 0 && this.frzIdx > this.parent.getFrozenColumns()) {\n                rows[index].cells.push(this.generateCell(cols, CellType.Header, this.colDepth - index, (isFirstObj ? '' : (isFirstCol ? 'e-firstcell' : '')) + lastCol, index, this.parent.getColumnIndexByUid(cols.uid)));\n            }\n            else {\n                if (!frzCols && (!this.parent.lockcolPositionCount\n                    || (cols.lockColumn && !this.lockColsRendered) || (!cols.lockColumn && this.lockColsRendered))\n                    || (frzCols && ((!isMovable && (this.frzIdx + this.notfrzIdx < this.parent.frozenColumns || cols.isFrozen) &&\n                        (!this.parent.lockcolPositionCount || (cols.lockColumn && !this.lockColsRendered) ||\n                            (!cols.lockColumn && this.lockColsRendered)))\n                        || (isMovable && (this.frzIdx + this.notfrzIdx >= this.parent.frozenColumns && !cols.isFrozen) &&\n                            (!this.parent.lockcolPositionCount || (cols.lockColumn && !this.lockColsRendered) ||\n                                (!cols.lockColumn && this.lockColsRendered)))))) {\n                    rows[index].cells.push(this.generateCell(cols, CellType.Header, this.colDepth - index, (isFirstObj ? '' : (isFirstCol ? 'e-firstcell' : '')) + lastCol, index, this.parent.getColumnIndexByUid(cols.uid)));\n                }\n            }\n            if (this.parent.lockcolPositionCount) {\n                if ((this.frzIdx + this.notfrzIdx < this.parent.frozenColumns) &&\n                    ((cols.lockColumn && !this.lockColsRendered) || (!cols.lockColumn && this.lockColsRendered))) {\n                    this.frzIdx++;\n                }\n                else {\n                    this.notfrzIdx++;\n                }\n            }\n            else {\n                this.frzIdx++;\n            }\n        }\n        else {\n            this.isFirstCol = false;\n            var colSpan = this.getCellCnt(cols, 0);\n            if (colSpan) {\n                var frzObj = this.refreshFrozenHdr(cols.columns, { isPartial: false, isComp: true, cnt: 0 });\n                var stackedLockColsCount = this.getStackedLockColsCount(cols, 0);\n                if (!frzCols && (!this.parent.lockcolPositionCount\n                    || (!this.lockColsRendered && stackedLockColsCount) || (this.lockColsRendered && (colSpan - stackedLockColsCount)))\n                    || (frzCols && ((!isMovable && this.checkFrozenStackHeader(cols.columns, isMovable)\n                        && (this.parent.frozenColumns - this.frzIdx > 0 || (frzObj.isPartial)))\n                        || (isMovable && ((colSpan + this.frzIdx > this.parent.frozenColumns && !frzObj.isComp)\n                            || this.checkFrozenStackHeader(cols.columns, isMovable)))))) {\n                    rows[index].cells.push(new Cell({\n                        cellType: CellType.StackedHeader, column: cols,\n                        colSpan: this.getColSpan(colSpan, isMovable, frzObj.cnt, stackedLockColsCount)\n                    }));\n                }\n            }\n            if (this.parent.lockcolPositionCount && !this.lockColsRendered) {\n                for (var i = 0; i < cols.columns.length; i++) {\n                    rows = this.appendCells(cols.columns[i], rows, index + 1, isFirstObj, i === 0, i === (cols.columns.length - 1) && isLastCol, isMovable);\n                }\n            }\n            if (this.lockColsRendered) {\n                for (var i = 0, len = cols.columns.length; i < len; i++) {\n                    var isFirstCol_1 = this.isFirstCol = cols.columns[i].visible && !this.isFirstCol;\n                    var isLastCol_1 = i === (len - 1) && !isFirstCol_1;\n                    rows = this.appendCells(cols.columns[i], rows, index + 1, isFirstObj, isFirstCol_1, isLastCol_1 && isLastCol_1, isMovable);\n                }\n            }\n        }\n        return rows;\n    };\n    HeaderRender.prototype.checkFrozenStackHeader = function (cols, isMovable) {\n        var isTrue = false;\n        for (var i = 0; i < cols.length; i++) {\n            var col = cols[i];\n            var colIndex = this.parent.getNormalizedColumnIndex(col.uid);\n            if (!col.columns) {\n                if (isMovable && colIndex >= this.parent.getFrozenColumns() && col.visible) {\n                    isTrue = true;\n                    break;\n                }\n                if (!isMovable && colIndex < this.parent.getFrozenColumns() && col.visible) {\n                    isTrue = true;\n                    break;\n                }\n            }\n        }\n        return isTrue;\n    };\n    HeaderRender.prototype.getStackedLockColsCount = function (col, lockColsCount) {\n        if (col.columns) {\n            for (var i = 0; i < col.columns.length; i++) {\n                lockColsCount = this.getStackedLockColsCount(col.columns[i], lockColsCount);\n            }\n        }\n        else if (col.lockColumn) {\n            lockColsCount++;\n        }\n        return lockColsCount;\n    };\n    HeaderRender.prototype.refreshFrozenHdr = function (cols, frzObj) {\n        for (var i = 0; i < cols.length; i++) {\n            if (cols[i].columns) {\n                frzObj = this.refreshFrozenHdr(cols[i].columns, frzObj);\n            }\n            else {\n                if (cols[i].isFrozen) {\n                    frzObj.isPartial = true;\n                    frzObj.cnt++;\n                }\n                frzObj.isComp = frzObj.isComp && (cols[i].isFrozen ||\n                    this.parent.getColumnIndexByField(cols[i].field) < this.parent.frozenColumns);\n            }\n        }\n        return frzObj;\n    };\n    HeaderRender.prototype.getColSpan = function (colSpan, isMovable, frozenCnt, stackedLockColsCount) {\n        var frzCol = this.parent.frozenColumns;\n        if (this.parent.getFrozenColumns() && this.frzIdx + colSpan > frzCol) {\n            if (isMovable) {\n                colSpan = colSpan - (frzCol > this.frzIdx ? frzCol - this.frzIdx : 0) - frozenCnt;\n            }\n            else {\n                colSpan = colSpan - (colSpan - (frzCol > this.frzIdx ? frzCol + frozenCnt - this.frzIdx : frozenCnt));\n            }\n        }\n        else if (this.parent.lockcolPositionCount) {\n            colSpan = !this.lockColsRendered ? stackedLockColsCount : colSpan - stackedLockColsCount;\n        }\n        return colSpan;\n    };\n    HeaderRender.prototype.generateRow = function (index) {\n        return new Row({});\n    };\n    HeaderRender.prototype.generateCell = function (column, cellType, rowSpan, className, rowIndex, colIndex) {\n        var opt = {\n            'visible': column.visible,\n            'isDataCell': false,\n            'isTemplate': !isNullOrUndefined(column.headerTemplate),\n            'rowID': '',\n            'column': column,\n            'cellType': cellType,\n            'rowSpan': rowSpan,\n            'className': className,\n            'index': rowIndex,\n            'colIndex': colIndex\n        };\n        if (!opt.rowSpan || opt.rowSpan < 2) {\n            delete opt.rowSpan;\n        }\n        return new Cell(opt);\n    };\n    /**\n     * Function to hide header table column based on visible property\n     * @param  {Column[]} columns?\n     */\n    HeaderRender.prototype.setVisible = function (columns) {\n        var gObj = this.parent;\n        var rows = [].slice.call(this.getRows()); //NodeList -> Array        \n        var displayVal;\n        var idx;\n        var className;\n        var element;\n        var frzCols = gObj.getFrozenColumns();\n        for (var c = 0, clen = columns.length; c < clen; c++) {\n            var column = columns[c];\n            idx = gObj.getNormalizedColumnIndex(column.uid);\n            displayVal = column.visible ? '' : 'none';\n            if (frzCols) {\n                if (idx < frzCols) {\n                    if (isBlazor() && gObj.isServerRendered) {\n                        setStyleAttribute(this.getTable().querySelector('colgroup').children[idx], { 'display': displayVal });\n                        setStyleAttribute(this.getTable().querySelectorAll('th')[idx], { 'display': displayVal });\n                    }\n                    else {\n                        setStyleAttribute(this.getColGroup().children[idx], { 'display': displayVal });\n                    }\n                }\n                else {\n                    var mTblColGrp = gObj.getHeaderContent().querySelector('.e-movableheader').querySelector('colgroup');\n                    var mTbl = gObj.getHeaderContent().querySelector('.e-movableheader').querySelector('table');\n                    setStyleAttribute(mTblColGrp.children[idx - frzCols], { 'display': displayVal });\n                    if (isBlazor() && gObj.isServerRendered) {\n                        setStyleAttribute(mTbl.querySelectorAll('th')[idx - frzCols], { 'display': displayVal });\n                    }\n                }\n            }\n            else {\n                setStyleAttribute(this.getColGroup().children[idx], { 'display': displayVal });\n            }\n        }\n        this.refreshUI();\n    };\n    HeaderRender.prototype.colPosRefresh = function () {\n        if (isBlazor() && this.parent.isServerRendered && this.parent.frozenRows && this.parent.getFrozenColumns()) {\n            this.freezeReorder = true;\n        }\n        this.refreshUI();\n    };\n    /**\n     * Refresh the header of the Grid.\n     * @returns {void}\n     */\n    HeaderRender.prototype.refreshUI = function () {\n        var frzCols = this.parent.getFrozenColumns();\n        var isVFTable = this.parent.enableColumnVirtualization && frzCols !== 0;\n        var setFrozenTable = isBlazor() && this.parent.isServerRendered && this.parent.frozenRows !== 0 && frzCols !== 0;\n        var headerDiv = this.getPanel();\n        this.toggleStackClass(headerDiv);\n        var table = this.freezeReorder ? this.headerPanel.querySelector('.e-movableheader').querySelector('.e-table')\n            : this.getTable();\n        if (isVFTable) {\n            table = this.parent.contentModule.getVirtualFreezeHeader();\n        }\n        if (setFrozenTable && !isVFTable) {\n            table = this.freezeReorder ? this.headerPanel.querySelector('.e-movableheader').querySelector('.e-table') :\n                this.headerPanel.querySelector('.e-frozenheader').querySelector('.e-table');\n        }\n        if (table) {\n            if (isBlazor() && this.parent.isServerRendered) {\n                table.removeChild(table.querySelector('colgroup'));\n                table.removeChild(table.querySelector('thead'));\n            }\n            else {\n                remove(table);\n                table.removeChild(table.firstChild);\n                table.removeChild(table.childNodes[0]);\n            }\n            var colGroup = this.parent.createElement('colgroup');\n            var findHeaderRow = this.createHeaderContent();\n            this.rows = findHeaderRow.rows;\n            table.insertBefore(findHeaderRow.thead, table.firstChild);\n            this.updateColGroup(colGroup);\n            table.insertBefore(this.setColGroup(colGroup), table.firstChild);\n            if (!isVFTable && !setFrozenTable) {\n                this.setTable(table);\n            }\n            if (!(isBlazor() && this.parent.isServerRendered)) {\n                this.appendContent(table);\n            }\n            this.parent.notify(events.colGroupRefresh, {});\n            this.widthService.setWidthToColumns();\n            this.parent.updateDefaultCursor();\n            if (!frzCols || (this.parent.enableColumnVirtualization && frzCols)) {\n                this.initializeHeaderDrag();\n            }\n            var rows = [].slice.call(headerDiv.querySelectorAll('tr.e-columnheader'));\n            for (var _i = 0, rows_1 = rows; _i < rows_1.length; _i++) {\n                var row = rows_1[_i];\n                var gCells = [].slice.call(row.querySelectorAll('.e-grouptopleftcell'));\n                if (gCells.length) {\n                    gCells[gCells.length - 1].classList.add('e-lastgrouptopleftcell');\n                }\n            }\n            if (!frzCols) {\n                this.parent.notify(events.headerRefreshed, { rows: this.rows, args: { isFrozen: this.parent.getFrozenColumns() !== 0 } });\n            }\n            if (this.parent.enableColumnVirtualization && parentsUntil(table, 'e-movableheader')) {\n                this.parent.notify(events.headerRefreshed, { rows: this.rows, args: { isFrozen: false, isXaxis: true } });\n            }\n            if (this.parent.allowTextWrap && this.parent.textWrapSettings.wrapMode === 'Header') {\n                wrap(rows, true);\n            }\n        }\n    };\n    HeaderRender.prototype.toggleStackClass = function (div) {\n        var column = this.parent.columns;\n        var stackedHdr = column.some(function (column) { return !isNullOrUndefined(column.columns); });\n        if (stackedHdr) {\n            div.classList.add('e-stackedheader');\n        }\n        else {\n            div.classList.remove('e-stackedheader');\n        }\n    };\n    HeaderRender.prototype.appendContent = function (table) {\n        this.getPanel().querySelector('.e-headercontent').appendChild(table);\n    };\n    HeaderRender.prototype.getCellCnt = function (col, cnt) {\n        if (col.columns) {\n            for (var i = 0, len = col.columns.length; i < len; i++) {\n                cnt = this.getCellCnt(col.columns[i], cnt);\n            }\n        }\n        else {\n            if (col.visible) {\n                cnt++;\n            }\n        }\n        return cnt;\n    };\n    HeaderRender.prototype.initializeHeaderDrag = function () {\n        var gObj = this.parent;\n        if (!(this.parent.allowReordering || (this.parent.allowGrouping && this.parent.groupSettings.showDropArea))) {\n            return;\n        }\n        this.draggable = new Draggable(gObj.getHeaderContent(), {\n            dragTarget: '.e-headercell',\n            distance: 5,\n            helper: this.helper,\n            dragStart: this.dragStart,\n            drag: this.drag,\n            dragStop: this.dragStop,\n            abort: '.e-rhandler'\n        });\n    };\n    HeaderRender.prototype.initializeHeaderDrop = function () {\n        var gObj = this.parent;\n        var drop = new Droppable(gObj.getHeaderContent(), {\n            accept: '.e-dragclone',\n            drop: this.drop\n        });\n    };\n    return HeaderRender;\n}());\nexport { HeaderRender };\n"]},"metadata":{},"sourceType":"module"}