{"ast":null,"code":"var __extends = this && this.__extends || function () {\n  var extendStatics = function (d, b) {\n    extendStatics = Object.setPrototypeOf || {\n      __proto__: []\n    } instanceof Array && function (d, b) {\n      d.__proto__ = b;\n    } || function (d, b) {\n      for (var p in b) if (b.hasOwnProperty(p)) d[p] = b[p];\n    };\n\n    return extendStatics(d, b);\n  };\n\n  return function (d, b) {\n    extendStatics(d, b);\n\n    function __() {\n      this.constructor = d;\n    }\n\n    d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());\n  };\n}();\n\nimport { isNullOrUndefined, remove } from '@syncfusion/ej2-base';\nimport { formatUnit } from '@syncfusion/ej2-base';\nimport { Browser } from '@syncfusion/ej2-base';\nimport { colGroupRefresh, columnWidthChanged, scroll, columnVisibilityChanged, refreshFooterRenderer } from '../base/constant';\nimport { ContentRender } from './content-renderer';\nimport { RowRenderer } from './row-renderer';\nimport { SummaryModelGenerator } from '../services/summary-model-generator';\nimport { renderMovable, calculateAggregate, iterateExtend } from '../base/util';\nimport { DataUtil } from '@syncfusion/ej2-data';\n/**\n * Footer module is used to render grid content\n * @hidden\n */\n\nvar FooterRenderer =\n/** @class */\nfunction (_super) {\n  __extends(FooterRenderer, _super);\n\n  function FooterRenderer(gridModule, serviceLocator) {\n    var _this = _super.call(this, gridModule, serviceLocator) || this;\n\n    _this.aggregates = {};\n    _this.parent = gridModule;\n    _this.locator = serviceLocator;\n    _this.modelGenerator = new SummaryModelGenerator(_this.parent);\n\n    _this.addEventListener();\n\n    return _this;\n  }\n  /**\n   * The function is used to render grid footer div\n   */\n\n\n  FooterRenderer.prototype.renderPanel = function () {\n    var div = this.parent.createElement('div', {\n      className: 'e-gridfooter'\n    });\n    var innerDiv = this.parent.createElement('div', {\n      className: 'e-summarycontent'\n    });\n    var movableContent = innerDiv;\n\n    if (this.parent.getFrozenColumns()) {\n      var fDiv = this.parent.createElement('div', {\n        className: 'e-frozenfootercontent'\n      });\n      var mDiv = this.parent.createElement('div', {\n        className: 'e-movablefootercontent'\n      });\n      innerDiv.appendChild(fDiv);\n      innerDiv.appendChild(mDiv);\n      this.frozenContent = fDiv;\n      this.movableContent = mDiv;\n      movableContent = mDiv;\n    }\n\n    if (Browser.isDevice) {\n      movableContent.style.overflowX = 'scroll';\n    }\n\n    div.appendChild(innerDiv);\n    this.setPanel(div);\n\n    if (this.parent.getPager() != null) {\n      this.parent.element.insertBefore(div, this.parent.getPager());\n    } else {\n      this.parent.element.appendChild(div);\n    }\n  };\n  /**\n   * The function is used to render grid footer table\n   */\n\n\n  FooterRenderer.prototype.renderTable = function () {\n    var contentDiv = this.getPanel();\n    var innerDiv = this.createContentTable('_footer_table');\n    var table = innerDiv.querySelector('.e-table');\n    var tFoot = this.parent.createElement('tfoot');\n    table.appendChild(tFoot);\n\n    if (this.parent.getFrozenColumns()) {\n      var freezeTable = table.cloneNode(true);\n      this.frozenContent.appendChild(freezeTable);\n      this.freezeTable = freezeTable;\n      this.movableContent.appendChild(table);\n      remove(table.querySelector('colgroup'));\n      var colGroup = this.parent.getHeaderContent().querySelector('.e-movableheader').querySelector('colgroup').cloneNode(true);\n      table.insertBefore(colGroup, table.querySelector('tbody'));\n      this.setColGroup(colGroup);\n    }\n\n    this.setTable(table);\n  };\n\n  FooterRenderer.prototype.renderSummaryContent = function (e, table, cStart, cEnd) {\n    var input = this.parent.dataSource instanceof Array ? this.parent.dataSource : this.parent.currentViewData;\n    var summaries = this.modelGenerator.getData();\n    var dummies = isNullOrUndefined(cStart) ? this.modelGenerator.getColumns() : this.modelGenerator.getColumns(cStart, cEnd);\n    var rows = isNullOrUndefined(cStart) ? this.modelGenerator.generateRows(input, e || this.aggregates) : this.modelGenerator.generateRows(input, e || this.aggregates, cStart, cEnd);\n    var fragment = document.createDocumentFragment();\n    var rowrenderer = new RowRenderer(this.locator, null, this.parent);\n    rowrenderer.element = this.parent.createElement('TR', {\n      className: 'e-summaryrow'\n    });\n\n    for (var srow = 0, len = summaries.length; srow < len; srow++) {\n      var row = rows[srow];\n\n      if (!row) {\n        continue;\n      }\n\n      var tr = rowrenderer.render(row, dummies);\n      fragment.appendChild(tr);\n    }\n\n    table.tFoot.appendChild(fragment);\n    this.aggregates = !isNullOrUndefined(e) ? e : this.aggregates;\n  };\n\n  FooterRenderer.prototype.refresh = function (e) {\n    if (this.parent.getFrozenColumns()) {\n      remove(this.getPanel());\n      this.renderPanel();\n      this.renderTable();\n      this.freezeTable.tFoot.innerHTML = '';\n      this.renderSummaryContent(e, this.freezeTable, 0, this.parent.getFrozenColumns());\n    }\n\n    this.getTable().tFoot.innerHTML = '';\n    this.renderSummaryContent(e, this.getTable(), this.parent.getFrozenColumns()); // check freeze content have no row case\n\n    if (this.parent.getFrozenColumns()) {\n      var frozenCnt = [].slice.call(this.parent.element.querySelector('.e-frozenfootercontent').querySelectorAll('.e-summaryrow'));\n      var movableCnt = [].slice.call(this.parent.element.querySelector('.e-movablefootercontent').querySelectorAll('.e-summaryrow'));\n\n      for (var i = 0; i < frozenCnt.length; i++) {\n        var frozenHeight = frozenCnt[i].getBoundingClientRect().height;\n        var movableHeight = movableCnt[i].getBoundingClientRect().height;\n\n        if (frozenHeight < movableHeight) {\n          frozenCnt[i].classList.remove('e-hide');\n          frozenCnt[i].style.height = movableHeight + 'px';\n        } else if (frozenHeight > movableHeight) {\n          movableCnt[i].classList.remove('e-hide');\n          movableCnt[i].style.height = frozenHeight + 'px';\n        }\n      }\n\n      var frozenDiv = this.frozenContent;\n\n      if (!frozenDiv.offsetHeight) {\n        frozenDiv.style.height = this.getTable().offsetHeight + 'px';\n      }\n\n      if (this.parent.allowResizing) {\n        this.updateFooterTableWidth(this.getTable());\n      }\n    }\n\n    this.onScroll();\n  };\n\n  FooterRenderer.prototype.refreshCol = function () {\n    // frozen table \n    var mheaderCol;\n    var fheaderCol = mheaderCol = this.parent.element.querySelector('.e-gridheader').querySelector('colgroup').cloneNode(true);\n\n    if (this.parent.getFrozenColumns()) {\n      var isXaxis = this.parent.enableColumnVirtualization && this.parent.contentModule.isXaxis();\n\n      if (isXaxis) {\n        mheaderCol = this.parent.getMovableVirtualHeader().querySelector('colgroup').cloneNode(true);\n      } else {\n        mheaderCol = renderMovable(fheaderCol, this.parent.getFrozenColumns());\n        this.freezeTable.replaceChild(fheaderCol, this.freezeTable.querySelector('colGroup'));\n      }\n    }\n\n    this.getTable().replaceChild(mheaderCol, this.getColGroup());\n    this.setColGroup(mheaderCol);\n  };\n\n  FooterRenderer.prototype.onWidthChange = function (args) {\n    this.getColFromIndex(args.index).style.width = formatUnit(args.width);\n\n    if (this.parent.allowResizing && args.module === 'resize') {\n      this.updateFooterTableWidth(this.getTable());\n    }\n  };\n\n  FooterRenderer.prototype.onScroll = function (e) {\n    if (e === void 0) {\n      e = {\n        left: this.parent.getFrozenColumns() ? this.parent.getContent().querySelector('.e-movablecontent').scrollLeft : this.parent.getContent().firstChild.scrollLeft\n      };\n    }\n\n    this.getTable().parentElement.scrollLeft = e.left;\n  };\n\n  FooterRenderer.prototype.getColFromIndex = function (index) {\n    var fCol = this.parent.getFrozenColumns();\n\n    if (fCol && fCol > index) {\n      return this.freezeTable.querySelector('colGroup').children[index];\n    }\n\n    return this.getColGroup().children[index - fCol];\n  };\n\n  FooterRenderer.prototype.columnVisibilityChanged = function () {\n    this.refresh();\n  };\n\n  FooterRenderer.prototype.addEventListener = function () {\n    this.parent.on(colGroupRefresh, this.refreshCol, this);\n    this.parent.on(columnWidthChanged, this.onWidthChange, this);\n    this.parent.on(scroll, this.onScroll, this);\n    this.parent.on(columnVisibilityChanged, this.columnVisibilityChanged, this);\n    this.parent.on(refreshFooterRenderer, this.refreshFooterRenderer, this);\n  };\n\n  FooterRenderer.prototype.removeEventListener = function () {\n    this.parent.off(colGroupRefresh, this.refreshCol);\n    this.parent.off(columnWidthChanged, this.onWidthChange);\n    this.parent.off(scroll, this.onScroll);\n    this.parent.off(columnVisibilityChanged, this.columnVisibilityChanged);\n    this.parent.off(refreshFooterRenderer, this.refreshFooterRenderer);\n  };\n\n  FooterRenderer.prototype.updateFooterTableWidth = function (tFoot) {\n    var tHead = this.parent.getHeaderTable();\n\n    if (tHead && tFoot) {\n      tFoot.style.width = tHead.style.width;\n    }\n  };\n\n  FooterRenderer.prototype.refreshFooterRenderer = function (editedData) {\n    var aggregates = this.onAggregates(editedData);\n    this.refresh(aggregates);\n  };\n\n  FooterRenderer.prototype.getIndexByKey = function (data, ds) {\n    var key = this.parent.getPrimaryKeyFieldNames()[0];\n\n    for (var i = 0; i < ds.length; i++) {\n      if (ds[i][key] === data[key]) {\n        return i;\n      }\n    }\n\n    return -1;\n  };\n\n  FooterRenderer.prototype.onAggregates = function (editedData) {\n    editedData = editedData instanceof Array ? editedData : [];\n    var field = this.parent.getPrimaryKeyFieldNames()[0];\n    var dataSource = [];\n    var isModified = false;\n    var batchChanges = {};\n    var gridData = 'dataSource';\n    var changedRecords = 'changedRecords';\n    var addedRecords = 'addedRecords';\n    var deletedRecords = 'deletedRecords';\n    var currentViewData = this.parent.dataSource instanceof Array ? this.parent.dataSource : this.parent.dataSource[gridData].json.length ? this.parent.dataSource[gridData].json : this.parent.getCurrentViewRecords();\n\n    if (this.parent.editModule) {\n      batchChanges = this.parent.editModule.getBatchChanges();\n    }\n\n    if (Object.keys(batchChanges).length) {\n      for (var i = 0; i < currentViewData.length; i++) {\n        isModified = false;\n\n        if (batchChanges[changedRecords].length && this.getIndexByKey(currentViewData[i], batchChanges[changedRecords]) > -1) {\n          isModified = true;\n          dataSource.push(batchChanges[changedRecords][this.getIndexByKey(currentViewData[i], batchChanges[changedRecords])]);\n        }\n\n        if (batchChanges[deletedRecords].length && this.getIndexByKey(currentViewData[i], batchChanges[deletedRecords]) > -1) {\n          isModified = true;\n        } else if (!isModified) {\n          dataSource.push(currentViewData[i]);\n        }\n      }\n\n      if (batchChanges[addedRecords].length) {\n        for (var i = 0; i < batchChanges[addedRecords].length; i++) {\n          dataSource.push(batchChanges[addedRecords][i]);\n        }\n      }\n    } else {\n      if (editedData.length) {\n        var data = iterateExtend(currentViewData);\n        dataSource = data.map(function (item) {\n          var idVal = DataUtil.getObject(field, item);\n          var value;\n          var hasVal = editedData.some(function (cItem) {\n            value = cItem;\n            return idVal === DataUtil.getObject(field, cItem);\n          });\n          return hasVal ? value : item;\n        });\n      } else {\n        dataSource = currentViewData;\n      }\n    }\n\n    var eData = editedData;\n\n    if (eData.type && eData.type === 'cancel') {\n      dataSource = currentViewData;\n    }\n\n    var aggregate = {};\n    var agrVal;\n    var aggregateRows = this.parent.aggregates;\n\n    for (var i = 0; i < aggregateRows.length; i++) {\n      for (var j = 0; j < aggregateRows[i].columns.length; j++) {\n        var data = [];\n        var type = aggregateRows[i].columns[j].type.toString();\n        data = dataSource;\n        agrVal = calculateAggregate(type, data, aggregateRows[i].columns[j], this.parent);\n        aggregate[aggregateRows[i].columns[j].field + ' - ' + type.toLowerCase()] = agrVal;\n      }\n    }\n\n    var result = {\n      result: dataSource,\n      count: dataSource.length,\n      aggregates: aggregate\n    };\n    return result;\n  };\n\n  return FooterRenderer;\n}(ContentRender);\n\nexport { FooterRenderer };","map":{"version":3,"sources":["/home/nikhil/Desktop/data_grid_editor-master/node_modules/@syncfusion/ej2-grids/src/grid/renderer/footer-renderer.js"],"names":["__extends","extendStatics","d","b","Object","setPrototypeOf","__proto__","Array","p","hasOwnProperty","__","constructor","prototype","create","isNullOrUndefined","remove","formatUnit","Browser","colGroupRefresh","columnWidthChanged","scroll","columnVisibilityChanged","refreshFooterRenderer","ContentRender","RowRenderer","SummaryModelGenerator","renderMovable","calculateAggregate","iterateExtend","DataUtil","FooterRenderer","_super","gridModule","serviceLocator","_this","call","aggregates","parent","locator","modelGenerator","addEventListener","renderPanel","div","createElement","className","innerDiv","movableContent","getFrozenColumns","fDiv","mDiv","appendChild","frozenContent","isDevice","style","overflowX","setPanel","getPager","element","insertBefore","renderTable","contentDiv","getPanel","createContentTable","table","querySelector","tFoot","freezeTable","cloneNode","colGroup","getHeaderContent","setColGroup","setTable","renderSummaryContent","e","cStart","cEnd","input","dataSource","currentViewData","summaries","getData","dummies","getColumns","rows","generateRows","fragment","document","createDocumentFragment","rowrenderer","srow","len","length","row","tr","render","refresh","innerHTML","getTable","frozenCnt","slice","querySelectorAll","movableCnt","i","frozenHeight","getBoundingClientRect","height","movableHeight","classList","frozenDiv","offsetHeight","allowResizing","updateFooterTableWidth","onScroll","refreshCol","mheaderCol","fheaderCol","isXaxis","enableColumnVirtualization","contentModule","getMovableVirtualHeader","replaceChild","getColGroup","onWidthChange","args","getColFromIndex","index","width","module","left","getContent","scrollLeft","firstChild","parentElement","fCol","children","on","removeEventListener","off","tHead","getHeaderTable","editedData","onAggregates","getIndexByKey","data","ds","key","getPrimaryKeyFieldNames","field","isModified","batchChanges","gridData","changedRecords","addedRecords","deletedRecords","json","getCurrentViewRecords","editModule","getBatchChanges","keys","push","map","item","idVal","getObject","value","hasVal","some","cItem","eData","type","aggregate","agrVal","aggregateRows","j","columns","toString","toLowerCase","result","count"],"mappings":"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","sourcesContent":["var __extends = (this && this.__extends) || (function () {\n    var extendStatics = function (d, b) {\n        extendStatics = Object.setPrototypeOf ||\n            ({ __proto__: [] } instanceof Array && function (d, b) { d.__proto__ = b; }) ||\n            function (d, b) { for (var p in b) if (b.hasOwnProperty(p)) d[p] = b[p]; };\n        return extendStatics(d, b);\n    }\n    return function (d, b) {\n        extendStatics(d, b);\n        function __() { this.constructor = d; }\n        d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());\n    };\n})();\nimport { isNullOrUndefined, remove } from '@syncfusion/ej2-base';\nimport { formatUnit } from '@syncfusion/ej2-base';\nimport { Browser } from '@syncfusion/ej2-base';\nimport { colGroupRefresh, columnWidthChanged, scroll, columnVisibilityChanged, refreshFooterRenderer } from '../base/constant';\nimport { ContentRender } from './content-renderer';\nimport { RowRenderer } from './row-renderer';\nimport { SummaryModelGenerator } from '../services/summary-model-generator';\nimport { renderMovable, calculateAggregate, iterateExtend } from '../base/util';\nimport { DataUtil } from '@syncfusion/ej2-data';\n/**\n * Footer module is used to render grid content\n * @hidden\n */\nvar FooterRenderer = /** @class */ (function (_super) {\n    __extends(FooterRenderer, _super);\n    function FooterRenderer(gridModule, serviceLocator) {\n        var _this = _super.call(this, gridModule, serviceLocator) || this;\n        _this.aggregates = {};\n        _this.parent = gridModule;\n        _this.locator = serviceLocator;\n        _this.modelGenerator = new SummaryModelGenerator(_this.parent);\n        _this.addEventListener();\n        return _this;\n    }\n    /**\n     * The function is used to render grid footer div\n     */\n    FooterRenderer.prototype.renderPanel = function () {\n        var div = this.parent.createElement('div', { className: 'e-gridfooter' });\n        var innerDiv = this.parent.createElement('div', { className: 'e-summarycontent' });\n        var movableContent = innerDiv;\n        if (this.parent.getFrozenColumns()) {\n            var fDiv = this.parent.createElement('div', { className: 'e-frozenfootercontent' });\n            var mDiv = this.parent.createElement('div', { className: 'e-movablefootercontent' });\n            innerDiv.appendChild(fDiv);\n            innerDiv.appendChild(mDiv);\n            this.frozenContent = fDiv;\n            this.movableContent = mDiv;\n            movableContent = mDiv;\n        }\n        if (Browser.isDevice) {\n            movableContent.style.overflowX = 'scroll';\n        }\n        div.appendChild(innerDiv);\n        this.setPanel(div);\n        if (this.parent.getPager() != null) {\n            this.parent.element.insertBefore(div, this.parent.getPager());\n        }\n        else {\n            this.parent.element.appendChild(div);\n        }\n    };\n    /**\n     * The function is used to render grid footer table\n     */\n    FooterRenderer.prototype.renderTable = function () {\n        var contentDiv = this.getPanel();\n        var innerDiv = this.createContentTable('_footer_table');\n        var table = innerDiv.querySelector('.e-table');\n        var tFoot = this.parent.createElement('tfoot');\n        table.appendChild(tFoot);\n        if (this.parent.getFrozenColumns()) {\n            var freezeTable = table.cloneNode(true);\n            this.frozenContent.appendChild(freezeTable);\n            this.freezeTable = freezeTable;\n            this.movableContent.appendChild(table);\n            remove(table.querySelector('colgroup'));\n            var colGroup = ((this.parent.getHeaderContent().querySelector('.e-movableheader').querySelector('colgroup')).cloneNode(true));\n            table.insertBefore(colGroup, table.querySelector('tbody'));\n            this.setColGroup(colGroup);\n        }\n        this.setTable(table);\n    };\n    FooterRenderer.prototype.renderSummaryContent = function (e, table, cStart, cEnd) {\n        var input = this.parent.dataSource instanceof Array ? this.parent.dataSource : this.parent.currentViewData;\n        var summaries = this.modelGenerator.getData();\n        var dummies = isNullOrUndefined(cStart) ? this.modelGenerator.getColumns() :\n            this.modelGenerator.getColumns(cStart, cEnd);\n        var rows = isNullOrUndefined(cStart) ? this.modelGenerator.generateRows(input, e || this.aggregates) :\n            this.modelGenerator.generateRows(input, e || this.aggregates, cStart, cEnd);\n        var fragment = document.createDocumentFragment();\n        var rowrenderer = new RowRenderer(this.locator, null, this.parent);\n        rowrenderer.element = this.parent.createElement('TR', { className: 'e-summaryrow' });\n        for (var srow = 0, len = summaries.length; srow < len; srow++) {\n            var row = rows[srow];\n            if (!row) {\n                continue;\n            }\n            var tr = rowrenderer.render(row, dummies);\n            fragment.appendChild(tr);\n        }\n        table.tFoot.appendChild(fragment);\n        this.aggregates = !isNullOrUndefined(e) ? e : this.aggregates;\n    };\n    FooterRenderer.prototype.refresh = function (e) {\n        if (this.parent.getFrozenColumns()) {\n            remove(this.getPanel());\n            this.renderPanel();\n            this.renderTable();\n            this.freezeTable.tFoot.innerHTML = '';\n            this.renderSummaryContent(e, this.freezeTable, 0, this.parent.getFrozenColumns());\n        }\n        this.getTable().tFoot.innerHTML = '';\n        this.renderSummaryContent(e, this.getTable(), this.parent.getFrozenColumns());\n        // check freeze content have no row case\n        if (this.parent.getFrozenColumns()) {\n            var frozenCnt = [].slice.call(this.parent.element.querySelector('.e-frozenfootercontent')\n                .querySelectorAll('.e-summaryrow'));\n            var movableCnt = [].slice.call(this.parent.element.querySelector('.e-movablefootercontent')\n                .querySelectorAll('.e-summaryrow'));\n            for (var i = 0; i < frozenCnt.length; i++) {\n                var frozenHeight = frozenCnt[i].getBoundingClientRect().height;\n                var movableHeight = movableCnt[i].getBoundingClientRect().height;\n                if (frozenHeight < movableHeight) {\n                    frozenCnt[i].classList.remove('e-hide');\n                    frozenCnt[i].style.height = movableHeight + 'px';\n                }\n                else if (frozenHeight > movableHeight) {\n                    movableCnt[i].classList.remove('e-hide');\n                    movableCnt[i].style.height = frozenHeight + 'px';\n                }\n            }\n            var frozenDiv = this.frozenContent;\n            if (!frozenDiv.offsetHeight) {\n                frozenDiv.style.height = this.getTable().offsetHeight + 'px';\n            }\n            if (this.parent.allowResizing) {\n                this.updateFooterTableWidth(this.getTable());\n            }\n        }\n        this.onScroll();\n    };\n    FooterRenderer.prototype.refreshCol = function () {\n        // frozen table \n        var mheaderCol;\n        var fheaderCol = mheaderCol = this.parent.element.querySelector('.e-gridheader').querySelector('colgroup').cloneNode(true);\n        if (this.parent.getFrozenColumns()) {\n            var isXaxis = this.parent.enableColumnVirtualization && this.parent.contentModule.isXaxis();\n            if (isXaxis) {\n                mheaderCol = this.parent.getMovableVirtualHeader().querySelector('colgroup').cloneNode(true);\n            }\n            else {\n                mheaderCol = renderMovable(fheaderCol, this.parent.getFrozenColumns());\n                this.freezeTable.replaceChild(fheaderCol, this.freezeTable.querySelector('colGroup'));\n            }\n        }\n        this.getTable().replaceChild(mheaderCol, this.getColGroup());\n        this.setColGroup(mheaderCol);\n    };\n    FooterRenderer.prototype.onWidthChange = function (args) {\n        this.getColFromIndex(args.index).style.width = formatUnit(args.width);\n        if (this.parent.allowResizing && args.module === 'resize') {\n            this.updateFooterTableWidth(this.getTable());\n        }\n    };\n    FooterRenderer.prototype.onScroll = function (e) {\n        if (e === void 0) { e = {\n            left: this.parent.getFrozenColumns() ? this.parent.getContent().querySelector('.e-movablecontent').scrollLeft :\n                this.parent.getContent().firstChild.scrollLeft\n        }; }\n        this.getTable().parentElement.scrollLeft = e.left;\n    };\n    FooterRenderer.prototype.getColFromIndex = function (index) {\n        var fCol = this.parent.getFrozenColumns();\n        if (fCol && fCol > index) {\n            return this.freezeTable.querySelector('colGroup').children[index];\n        }\n        return this.getColGroup().children[index - fCol];\n    };\n    FooterRenderer.prototype.columnVisibilityChanged = function () {\n        this.refresh();\n    };\n    FooterRenderer.prototype.addEventListener = function () {\n        this.parent.on(colGroupRefresh, this.refreshCol, this);\n        this.parent.on(columnWidthChanged, this.onWidthChange, this);\n        this.parent.on(scroll, this.onScroll, this);\n        this.parent.on(columnVisibilityChanged, this.columnVisibilityChanged, this);\n        this.parent.on(refreshFooterRenderer, this.refreshFooterRenderer, this);\n    };\n    FooterRenderer.prototype.removeEventListener = function () {\n        this.parent.off(colGroupRefresh, this.refreshCol);\n        this.parent.off(columnWidthChanged, this.onWidthChange);\n        this.parent.off(scroll, this.onScroll);\n        this.parent.off(columnVisibilityChanged, this.columnVisibilityChanged);\n        this.parent.off(refreshFooterRenderer, this.refreshFooterRenderer);\n    };\n    FooterRenderer.prototype.updateFooterTableWidth = function (tFoot) {\n        var tHead = this.parent.getHeaderTable();\n        if (tHead && tFoot) {\n            tFoot.style.width = tHead.style.width;\n        }\n    };\n    FooterRenderer.prototype.refreshFooterRenderer = function (editedData) {\n        var aggregates = this.onAggregates(editedData);\n        this.refresh(aggregates);\n    };\n    FooterRenderer.prototype.getIndexByKey = function (data, ds) {\n        var key = this.parent.getPrimaryKeyFieldNames()[0];\n        for (var i = 0; i < ds.length; i++) {\n            if (ds[i][key] === data[key]) {\n                return i;\n            }\n        }\n        return -1;\n    };\n    FooterRenderer.prototype.onAggregates = function (editedData) {\n        editedData = editedData instanceof Array ? editedData : [];\n        var field = this.parent.getPrimaryKeyFieldNames()[0];\n        var dataSource = [];\n        var isModified = false;\n        var batchChanges = {};\n        var gridData = 'dataSource';\n        var changedRecords = 'changedRecords';\n        var addedRecords = 'addedRecords';\n        var deletedRecords = 'deletedRecords';\n        var currentViewData = this.parent.dataSource instanceof Array ?\n            this.parent.dataSource : this.parent.dataSource[gridData].json.length\n            ? this.parent.dataSource[gridData].json : this.parent.getCurrentViewRecords();\n        if (this.parent.editModule) {\n            batchChanges = this.parent.editModule.getBatchChanges();\n        }\n        if (Object.keys(batchChanges).length) {\n            for (var i = 0; i < currentViewData.length; i++) {\n                isModified = false;\n                if (batchChanges[changedRecords].length && this.getIndexByKey(currentViewData[i], batchChanges[changedRecords]) > -1) {\n                    isModified = true;\n                    dataSource.push(batchChanges[changedRecords][this.getIndexByKey(currentViewData[i], batchChanges[changedRecords])]);\n                }\n                if (batchChanges[deletedRecords].length && this.getIndexByKey(currentViewData[i], batchChanges[deletedRecords]) > -1) {\n                    isModified = true;\n                }\n                else if (!isModified) {\n                    dataSource.push(currentViewData[i]);\n                }\n            }\n            if (batchChanges[addedRecords].length) {\n                for (var i = 0; i < batchChanges[addedRecords].length; i++) {\n                    dataSource.push(batchChanges[addedRecords][i]);\n                }\n            }\n        }\n        else {\n            if (editedData.length) {\n                var data = iterateExtend(currentViewData);\n                dataSource = data.map(function (item) {\n                    var idVal = DataUtil.getObject(field, item);\n                    var value;\n                    var hasVal = editedData.some(function (cItem) {\n                        value = cItem;\n                        return idVal === DataUtil.getObject(field, cItem);\n                    });\n                    return hasVal ? value : item;\n                });\n            }\n            else {\n                dataSource = currentViewData;\n            }\n        }\n        var eData = editedData;\n        if ((eData.type && eData.type === 'cancel')) {\n            dataSource = currentViewData;\n        }\n        var aggregate = {};\n        var agrVal;\n        var aggregateRows = this.parent.aggregates;\n        for (var i = 0; i < aggregateRows.length; i++) {\n            for (var j = 0; j < aggregateRows[i].columns.length; j++) {\n                var data = [];\n                var type = aggregateRows[i].columns[j].type.toString();\n                data = dataSource;\n                agrVal = calculateAggregate(type, data, aggregateRows[i].columns[j], this.parent);\n                aggregate[aggregateRows[i].columns[j].field + ' - ' + type.toLowerCase()] = agrVal;\n            }\n        }\n        var result = {\n            result: dataSource,\n            count: dataSource.length,\n            aggregates: aggregate\n        };\n        return result;\n    };\n    return FooterRenderer;\n}(ContentRender));\nexport { FooterRenderer };\n"]},"metadata":{},"sourceType":"module"}